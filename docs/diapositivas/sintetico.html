<!DOCTYPE html>
<html lang="en"><head>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-html/tabby.min.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/light-border.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting-37eea08aefeeee20ff55810ff984fec1.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<link href="../site_libs/quarto-contrib/bootstrap-icons-1.13.1/bootstrap-icons.css" rel="stylesheet"><meta charset="utf-8">
  <meta name="generator" content="quarto-1.7.32">

  <title>Inferencia Causal 2025 – sintetico</title>
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, minimal-ui">
  <link rel="stylesheet" href="../site_libs/revealjs/dist/reset.css">
  <link rel="stylesheet" href="../site_libs/revealjs/dist/reveal.css">
  <style>
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    div.columns{display: flex; gap: min(4vw, 1.5em);}
    div.column{flex: auto; overflow-x: auto;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    ul.task-list{list-style: none;}
    ul.task-list li input[type="checkbox"] {
      width: 0.8em;
      margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
      vertical-align: middle;
    }
  </style>
  <link rel="stylesheet" href="../site_libs/revealjs/dist/theme/quarto-8b940f0b0c37e8b60983ca0a0adffd2d.css">
  <link href="../site_libs/revealjs/plugin/quarto-line-highlight/line-highlight.css" rel="stylesheet">
  <link href="../site_libs/revealjs/plugin/reveal-menu/menu.css" rel="stylesheet">
  <link href="../site_libs/revealjs/plugin/reveal-menu/quarto-menu.css" rel="stylesheet">
  <link href="../site_libs/revealjs/plugin/quarto-support/footer.css" rel="stylesheet">
  <style type="text/css">
    .reveal div.sourceCode {
      margin: 0;
      overflow: auto;
    }
    .reveal div.hanging-indent {
      margin-left: 1em;
      text-indent: -1em;
    }
    .reveal .slide:not(.center) {
      height: 100%;
    }
    .reveal .slide.scrollable {
      overflow-y: auto;
    }
    .reveal .footnotes {
      height: 100%;
      overflow-y: auto;
    }
    .reveal .slide .absolute {
      position: absolute;
      display: block;
    }
    .reveal .footnotes ol {
      counter-reset: ol;
      list-style-type: none; 
      margin-left: 0;
    }
    .reveal .footnotes ol li:before {
      counter-increment: ol;
      content: counter(ol) ". "; 
    }
    .reveal .footnotes ol li > p:first-child {
      display: inline-block;
    }
    .reveal .slide ul,
    .reveal .slide ol {
      margin-bottom: 0.5em;
    }
    .reveal .slide ul li,
    .reveal .slide ol li {
      margin-top: 0.4em;
      margin-bottom: 0.2em;
    }
    .reveal .slide ul[role="tablist"] li {
      margin-bottom: 0;
    }
    .reveal .slide ul li > *:first-child,
    .reveal .slide ol li > *:first-child {
      margin-block-start: 0;
    }
    .reveal .slide ul li > *:last-child,
    .reveal .slide ol li > *:last-child {
      margin-block-end: 0;
    }
    .reveal .slide .columns:nth-child(3) {
      margin-block-start: 0.8em;
    }
    .reveal blockquote {
      box-shadow: none;
    }
    .reveal .tippy-content>* {
      margin-top: 0.2em;
      margin-bottom: 0.7em;
    }
    .reveal .tippy-content>*:last-child {
      margin-bottom: 0.2em;
    }
    .reveal .slide > img.stretch.quarto-figure-center,
    .reveal .slide > img.r-stretch.quarto-figure-center {
      display: block;
      margin-left: auto;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-left,
    .reveal .slide > img.r-stretch.quarto-figure-left  {
      display: block;
      margin-left: 0;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-right,
    .reveal .slide > img.r-stretch.quarto-figure-right  {
      display: block;
      margin-left: auto;
      margin-right: 0; 
    }
  </style>
</head>
<body class="quarto-light">
  <div class="reveal">
    <div class="slides">


<section id="control-sintético" class="title-slide slide level1 portada center">
<h1>Control sintético</h1>
<div style="text-align: center; font-size: 1.2em; font-weight: bold;">
<p>Inferencia Causal</p>
</div>
<div style="text-align: center; margin-top: 1em;">
<p><strong>Irvin Rojas</strong><br>
<br> <a href="https://rojasirvin.com" style="color: #ffffff;">rojasirvin.com</a></p>
</div>
<div style="text-align: center; margin-top: 1em;">
<p><a href="https://github.com/rojasirvin" target="_blank" style="margin-right: 0 10px;"> <i class="bi-github " style="" role="img" aria-hidden="true"></i> </a> <a href="https://twitter.com/RojasIrvin" target="_blank" style="margin-right: 0 10px;"> <i class="bi-twitter " style="" role="img" aria-hidden="true"></i> </a> <a href="https://scholar.google.com/citations?user=FUwdSTMAAAAJ&amp;hl=en" style="margin: 0 10px;"> <i class="bi-google " style="" role="img" aria-hidden="true"></i> </a></p>
</div>
<p><strong>Centro de Investigación y Docencia Económicas</strong> División de Economía</p>
<div class="cell">
<style type="text/css">
.huge .remark-code { /*Change made here*/
  font-size: 200% !important;
}
.tiny .remark-code { /*Change made here*/
  font-size: 60% !important;
}
</style>
</div>
</section>

<section id="motivación" class="title-slide slide level1 center">
<h1>Motivación</h1>
<ul>
<li><p>Hasta ahora hemos usado situaciones en las que varios individuos resultan tratados y varios resultan no ser tratados</p></li>
<li><p>Los métodos no experimentales nos permiten identificar el efecto de un tratamiento por medio de supuestos</p></li>
<li><p>Tratamos de aproximar una situación experimental</p></li>
<li><p>Los estudios de evento ocurren cuando una política o programa se lleva a cabo a nivel agregado y afecta a unas pocas (a veces una) unidades</p></li>
</ul>
</section>

<section id="motivación-1" class="title-slide slide level1 center">
<h1>Motivación</h1>
<ul>
<li><p>El método de <em>control sintético</em> (CS) ha sido empleado para estudiar el efecto de algunas políticas (o eventos):</p>
<ul>
<li><p>El impacto del terrorismo en la región de Cataluña</p></li>
<li><p>El efecto de una legislación contra el tabaco en California</p></li>
<li><p>El efecto sobre el crecimiento de la reunificación de Alemania</p></li>
<li><p>El efecto del flujo masivo de inmigrantes a Miami</p></li>
</ul></li>
</ul>
</section>

<section id="partimos-del-concepto-de-did" class="title-slide slide level1 center">
<h1>Partimos del concepto de DID</h1>
<ul>
<li><p>Consideremos un modelo simple de diferencia en diferencias</p></li>
<li><p>Observamos una unidad tratada y una que nunca lo fue antes y después del tratamiento</p></li>
<li><p>Bajo ciertos supuestos, el estimador de DID es el efecto del tratamiento</p></li>
<li><p>La implementación consiste en comparar la unidad tratada con una o varias no tratadas</p></li>
</ul>
</section>

<section id="cuál-es-el-efecto-de-la-inmigración-en-los-mercados-laborales" class="title-slide slide level1 center">
<h1>¿Cuál es el efecto de la inmigración en los mercados laborales?</h1>
<ul>
<li><p>Card (1990) empleó datos a nivel individual sobre salarios y empleo en el área metropolitana de Miami y los comparó con el promedio de otras cuatro ciudades con proporciones similares de hispanos y negros</p></li>
<li><p>Al comparar las tendencias en empleo y salarios con las de este conjunto de ciudades Card concluye que la llegada de inmigrantes no tuvo ningún efecto negativo</p></li>
</ul>
</section>

<section id="los-marieles" class="title-slide slide level1 center">
<h1>Los marieles</h1>

<img data-src="figures/marieles_newspaper.jpg" style="width:80.0%" class="r-stretch quarto-figure-center"><p class="caption">Fuente: Tomada de internet</p></section>

<section id="los-marieles-1" class="title-slide slide level1 center">
<h1>Los marieles</h1>
<div class="columns">
<div class="column" style="width:50%;">
<ul>
<li><p>¿Cuál es el efecto de la inmigración en los mercados laborales?</p></li>
<li><p>Card (1990) empleó datos a nivel individual sobre salarios y empleo en el área metropolitana de Miami y los comparó con el promedio de otras cuatro ciudades con proporciones similares de hispanos y negros</p></li>
<li><p>Se compara a Miami con el promedio de Atlanta, Houston, Los Angeles y Tampa</p></li>
</ul>
</div><div class="column" style="width:50%;">
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="figures/Miami_immigrants_characteristics.png" style="width:50.0%"></p>
<figcaption>Fuente: Card (1990)</figcaption>
</figure>
</div>
</div>
</div>
</div></div>
</section>

<section id="los-marieles-2" class="title-slide slide level1 center">
<h1>Los marieles</h1>

<img data-src="figures/Miami_earnings_comparison.png" style="width:70.0%" class="r-stretch quarto-figure-center"><p class="caption">Fuente: Card (1990)</p></section>

<section id="los-marieles-3" class="title-slide slide level1 center">
<h1>Los marieles</h1>

<img data-src="figures/Miami_unemployment_comparison.png" style="width:70.0%" class="r-stretch quarto-figure-center"><p class="caption">Fuente: Card (1990)</p></section>

<section id="los-marieles-4" class="title-slide slide level1 center">
<h1>Los marieles</h1>
<ul>
<li><p>Al comparar las tendencias en empleo y salarios con las de este conjunto de ciudades Card concluye que la llegada de inmigrantes no tuvo ningún efecto negativo</p></li>
<li><p>Tampoco encuentran evidencia de que la distribución de ingresos de los no cubanos se hubiera hecho más desigual</p></li>
<li><p>Tampoco hubo efectos concentrados en los grupos menos educados</p></li>
<li><p>Se concluye que Miami tuvo la capacidad para absorber el choque de oferta de trabajo sin efectos en el resto del empleo</p></li>
</ul>
</section>

<section id="otro-ejemplo-clásico-de-did" class="title-slide slide level1 center">
<h1>Otro ejemplo clásico de DID</h1>
<ul>
<li><p>El ejemplo clásico del modelo de DID es el estudio del efecto del salario mínimo en el empleo</p></li>
<li><p>Card y Krueger (1994) comparan los niveles de empleo en restaurantes de comida rápida en Nueva Jersey y Filadelfia</p></li>
<li><p>La intuición es que estas dos áreas eran muy similares antes de la subida del salario mínimo en Nueva Jersey</p></li>
<li><p>Por lo tanto, comparando las variables de resultados entre ciudades, antes y después de la subida del salario mínimo, podemos obtener el efecto del tratamiento</p></li>
<li><p>Los autores no encuentran evidencia de que la subida del salario mínimo redujera el empleo</p></li>
</ul>
</section>

<section id="crítica-a-did" class="title-slide slide level1 center">
<h1>Crítica a DID</h1>
<ul>
<li><p>¿Cómo escogemos las unidades de comparación?</p></li>
<li><p>¿Cómo podemos saber qué tan buena es la unidad de comparación como contrafactual para reproducir lo que le hubiera pasado a la unidad tratada de no haber recibido el tratamiento?</p></li>
</ul>
</section>

<section id="extender-did-sistemáticamente" class="title-slide slide level1 center">
<h1>Extender DID sistemáticamente</h1>
<ul>
<li><p>El CS permite estudiar sistemáticamente estudios de eventos</p></li>
<li><p>En otras ciencias sociales los estudios de eventos regularmente se realizan mediante un análisis detallado de las condiciones institucionales, políticas e históricas de la unidad tratada</p></li>
<li><p>El CS nos permite seleccionar sistemáticamente las unidades de comparación</p></li>
<li><p>Con las características de las unidades no tratadas se construye una unidad sintética que se emplea para compararla con la unidad tratada y medir el efecto del tratamiento</p></li>
<li><p>Se trata de crear una unidad sintética que representa a la unidad tratada como si no hubiera recibido el tratamiento</p></li>
</ul>
</section>

<section id="lo-único-que-podemos-hacer-son-estudios-cualitativos" class="title-slide slide level1 center">
<h1>¿Lo único que podemos hacer son estudios cualitativos?</h1>

<img data-src="figures/marieles_castro.jpg" class="quarto-figure quarto-figure-center r-stretch" style="width:75.0%"></section>

<section id="el-modelo" class="title-slide slide level1 inverse center middle">
<h1>El modelo</h1>

</section>

<section id="el-modelo-1" class="title-slide slide level1 center">
<h1>El modelo</h1>
<ul>
<li><p>Tenemos <span class="math inline">\(J+1\)</span> unidades, siendo <span class="math inline">\({2,...,J+1}\)</span> las no tratadas</p></li>
<li><p><span class="math inline">\(t=1,...,T\)</span> periodos</p></li>
<li><p>En <span class="math inline">\(T_0\)</span> ocurre una intervención que solo afecta a <span class="math inline">\(1\)</span></p></li>
<li><p><span class="math inline">\(Y_{it}^I\)</span> es un individuo intervenido, <span class="math inline">\(Y_{it}^N\)</span> es un individuo no intervenido</p></li>
<li><p>Asumimos que antes de la intervención, ninguna unidad fue afectada: <span class="math inline">\(Y_{it}^N=Y_{it}^I \quad \forall i,t &lt; T_0\)</span></p></li>
<li><p>El efecto del tratamiento en es:</p></li>
</ul>
<p><span class="math display">\[\alpha_1=\left(\alpha_{1T_0+1},..., \alpha_{1T}\right)\]</span></p>
<p>con <span class="math inline">\(t&gt;T_0\)</span> y <span class="math inline">\(\alpha_{1t}=Y_{1t}^I-Y_{1t}^N\)</span></p>
</section>

<section id="el-modelo-2" class="title-slide slide level1 center">
<h1>El modelo</h1>
<ul>
<li>Consideremos un modelo bastante general para la variable de interés (modelo de factores):</li>
</ul>
<p><span class="math display">\[Y_{it}^N=\delta_t+\theta_t Z_i + \lambda_t\mu_i+\varepsilon_{it}\]</span></p>
<ul>
<li><p><span class="math inline">\(Z_i\)</span> son variables no afectadas por la intervención</p></li>
<li><p><span class="math inline">\(\theta_t\)</span> es un vector de parámetros (que varía en el tiempo)</p></li>
<li><p><span class="math inline">\(\delta_t\)</span> son factores comunes desconocidos (efectos temporales en un modelo de panel)</p></li>
<li><p><span class="math inline">\(\mu_i\)</span> es un vector de factores no observados (<em>unknown loadings</em>)</p></li>
<li><p><span class="math inline">\(\lambda_t\)</span> son factores comunes no observables</p></li>
<li><p>DID ocurre cuando <span class="math inline">\(\lambda_t=\lambda\)</span></p></li>
</ul>
</section>

<section id="el-modelo-3" class="title-slide slide level1 center">
<h1>El modelo</h1>
<ul>
<li><p>Considere una matriz de pesos <span class="math inline">\(W=\left(w_2,...,w_{J+1}\right)\)</span>, con <span class="math inline">\(w_j \geq 0 \quad \forall j\geq 2\)</span></p></li>
<li><p>Los pesos están normalizados, <span class="math inline">\(w_2+\ldots+w_{J+1}=1\)</span></p></li>
<li><p>Cada valor de <span class="math inline">\(W\)</span> representa un potencial CS, es decir, un promedio ponderado de las unidades no tratadas</p></li>
<li><p>La variable de resultados para un CS (definido por <span class="math inline">\(W\)</span>) es:</p></li>
</ul>
<p><span class="math display">\[
\begin{aligned}
Y_{Wt}^N&amp;=\sum_{j=2}^{J+1} w_j Y_{jt}= \\
    &amp;=\delta_t+\theta_t \left(\sum_{j=2}^{J+1} w_j Z_j\right) + \lambda_t \left(\sum_{j=2}^{J+1} w_j \mu_j \right) + \left(\sum_{j=2}^{J+1} w_j\varepsilon_{jt} \right)
\end{aligned}
\]</span></p>
<ul>
<li>Hay una infinidad de CS, pues hay una infinidad de maneras de asignar los pesos a las unidades no tratadas</li>
</ul>
</section>

<section id="el-control-sintético-replica-el-contrafactual" class="title-slide slide level1 center">
<h1>El control sintético replica el contrafactual</h1>
<div class="columns">
<div class="column" style="width:50%;">
<ul>
<li><p>Suponga que existe una matriz <span class="math inline">\(W^*\)</span> tal que el CS replica la unidad tratada antes de la intervención</p></li>
<li><p>Esto es, el control sintético replica la variable de resultados pre-intervención</p></li>
</ul>
<p><span class="math display">\[\sum_{j=2}^{J+1} w^*_j Y_{jt}=Y_{1t} \quad \forall t\in{1,...,T_0}\]</span> - Y replica las características no afectadas por la intervención</p>
<p><span class="math display">\[\sum_{j=2}^{J+1} w^*_j Z_j=Z_1\]</span></p>
</div><div class="column" style="width:50%;">
<ul>
<li><p>Abadie, Diamond y Hainmueller (2010) dan las condiciones bajo las que el control sintético replica el contrafactual no observado, es decir, <span class="math inline">\(E\left(Y^N_{1t}-\sum_{j=2}^{J+1} w^*_j Y_{jt}\right)=0\)</span></p></li>
<li><p>Una de estas condiciones es tener suficientes periodos pre-intervención</p></li>
<li><p>Por tanto, el efecto del tratamiento puede estimarse como:</p></li>
</ul>
<p><span class="math display">\[\hat{\alpha}_{1t}=Y_{1t}-\sum_{j=2}^{J+1} w^*_j Y_{jt}=Y_{1t}-Y_{W^*t}\]</span> para <span class="math inline">\(t\in \{T_0+1,\ldots,T\}\)</span></p>
</div></div>
</section>

<section id="estimación" class="title-slide slide level1 center">
<h1>Estimación</h1>
<ul>
<li><p>Necesitamos datos de panel pre y post intervención para la variable dependiente</p></li>
<li><p>Necesitamos algunos puntos pre intervención para las variables <span class="math inline">\(Z\)</span></p></li>
<li><p>Requerimos suficientes periodos pre intervención para asegurarnos que el CS replica bien a la unidad tratada antes de la intervención</p></li>
<li><p>¿Cómo escogemos los pesos <span class="math inline">\(W\)</span>?</p></li>
</ul>
</section>

<section id="estimación-1" class="title-slide slide level1 center">
<h1>Estimación</h1>
<ul>
<li><p>Definamos <span class="math inline">\(X_1=(Z_1',\tilde{Y}_1^{K_1},\ldots,\tilde{Y}_1^{K_M})\)</span> el vector que colecciona las características de la unidad tratada preintervención</p></li>
<li><p>En el vector <span class="math inline">\(X_1\)</span> permitimos que haya <span class="math inline">\(M\)</span> combinaciones lineales de la variable de resultados pre-intervención</p></li>
<li><p>Una combinación lineal de la variable de resultados pre-intervención es</p></li>
</ul>
<p><span class="math display">\[\tilde{Y}_i^K=\sum_{s=1}^{T_0}k_sY_{is},\quad\quad K=(k_1,\ldots,k_{T_0})'\]</span></p>
<ul>
<li><p>Por ejemplo, podemos incluir el valor de la variable de resultados en algunos años pre-intervención o el promedio de todos los años pre-intervención</p></li>
<li><p>Tenemos lo mismo, pero para las unidades no tratadas, en la matriz <span class="math inline">\(X_0\)</span></p></li>
<li><p>Definimos <span class="math inline">\(X_1-X_0W\)</span> como una medida de discrepancia entre <span class="math inline">\(X_1\)</span> y <span class="math inline">\(X_0W\)</span></p></li>
</ul>
</section>

<section id="estimación-de-pesos" class="title-slide slide level1 center">
<h1>Estimación de pesos</h1>
<ul>
<li>Planteamos entonces una función objetivo para minimizar las discrepancias</li>
</ul>
<p><span class="math display">\[\min_{W\in\mathcal{W}}(X_1-X_0W)V'(X_1-X_0W)\]</span> donde <span class="math inline">\(V\)</span> es una matriz positiva definida</p>
<ul>
<li><p>La solución a este problema, <span class="math inline">\(W^*(V)\)</span> depende de <span class="math inline">\(V\)</span></p></li>
<li><p><span class="math inline">\(V\)</span> es una matriz de pesos que refleja la importancia relativa de las variables en <span class="math inline">\(X_1\)</span> y <span class="math inline">\(X_0\)</span></p></li>
<li><p>Siguiendo a Abadie &amp; Gardeazabal (2003), podemos realizar un proceso que minimice la distancia entre el valor observado de la variable de resultados y el el contrafactual definido por <span class="math inline">\(W^*(V)\)</span></p></li>
</ul>
</section>

<section id="estimación-de-pesos-1" class="title-slide slide level1 center">
<h1>Estimación de pesos</h1>
<ul>
<li><p>Definamos <span class="math inline">\(\mathcal{Y_1}\)</span> como el vector de variables de resultados en la unidad tratada para los periodos pre-intervención y <span class="math inline">\(\mathcal{Y_0}\)</span> a la matriz de las mismas variables para los no tratados</p></li>
<li><p>Entonces, podemos encontrar la <span class="math inline">\(V\)</span> óptima como</p></li>
</ul>
<p><span class="math display">\[V^*=\arg\min_{V\in\mathcal{V}}(\mathcal{Y}_1-\mathcal{Y}_0W^*(V))'(\mathcal{Y}_1-\mathcal{Y}_0W^*(V))\]</span></p>
<ul>
<li>Y entonces, los pesos para el control sintético estarán dados por <span class="math inline">\(W^*(V^*)\)</span></li>
</ul>
</section>

<section id="aplicación-la-proposición-99-en-california" class="title-slide slide level1 inverse center middle">
<h1>Aplicación: la proposición 99 en California</h1>

</section>

<section id="la-proposición-99-en-california" class="title-slide slide level1 center">
<h1>La proposición 99 en California</h1>
<div class="columns">
<div class="column" style="width:50%;">
<ul>
<li><p>En 1988 se pusieron en marcha una serie de medidas en el estado de California para tratar de reducir el consumo de tabaco</p></li>
<li><p>Las medidas incluyeron nuevos impuestos, campañas publicitarias, establecimiento de espacios libres de humo, etc.</p></li>
<li><p>Para conocer el impacto de la medida en el consumo per cápita, Abadie, Diamond y Hainmueller (2010) construyen un CS</p></li>
<li><p>¿Qué pasaría si comparamos California con el resto de los estados de EUA?</p></li>
</ul>
</div><div class="column" style="width:50%;">
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="figures/Proposition99_CA_allstates.png" style="width:100.0%"></p>
<figcaption>Fuente: Abadie, Diamond y Hainmueller (2010)</figcaption>
</figure>
</div>
</div>
</div>
</div></div>
</section>

<section id="resultados" class="title-slide slide level1 center">
<h1>Resultados</h1>
<div class="columns">
<div class="column" style="width:50%;">
<ul>
<li><p>Comparar a California con el resto de los estados no es lo más apropiado</p></li>
<li><p>El consumo de tabaco ya venía cayendo en todo el país, pero en California la tendencia era más pronunciada</p></li>
<li><p>La implementación del CS consiste en escoger a los estados no tratados de forma que puedan reproducir el comportamiento de California antes de la Proposición 99</p></li>
</ul>
</div><div class="column" style="width:50%;">
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="figures/Proposition99_CA_synthetic.png" style="width:100.0%"></p>
<figcaption>Fuente: Abadie, Diamond y Hainmueller (2010)</figcaption>
</figure>
</div>
</div>
</div>
</div></div>
</section>

<section id="el-cs-se-parece-más-a-california" class="title-slide slide level1 center">
<h1>El CS se parece más a California</h1>
<div class="columns">
<div class="column" style="width:50%;">
<ul>
<li>Al escoger los pesos apropiadamente el CS es más parecido a California que lo que era el promedio de todos los demás estados</li>
</ul>
</div><div class="column" style="width:50%;">
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="figures/Proposition99_statistics.png" style="width:100.0%"></p>
<figcaption>Fuente: Abadie, Diamond y Hainmueller (2010)</figcaption>
</figure>
</div>
</div>
</div>
</div></div>
</section>

<section id="pesos-estimados" class="title-slide slide level1 center">
<h1>Pesos estimados</h1>
<ul>
<li><p>El control sintético se caracteriza por una matriz de pesos</p></li>
<li><p>Muchas unidades no contribuyen para la construcción del contrafactual</p></li>
<li><p>Tenemos un método que nos permite asignar estos pesos de sistemática y dando más peso a los estados más parecidos a California</p></li>
</ul>

<img data-src="figures/Proposition99_weights.png" style="width:80.0%" class="r-stretch quarto-figure-center"><p class="caption">Fuente: Abadie, Diamond y Hainmueller (2010)</p></section>

<section id="efecto-del-tratamiento" class="title-slide slide level1 center">
<h1>Efecto del tratamiento</h1>
<div class="columns">
<div class="column" style="width:50%;">
<ul>
<li><p>El efecto del tratamiento está dado por la diferencia entre el consumo per cápita de cigarrillos en California y el del CS</p></li>
<li><p>Esto es la distancia vertical entre las curvas</p></li>
<li><p>Al graficar las diferencias obtenemos una gráfica más clara del efecto del tratamiento</p></li>
</ul>
</div><div class="column" style="width:50%;">
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="figures/Proposition99_gap.png" style="width:100.0%"></p>
<figcaption>Fuente: Abadie, Diamond y Hainmueller (2010)</figcaption>
</figure>
</div>
</div>
</div>
</div></div>
</section>

<section id="inferencia" class="title-slide slide level1 center">
<h1>Inferencia</h1>
<ul>
<li><p>A diferencia de las técnicas basadas en regresión, aquí no tenemos errores estándar para hacer inferencia sobre si las diferencias son estadísticamente significativas</p></li>
<li><p>Se propone hacer inferencia basada en placebos</p></li>
<li><p>Para cada estado podemos estimar su CS</p></li>
<li><p>Es una prueba placebo porque sabemos que para los demás estados no pasó una ley similar a la Proposición 99</p></li>
<li><p>Para cada placebo obtenemos una gráfica del efecto del tratamiento como la anterior, aunque sabemos que este efecto debería ser cercano a cero</p></li>
</ul>
</section>

<section id="inferencia-1" class="title-slide slide level1 center">
<h1>Inferencia</h1>
<div class="columns">
<div class="column" style="width:50%;">
<ul>
<li>Analizamos qué tan común es ver efectos de la magnitud del encontrado con el CS de California</li>
</ul>
</div><div class="column" style="width:50%;">
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="figures/Proposition99_placebos.png" style="width:100.0%"></p>
<figcaption>Fuente: Abadie, Diamond y Hainmueller (2010)</figcaption>
</figure>
</div>
</div>
</div>
</div></div>
</section>

<section id="error-de-predicción-cuadrado-medio-mspe" class="title-slide slide level1 center">
<h1>Error de predicción cuadrado medio (MSPE)</h1>
<div class="columns">
<div class="column" style="width:50%;">
<ul>
<li><p>Medida del ajuste del CS estimado</p></li>
<li><p>Promedio de las discrepancias cuadradas entre la unidad verdadera y su CS</p></li>
</ul>
<p><span class="math display">\[ratio_{j}^{MSPE}=\frac{MSPE_{post}}{MSPE_{pre}}\]</span></p>
<ul>
<li>En esta aplicación <span class="math inline">\(ratio_{CA}^{MSPE}\approx130\)</span></li>
</ul>
</div><div class="column" style="width:50%;">
<ul>
<li>Podemos ver la distribución de:</li>
</ul>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="figures/Proposition99_MSPE.png" style="width:100.0%"></p>
<figcaption>Fuente: Abadie, Diamond y Hainmueller (2010)</figcaption>
</figure>
</div>
</div>
</div>
</div></div>
</section>

<section id="otros-estudios-que-usan-control-sintético" class="title-slide slide level1 inverse center middle">
<h1>Otros estudios que usan control sintético</h1>

</section>

<section id="la-reunificación-de-alemania" class="title-slide slide level1 center">
<h1>La reunificación de Alemania</h1>
<ul>
<li><p>En 1989 cae el muro de Berlín</p></li>
<li><p>Alemania comienza una transición para convertirse en una sola nación</p></li>
<li><p>¿Cuál es el efecto de este evento político en la economía de Alemania Occidental?</p></li>
<li><p>Abadie, Diamond y Hainmueller (2015) construyen una Alemania sintética a partir de pesos asignados a Austria, Japón, Holanda, Suiza y Estados Unidos</p></li>
</ul>

<img data-src="figures/Germany_synthetic.png" style="width:55.0%" class="r-stretch quarto-figure-center"><p class="caption">Fuente: Abadie, Diamond y Hainmueller (2015)</p></section>

<section id="el-terrorismo-en-el-país-vasco" class="title-slide slide level1 center">
<h1>El terrorismo en el País Vasco</h1>
<div class="columns">
<div class="column" style="width:50%;">
<ul>
<li><p>Desde finales de los 60 ETA comenzó una serie de ataques terroristas</p></li>
<li><p>El propósito de ETA era promover la independencia del Estado vasco</p></li>
<li><p>Usando características económicas de otras regiones de España se construye un CS</p></li>
<li><p>Se estima hasta en % 9 del PIB el costo del terrorismo</p></li>
</ul>
</div><div class="column" style="width:50%;">
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="figures/Terrorism_synthetic.png" style="width:100.0%"></p>
<figcaption>Fuente: Abadie y Gardeazabal (2003)</figcaption>
</figure>
</div>
</div>
</div>
</div></div>
</section>

<section id="control-sintético-con-más-de-una-unidad-tratada" class="title-slide slide level1 inverse center middle">
<h1>Control sintético con más de una unidad tratada</h1>

</section>

<section id="el-valor-de-las-conexiones-en-tiempos-turbulentos" class="title-slide slide level1 center">
<h1>El valor de las conexiones en tiempos turbulentos</h1>
<ul>
<li><p>En medio de la crisis financiera de 2008 el entonces presidente Obama nomina a Tim Geithner como Secretario del Tesoro</p></li>
<li><p>Justo después de su nombramiento, los rendimientos de muchas empresas en las bolsas mostraron una repentina tendencia a la alza</p></li>
<li><p>Semanas después de haberse anunciado, se rumoró que un problema de impuestos podría impedirle a Geithner tomar el cargo, produciéndose el efecto contrario en el valor de las acciones</p></li>
<li><p>Acemoglu et al.&nbsp;(2016) estudian si existe una relación entre las empresas <em>conectadas</em> con Geithner y los precios de las acciones</p></li>
</ul>
</section>

<section id="control-sintético-con-más-de-un-tratado" class="title-slide slide level1 center">
<h1>Control sintético con más de un tratado</h1>
<ul>
<li><p>Los autores identifican las empresas <em>conectadas</em> con Geithner</p></li>
<li><p>De alrededor de 600 empresas en la muestra empleada, los autores identifican 66 con algún tipo de conexión con Geithner</p></li>
<li><p>Esto permite construir una unidad sintética para cada una de las unidades tratadas a partir del grupo de donadores</p></li>
<li><p>La idea es repetir lo que hemos visto en los ejemplos anteriores pero tantas veces como unidades tratadas existan</p></li>
</ul>
</section>

<section id="medida-de-rendimiento-anormal-acumulado" class="title-slide slide level1 center">
<h1>Medida de rendimiento anormal acumulado</h1>
<div class="columns">
<div class="column" style="width:50%;">
<ul>
<li><p>Para cada tratado se calculan los rendimientos anormales como la diferencia entre los rendimientos verdaderos y los rendimientos de la unidad sintética</p></li>
<li><p>Se promedian los rendimientos anormales</p></li>
</ul>
<p><span class="math display">\[\hat{\phi}(\tau,k)=\frac{\sum_{i\in treatment} \frac{\sum^{k}_{t=0} R_{it}-\hat{R}_{it}}{\hat{\sigma}_i}}{\sum_{i\in treatment} \frac{1}{\hat{\sigma}_i}}\]</span></p>
<p>con <span class="math inline">\(\hat{\sigma}_i=\sqrt{\frac{\sum_{t&lt;t_0}(R_{it}-\hat{R}_{it})^2}{T}}\)</span></p>
<ul>
<li>Se encuentran rendimientos anormales en los primeros 10 días de entre 6 y 12%</li>
</ul>
</div><div class="column" style="width:50%;">
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="figures/Connections_effects.png" style="width:120.0%"></p>
<figcaption>Fuente: Acemoglu et al.&nbsp;(2016)</figcaption>
</figure>
</div>
</div>
</div>
</div></div>
</section>

<section id="inferencia-2" class="title-slide slide level1 center">
<h1>Inferencia</h1>
<ul>
<li><p>Se obtienen 5 mil remuestreos de grupos de tratamiento placebo del mismo tamaño que el grupo tratado</p></li>
<li><p>Se calculan los rendimientos anormales en cada muestra placebo</p></li>
<li><p>El efecto estimado es significativo al 5% si no pertenece a al intervalo que contiene los percentiles <span class="math inline">\([2.5, 97.5]\)</span> de los efectos placebo</p></li>
</ul>
</section>

<section id="conclusión" class="title-slide slide level1 inverse center middle">
<h1>Conclusión</h1>

</section>

<section id="los-marieles-nuevamente" class="title-slide slide level1 center">
<h1>Los marieles nuevamente</h1>
<div class="columns">
<div class="column" style="width:50%;">
<ul>
<li><p>Parte de la motivación del uso del CS fue el estudio de Card (1990) sobre el impacto de los marieles en la economía de Miami</p></li>
<li><p>Criticamos la selección del grupo de comparación</p></li>
<li><p>Peri y Yasenov (2018) construyen un Miami sintético para estimar el efecto de los marieles</p></li>
<li><p>Muestran que las conclusiones de Card en general se sostienen</p></li>
</ul>
</div><div class="column" style="width:50%;">
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="figures/Mariels_synthetic.png" style="width:100.0%"></p>
<figcaption>Fuente: Peri y Yasenov (2018)</figcaption>
</figure>
</div>
</div>
</div>
</div></div>
</section>

<section id="conclusión-1" class="title-slide slide level1 center">
<h1>Conclusión</h1>
<ul>
<li><p>La construcción del CS se basa en lo que dicen los datos (<em>data driven</em>) para la selección de las unidades que son usadas y los pesos</p></li>
<li><p>El investigador debe ser transparente al mostrar qué tan bueno es el CS que construye</p></li>
<li><p>Para construir el CS no se usan los datos post-intervención por lo que, al menos en teoría, el investigador no debería seleccionar el CS guiado por las conclusiones que resultan</p></li>
</ul>
</section>

<section id="section" class="title-slide slide level1 center middle">
<h1></h1>
<p>Material de clase en versión preliminar.</p>
<p><strong>No reproducir, no distribuir, no citar.</strong></p>


</section>
    </div>
  <div class="quarto-auto-generated-content" style="display: none;">
<p><img src="https://d1yjjnpx0p53s8.cloudfront.net/styles/logo-thumbnail/s3/122010/logo_cide_verde.png?itok=NUstTkpt" class="slide-logo"></p>
<div class="footer footer-default">

</div>
</div></div>

  <script>window.backupDefine = window.define; window.define = undefined;</script>
  <script src="../site_libs/revealjs/dist/reveal.js"></script>
  <!-- reveal.js plugins -->
  <script src="../site_libs/revealjs/plugin/quarto-line-highlight/line-highlight.js"></script>
  <script src="../site_libs/revealjs/plugin/pdf-export/pdfexport.js"></script>
  <script src="../site_libs/revealjs/plugin/reveal-menu/menu.js"></script>
  <script src="../site_libs/revealjs/plugin/reveal-menu/quarto-menu.js"></script>
  <script src="../site_libs/revealjs/plugin/quarto-support/support.js"></script>
  

  <script src="../site_libs/revealjs/plugin/notes/notes.js"></script>
  <script src="../site_libs/revealjs/plugin/search/search.js"></script>
  <script src="../site_libs/revealjs/plugin/zoom/zoom.js"></script>
  <script src="../site_libs/revealjs/plugin/math/math.js"></script>
  <script>window.define = window.backupDefine; window.backupDefine = undefined;</script>

  <script>

      // Full list of configuration options available at:
      // https://revealjs.com/config/
      Reveal.initialize({
'controlsAuto': true,
'previewLinksAuto': false,
'pdfSeparateFragments': false,
'autoAnimateEasing': "ease",
'autoAnimateDuration': 1,
'autoAnimateUnmatched': true,
'jumpToSlide': true,
'menu': {"side":"left","useTextContentForMissingTitles":true,"markers":false,"loadIcons":false,"custom":[{"title":"Tools","icon":"<i class=\"fas fa-gear\"></i>","content":"<ul class=\"slide-menu-items\">\n<li class=\"slide-tool-item active\" data-item=\"0\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.fullscreen(event)\"><kbd>f</kbd> Fullscreen</a></li>\n<li class=\"slide-tool-item\" data-item=\"1\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.speakerMode(event)\"><kbd>s</kbd> Speaker View</a></li>\n<li class=\"slide-tool-item\" data-item=\"2\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.overview(event)\"><kbd>o</kbd> Slide Overview</a></li>\n<li class=\"slide-tool-item\" data-item=\"3\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.togglePdfExport(event)\"><kbd>e</kbd> PDF Export Mode</a></li>\n<li class=\"slide-tool-item\" data-item=\"4\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.toggleScrollView(event)\"><kbd>r</kbd> Scroll View Mode</a></li>\n<li class=\"slide-tool-item\" data-item=\"5\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.keyboardHelp(event)\"><kbd>?</kbd> Keyboard Help</a></li>\n</ul>"}],"openButton":true},
'smaller': false,
 
        // Display controls in the bottom right corner
        controls: false,

        // Help the user learn the controls by providing hints, for example by
        // bouncing the down arrow when they first encounter a vertical slide
        controlsTutorial: false,

        // Determines where controls appear, "edges" or "bottom-right"
        controlsLayout: 'edges',

        // Visibility rule for backwards navigation arrows; "faded", "hidden"
        // or "visible"
        controlsBackArrows: 'faded',

        // Display a presentation progress bar
        progress: true,

        // Display the page number of the current slide
        slideNumber: 'c/t',

        // 'all', 'print', or 'speaker'
        showSlideNumber: 'all',

        // Add the current slide number to the URL hash so that reloading the
        // page/copying the URL will return you to the same slide
        hash: true,

        // Start with 1 for the hash rather than 0
        hashOneBasedIndex: false,

        // Flags if we should monitor the hash and change slides accordingly
        respondToHashChanges: true,

        // Push each slide change to the browser history
        history: true,

        // Enable keyboard shortcuts for navigation
        keyboard: true,

        // Enable the slide overview mode
        overview: true,

        // Disables the default reveal.js slide layout (scaling and centering)
        // so that you can use custom CSS layout
        disableLayout: false,

        // Vertical centering of slides
        center: false,

        // Enables touch navigation on devices with touch input
        touch: true,

        // Loop the presentation
        loop: false,

        // Change the presentation direction to be RTL
        rtl: false,

        // see https://revealjs.com/vertical-slides/#navigation-mode
        navigationMode: 'linear',

        // Randomizes the order of slides each time the presentation loads
        shuffle: false,

        // Turns fragments on and off globally
        fragments: true,

        // Flags whether to include the current fragment in the URL,
        // so that reloading brings you to the same fragment position
        fragmentInURL: false,

        // Flags if the presentation is running in an embedded mode,
        // i.e. contained within a limited portion of the screen
        embedded: false,

        // Flags if we should show a help overlay when the questionmark
        // key is pressed
        help: true,

        // Flags if it should be possible to pause the presentation (blackout)
        pause: true,

        // Flags if speaker notes should be visible to all viewers
        showNotes: false,

        // Global override for autoplaying embedded media (null/true/false)
        autoPlayMedia: null,

        // Global override for preloading lazy-loaded iframes (null/true/false)
        preloadIframes: null,

        // Number of milliseconds between automatically proceeding to the
        // next slide, disabled when set to 0, this value can be overwritten
        // by using a data-autoslide attribute on your slides
        autoSlide: 0,

        // Stop auto-sliding after user input
        autoSlideStoppable: true,

        // Use this method for navigation when auto-sliding
        autoSlideMethod: null,

        // Specify the average time in seconds that you think you will spend
        // presenting each slide. This is used to show a pacing timer in the
        // speaker view
        defaultTiming: null,

        // Enable slide navigation via mouse wheel
        mouseWheel: false,

        // The display mode that will be used to show slides
        display: 'block',

        // Hide cursor if inactive
        hideInactiveCursor: true,

        // Time before the cursor is hidden (in ms)
        hideCursorTime: 5000,

        // Opens links in an iframe preview overlay
        previewLinks: false,

        // Transition style (none/fade/slide/convex/concave/zoom)
        transition: 'none',

        // Transition speed (default/fast/slow)
        transitionSpeed: 'default',

        // Transition style for full page slide backgrounds
        // (none/fade/slide/convex/concave/zoom)
        backgroundTransition: 'none',

        // Number of slides away from the current that are visible
        viewDistance: 3,

        // Number of slides away from the current that are visible on mobile
        // devices. It is advisable to set this to a lower number than
        // viewDistance in order to save resources.
        mobileViewDistance: 2,

        // The "normal" size of the presentation, aspect ratio will be preserved
        // when the presentation is scaled to fit different resolutions. Can be
        // specified using percentage units.
        width: 1600,

        height: 900,

        // Factor of the display size that should remain empty around the content
        margin: 0.1,

        math: {
          mathjax: 'https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/MathJax.js',
          config: 'TeX-AMS_HTML-full',
          tex2jax: {
            inlineMath: [['\\(','\\)']],
            displayMath: [['\\[','\\]']],
            balanceBraces: true,
            processEscapes: false,
            processRefs: true,
            processEnvironments: true,
            preview: 'TeX',
            skipTags: ['script','noscript','style','textarea','pre','code'],
            ignoreClass: 'tex2jax_ignore',
            processClass: 'tex2jax_process'
          },
        },

        // reveal.js plugins
        plugins: [QuartoLineHighlight, PdfExport, RevealMenu, QuartoSupport,

          RevealMath,
          RevealNotes,
          RevealSearch,
          RevealZoom
        ]
      });
    </script>
    

    <script>

      // htmlwidgets need to know to resize themselves when slides are shown/hidden.

      // Fire the "slideenter" event (handled by htmlwidgets.js) when the current

      // slide changes (different for each slide format).

      (function () {

        // dispatch for htmlwidgets

        function fireSlideEnter() {

          const event = window.document.createEvent("Event");

          event.initEvent("slideenter", true, true);

          window.document.dispatchEvent(event);

        }

    

        function fireSlideChanged(previousSlide, currentSlide) {

          fireSlideEnter();

    

          // dispatch for shiny

          if (window.jQuery) {

            if (previousSlide) {

              window.jQuery(previousSlide).trigger("hidden");

            }

            if (currentSlide) {

              window.jQuery(currentSlide).trigger("shown");

            }

          }

        }

    

        // hookup for slidy

        if (window.w3c_slidy) {

          window.w3c_slidy.add_observer(function (slide_num) {

            // slide_num starts at position 1

            fireSlideChanged(null, w3c_slidy.slides[slide_num - 1]);

          });

        }

    

      })();

    </script>

    

    <script id="quarto-html-after-body" type="application/javascript">
      window.document.addEventListener("DOMContentLoaded", function (event) {
        const tabsets =  window.document.querySelectorAll(".panel-tabset-tabby")
        tabsets.forEach(function(tabset) {
          const tabby = new Tabby('#' + tabset.id);
        });
        const isCodeAnnotation = (el) => {
          for (const clz of el.classList) {
            if (clz.startsWith('code-annotation-')) {                     
              return true;
            }
          }
          return false;
        }
        const onCopySuccess = function(e) {
          // button target
          const button = e.trigger;
          // don't keep focus
          button.blur();
          // flash "checked"
          button.classList.add('code-copy-button-checked');
          var currentTitle = button.getAttribute("title");
          button.setAttribute("title", "Copied!");
          let tooltip;
          if (window.bootstrap) {
            button.setAttribute("data-bs-toggle", "tooltip");
            button.setAttribute("data-bs-placement", "left");
            button.setAttribute("data-bs-title", "Copied!");
            tooltip = new bootstrap.Tooltip(button, 
              { trigger: "manual", 
                customClass: "code-copy-button-tooltip",
                offset: [0, -8]});
            tooltip.show();    
          }
          setTimeout(function() {
            if (tooltip) {
              tooltip.hide();
              button.removeAttribute("data-bs-title");
              button.removeAttribute("data-bs-toggle");
              button.removeAttribute("data-bs-placement");
            }
            button.setAttribute("title", currentTitle);
            button.classList.remove('code-copy-button-checked');
          }, 1000);
          // clear code selection
          e.clearSelection();
        }
        const getTextToCopy = function(trigger) {
            const codeEl = trigger.previousElementSibling.cloneNode(true);
            for (const childEl of codeEl.children) {
              if (isCodeAnnotation(childEl)) {
                childEl.remove();
              }
            }
            return codeEl.innerText;
        }
        const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
          text: getTextToCopy
        });
        clipboard.on('success', onCopySuccess);
        if (window.document.getElementById('quarto-embedded-source-code-modal')) {
          const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
            text: getTextToCopy,
            container: window.document.getElementById('quarto-embedded-source-code-modal')
          });
          clipboardModal.on('success', onCopySuccess);
        }
          var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
          var mailtoRegex = new RegExp(/^mailto:/);
            var filterRegex = new RegExp('/' + window.location.host + '/');
          var isInternal = (href) => {
              return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
          }
          // Inspect non-navigation links and adorn them if external
         var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
          for (var i=0; i<links.length; i++) {
            const link = links[i];
            if (!isInternal(link.href)) {
              // undo the damage that might have been done by quarto-nav.js in the case of
              // links that we want to consider external
              if (link.dataset.originalHref !== undefined) {
                link.href = link.dataset.originalHref;
              }
            }
          }
        function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
          const config = {
            allowHTML: true,
            maxWidth: 500,
            delay: 100,
            arrow: false,
            appendTo: function(el) {
                return el.closest('section.slide') || el.parentElement;
            },
            interactive: true,
            interactiveBorder: 10,
            theme: 'light-border',
            placement: 'bottom-start',
          };
          if (contentFn) {
            config.content = contentFn;
          }
          if (onTriggerFn) {
            config.onTrigger = onTriggerFn;
          }
          if (onUntriggerFn) {
            config.onUntrigger = onUntriggerFn;
          }
            config['offset'] = [0,0];
            config['maxWidth'] = 700;
          window.tippy(el, config); 
        }
        const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
        for (var i=0; i<noterefs.length; i++) {
          const ref = noterefs[i];
          tippyHover(ref, function() {
            // use id or data attribute instead here
            let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
            try { href = new URL(href).hash; } catch {}
            const id = href.replace(/^#\/?/, "");
            const note = window.document.getElementById(id);
            if (note) {
              return note.innerHTML;
            } else {
              return "";
            }
          });
        }
        const findCites = (el) => {
          const parentEl = el.parentElement;
          if (parentEl) {
            const cites = parentEl.dataset.cites;
            if (cites) {
              return {
                el,
                cites: cites.split(' ')
              };
            } else {
              return findCites(el.parentElement)
            }
          } else {
            return undefined;
          }
        };
        var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
        for (var i=0; i<bibliorefs.length; i++) {
          const ref = bibliorefs[i];
          const citeInfo = findCites(ref);
          if (citeInfo) {
            tippyHover(citeInfo.el, function() {
              var popup = window.document.createElement('div');
              citeInfo.cites.forEach(function(cite) {
                var citeDiv = window.document.createElement('div');
                citeDiv.classList.add('hanging-indent');
                citeDiv.classList.add('csl-entry');
                var biblioDiv = window.document.getElementById('ref-' + cite);
                if (biblioDiv) {
                  citeDiv.innerHTML = biblioDiv.innerHTML;
                }
                popup.appendChild(citeDiv);
              });
              return popup.innerHTML;
            });
          }
        }
      });
      </script>
    

</body></html>