<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="es" xml:lang="es"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.353">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Evaluación de Programas 2023 - Respuestas a la tarea 3</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<script src="../site_libs/quarto-html/quarto.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 20,
  "language": {
    "search-no-results-text": "Sin resultados",
    "search-matching-documents-text": "documentos encontrados",
    "search-copy-link-title": "Copiar el enlace en la búsqueda",
    "search-hide-matches-text": "Ocultar resultados adicionales",
    "search-more-match-text": "resultado adicional en este documento",
    "search-more-matches-text": "resultados adicionales en este documento",
    "search-clear-button-title": "Borrar",
    "search-detached-cancel-button-title": "Cancelar",
    "search-submit-button-title": "Enviar"
  }
}</script>

<script src="../site_libs/kePrint-0.0.1/kePrint.js"></script>
<link href="../site_libs/lightable-0.0.1/lightable.css" rel="stylesheet">

  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<link rel="stylesheet" href="../styles.css">
</head>

<body class="nav-sidebar docked">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Alternar barra lateral" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
      <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item">Respuestas a la tarea 3</li></ol></nav>
      <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Alternar barra lateral" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
      </a>
      <button type="button" class="btn quarto-search-button" aria-label="Buscar" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal sidebar-navigation docked overflow-auto">
    <div class="pt-lg-2 mt-2 text-center sidebar-header">
      <a href="../index.html" class="sidebar-logo-link">
      <img src="../iconoEvaluaciondeProgramasSociales.jpg" alt="" class="sidebar-logo py-0 d-lg-inline d-none">
      </a>
      <div class="sidebar-tools-main">
    <a href="https://github.com/rojasirvin/evaluacion-de-programas" title="GitHub" class="quarto-navigation-tool px-1" aria-label="GitHub"><i class="bi bi-github"></i></a>
</div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Buscar"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Home</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../programa.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Programa</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../reglas.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Reglas</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../lecturas.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Lecturas</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../presentaciones.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Presentaciones</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../tareas/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Tareas</span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">En esta página</h2>
   
  <ul>
  <li><a href="#pregunta-1" id="toc-pregunta-1" class="nav-link active" data-scroll-target="#pregunta-1">Pregunta 1</a></li>
  <li><a href="#pregunta-2" id="toc-pregunta-2" class="nav-link" data-scroll-target="#pregunta-2">Pregunta 2</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Respuestas a la tarea 3</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header>

<section id="pregunta-1" class="level2">
<h2 class="anchored" data-anchor-id="pregunta-1">Pregunta 1</h2>
<p>Stevenson, B. &amp; Wolfers, J. (2006)<a href="#fn1" class="footnote-ref" id="fnref1" role="doc-noteref"><sup>1</sup></a> estudian los efectos de la introducción de leyes que permiten el divorcio unilateral en los Estados Unidos. La librería <em>bacondecomp</em> incluye los datos usados en dicho artículo (debe instalar y cargar la librería). Usaremos los datos de 1964 a 1996 para mostrar cómo impactan las leyes de divorcio express (unilateral) a la tasa de suicidios en mujeres.</p>
<p>Al correr el pedazo de código anterior, obtendrá un objeto de datos <strong>wd</strong> en donde la variable de impacto es la tasa de suicidios en mujeres, <strong>suicide_rate</strong>, <strong>st</strong> identifica a los estados, <strong>year</strong> identifica a los años y <strong>divyear</strong> es el año en que se introdujo la legislación del divorcio unilateral. La última fila del código crea el indicador de tratamiento <strong>unilaterial</strong>, que toma el valor de 1 para los estados tratados en los periodos post tratamiento.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>wd <span class="ot">&lt;-</span> divorce <span class="sc">%&gt;%</span> </span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">filter</span>(year<span class="sc">&gt;=</span><span class="dv">1964</span> <span class="sc">&amp;</span> year<span class="sc">&lt;=</span><span class="dv">1996</span> <span class="sc">&amp;</span> sex<span class="sc">==</span><span class="dv">2</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">mutate</span>(<span class="at">suicide_rate=</span>suicide<span class="sc">*</span><span class="dv">1000000</span><span class="sc">/</span>(stpop<span class="sc">*</span>fshare),</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>   <span class="at">year=</span><span class="fu">as.numeric</span>(year),</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>   <span class="at">divyear =</span> <span class="fu">ifelse</span>(divyear<span class="sc">&gt;</span><span class="dv">1996</span>, <span class="cn">Inf</span>, divyear),</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>   <span class="at">unilateral=</span><span class="fu">ifelse</span>(year<span class="sc">&gt;</span>divyear, <span class="dv">1</span>, <span class="dv">0</span>))</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ol type="a">
<li><p>[5 puntos] ¿Por qué decimos que esta es una aplicación de la estimación de efectos de tratamiento con adopción escalonada?</p>
<p><em>En esta aplicación, cada estado comienza a ser tratado en indistintos momentos del tiempo. Si hacemos un tabulado de <strong>divyear</strong> para un año fijo, notamos cuántos estados se vuelven tratados en cada año:</em></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(<span class="fu">filter</span>(wd, year<span class="sc">==</span><span class="dv">1996</span>)<span class="sc">$</span>divyear)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
1950 1969 1970 1971 1972 1973 1974 1975 1976 1977 1980 1984 1985  Inf 
   9    2    2    7    3   11    3    2    1    3    1    1    1    5 </code></pre>
</div>
</div>
<p><em>El panel comienza en 1964, para cuando ya nueve estados habían sido tratados. Los estados van siendo tratados hasta que, para el fin del periodo analizado, 1996, solo cinco todavía no habían sido tratados. En esta aplicación, esos cinco estados son los nunca tratados.</em></p></li>
<li><p>[5 puntos] Como punto de partida, estime el efecto del tratamiento sobre <strong>suicide_rate</strong> usando efectos fijos por estado y año (TWFE) y empleando una librería específica para efectos fijos, como <em>felm</em>. Tome en cuenta la agrupación de los errores. Interprete sus resultados.</p>
<p><em>Usando felm:</em></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(<span class="fu">felm</span>(suicide_rate <span class="sc">~</span> unilateral <span class="sc">|</span> st <span class="sc">+</span> year <span class="sc">|</span> <span class="dv">0</span> <span class="sc">|</span> st,</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>              <span class="at">data =</span> wd))</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
   felm(formula = suicide_rate ~ unilateral | st + year | 0 | st,      data = wd) 

Residuals:
    Min      1Q  Median      3Q     Max 
-37.517  -6.157  -0.141   5.577  57.004 

Coefficients:
           Estimate Cluster s.e. t value Pr(&gt;|t|)  
unilateral   -3.777        2.201  -1.716   0.0923 .
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 10.85 on 1599 degrees of freedom
Multiple R-squared(full model): 0.6844   Adjusted R-squared: 0.668 
Multiple R-squared(proj model): 0.007963   Adjusted R-squared: -0.04353 
F-statistic(full model, *iid*):41.77 on 83 and 1599 DF, p-value: &lt; 2.2e-16 
F-statistic(proj model): 2.945 on 1 and 50 DF, p-value: 0.09231 </code></pre>
</div>
</div></li>
<li><p>[5 puntos] Compruebe que puede obtener el mismo resultado con una regresión lineal usando el paquete <em>lm</em> e incluyendo, además de la variable de tratamiento, dummies de estado y de año.</p>
<p><em>Estimamos con dummies:</em></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(m1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(suicide_rate <span class="sc">~</span> unilateral <span class="sc">+</span> <span class="fu">factor</span>(st) <span class="sc">+</span> <span class="fu">factor</span>(year),</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>              <span class="at">data =</span> wd))<span class="sc">$</span>coef[<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>,<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>]</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>             Estimate Std. Error   t value
(Intercept) 56.732642   2.468251 22.984953
unilateral  -3.776552   1.054148 -3.582562</code></pre>
</div>
</div>
<p><em>Luego estimamos errores agrupados:</em></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="fu">stargazer</span>(m1,</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>          <span class="at">type =</span> <span class="st">'text'</span>,</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>          <span class="at">se =</span> <span class="fu">list</span>(<span class="fu">sqrt</span>(<span class="fu">diag</span>(<span class="fu">vcovCR</span>(m1, <span class="at">cluster =</span> wd<span class="sc">$</span>st, <span class="at">type =</span> <span class="st">'CR1'</span>)))),</span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>          <span class="at">keep =</span> <span class="fu">c</span>(<span class="st">"unilateral"</span>))</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
===============================================
                        Dependent variable:    
                    ---------------------------
                           suicide_rate        
-----------------------------------------------
unilateral                    -3.777*          
                              (2.200)          

-----------------------------------------------
Observations                   1,683           
R2                             0.684           
Adjusted R2                    0.668           
Residual Std. Error     10.851 (df = 1599)     
F Statistic          41.770*** (df = 83; 1599) 
===============================================
Note:               *p&lt;0.1; **p&lt;0.05; ***p&lt;0.01</code></pre>
</div>
</div>
<p><em>Obtenemos los mismos coeficientes. Aquí también podrán volver a comprobar la importancia de usar errores agrupados. Sin agrupar, el error estimado asumiendo independencia es casi menos de la mitad que el estimado con la matriz de varianzas agrupada.</em></p></li>
<li><p>[10 puntos] Realice la descomposición de Goodman-Bacon (2021). Construya un gráfico donde muestre en el eje <span class="math inline">\(x\)</span> el peso otorgado a cada comparación 2x2 que el estimador de TWFE realiza mecánicamente y en el eje <span class="math inline">\(y\)</span> el efecto estimado correspondiente a cada comparación. Interprete el gráfico obtenido.</p>
<p><em>Como vimos en clase, la descomposición de Bacon se puede obtener con la función bacon:</em></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Goodman-Bacon decomposition</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>df_bacon <span class="ot">&lt;-</span> <span class="fu">bacon</span>(suicide_rate <span class="sc">~</span> unilateral,</span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>                  <span class="at">data =</span> wd,</span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>                  <span class="at">id_var =</span> <span class="st">"st"</span>,</span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>                  <span class="at">time_var =</span> <span class="st">"year"</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                      type  weight  avg_est
1 Earlier vs Later Treated 0.11558  0.13489
2  Later vs Always Treated 0.41990 -6.95245
3 Later vs Earlier Treated 0.23125  2.33743
4     Treated vs Untreated 0.23328 -6.05881</code></pre>
</div>
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>coef_bacon <span class="ot">&lt;-</span> <span class="fu">sum</span>(df_bacon<span class="sc">$</span>estimate <span class="sc">*</span> df_bacon<span class="sc">$</span>weight)</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">"Weighted sum of decomposition ="</span>, <span class="fu">round</span>(coef_bacon, <span class="dv">4</span>)))</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Weighted sum of decomposition = -3.7766"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>twfe <span class="ot">&lt;-</span> <span class="fu">felm</span>(suicide_rate <span class="sc">~</span> unilateral <span class="sc">|</span> st <span class="sc">+</span> year <span class="sc">|</span> <span class="dv">0</span> <span class="sc">|</span> st,</span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>              <span class="at">data =</span> wd)</span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a><span class="co">#Gráfico----</span></span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a>df_bacon <span class="sc">%&gt;%</span> </span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span>weight,</span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a>             <span class="at">y=</span>estimate,</span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true" tabindex="-1"></a>             <span class="at">shape=</span>type)) <span class="sc">+</span></span>
<span id="cb14-9"><a href="#cb14-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb14-10"><a href="#cb14-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="fu">round</span>(twfe<span class="sc">$</span>coefficients, <span class="dv">4</span>))</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="tarea-3-respuestas_files/figure-html/unnamed-chunk-6-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p><em>Las comparaciones que más pesan en el estimador de efectos fijos son las de estados tratados con los que siempre estuvieron tratados en el panel, recibiendo dos de esas comparaciones alrededor de 13 y el 7% del peso (los dos triángulos más hacia la derecha). otra comparación que recibe alrededor de 7% del peso es la de los tratados con los nunca tratados (cruz más hacia la derecha). En total, las comparaciones con los estados que iniciaron siendo tratados se llevan el 42% del peso. Las comparaciones entre los tratados tarde y los tratados temprano también reciben un peso alto de 23%.</em></p></li>
<li><p>[10 puntos] Implemente el estimador de Callaway &amp; Sant’Anna (2021) para estimar los efectos del tratamiento específicos para cada cohorte, usando el paquete <em>did</em>. Utilice como grupo de comparación los estados nunca tratados. La columna <strong>stid</strong> es un identificador numérico de los estados (lo requerirá cuando use <em>att_gt</em> del paquete <em>did</em>).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>atts_nyt <span class="ot">&lt;-</span> <span class="fu">att_gt</span>(<span class="at">yname =</span> <span class="st">"suicide_rate"</span>,</span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>                      <span class="at">tname =</span> <span class="st">"year"</span>,</span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>                      <span class="at">idname =</span> <span class="st">"stid"</span>,</span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>                      <span class="at">gname =</span> <span class="st">"divyear"</span>,</span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a>                      <span class="at">data =</span> wd,</span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a>                      <span class="at">control_group =</span> <span class="st">"nevertreated"</span>,</span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a>                      <span class="at">est_method =</span> <span class="st">'reg'</span>,</span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a>                      <span class="at">bstrap =</span> <span class="cn">TRUE</span>,</span>
<span id="cb15-9"><a href="#cb15-9" aria-hidden="true" tabindex="-1"></a>                      <span class="at">biters =</span> <span class="dv">1000</span>,</span>
<span id="cb15-10"><a href="#cb15-10" aria-hidden="true" tabindex="-1"></a>                      <span class="at">print_details =</span> <span class="cn">FALSE</span>,</span>
<span id="cb15-11"><a href="#cb15-11" aria-hidden="true" tabindex="-1"></a>                      <span class="at">panel =</span> <span class="cn">TRUE</span>)</span>
<span id="cb15-12"><a href="#cb15-12" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(atts_nyt)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
att_gt(yname = "suicide_rate", tname = "year", idname = "stid", 
    gname = "divyear", data = wd, panel = TRUE, control_group = "nevertreated", 
    bstrap = TRUE, biters = 1000, est_method = "reg", print_details = FALSE)

Reference: Callaway, Brantly and Pedro H.C. Sant'Anna.  "Difference-in-Differences with Multiple Time Periods." Journal of Econometrics, Vol. 225, No. 2, pp. 200-230, 2021. &lt;https://doi.org/10.1016/j.jeconom.2020.12.001&gt;, &lt;https://arxiv.org/abs/1803.09015&gt; 

Group-Time Average Treatment Effects:
 Group Time ATT(g,t) Std. Error [95% Simult.  Conf. Band]  
  1969 1965  -0.2781     6.8382      -38.5965     38.0404  
  1969 1966  -3.1857    12.3490      -72.3848     66.0134  
  1969 1967  12.5043     9.1245      -38.6258     63.6344  
  1969 1968   3.1310     7.6640      -39.8148     46.0769  
  1969 1969   1.1566     6.5207      -35.3828     37.6961  
  1969 1970  -3.5412    13.7105      -80.3693     73.2870  
  1969 1971  -6.7647    11.4263      -70.7930     57.2636  
  1969 1972   1.7696    10.9704      -59.7041     63.2432  
  1969 1973   2.7611     7.8980      -41.4963     47.0185  
  1969 1974  -0.3084     8.8965      -50.1608     49.5439  
  1969 1975  -0.7421     5.0161      -28.8504     27.3663  
  1969 1976 -10.6073     7.5980      -53.1832     31.9687  
  1969 1977  -3.9320    11.5267      -68.5229     60.6589  
  1969 1978 -14.0099    11.3649      -77.6941     49.6743  
  1969 1979  -8.1059    14.8965      -91.5803     75.3684  
  1969 1980 -10.6943     8.1864      -56.5678     35.1793  
  1969 1981  -3.4755    12.1039      -71.3012     64.3501  
  1969 1982  -7.0072     8.8546      -56.6251     42.6108  
  1969 1983   5.1998    13.7176      -71.6680     82.0676  
  1969 1984 -10.0771    13.3542      -84.9086     64.7543  
  1969 1985   5.9598    17.4902      -92.0483    103.9678  
  1969 1986  -8.5962    11.3904      -72.4233     55.2309  
  1969 1987  -8.6897     7.3615      -49.9409     32.5615  
  1969 1988 -11.9815     8.1718      -57.7728     33.8099  
  1969 1989  -5.9781    15.1128      -90.6643     78.7082  
  1969 1990  -7.7327    11.1956      -70.4683     55.0029  
  1969 1991 -14.7659    11.0815      -76.8624     47.3306  
  1969 1992  -6.6956     6.0470      -40.5805     27.1893  
  1969 1993   0.5290    12.8492      -71.4727     72.5307  
  1969 1994  -6.1575    15.5254      -93.1557     80.8407  
  1969 1995  -6.7870    16.7453     -100.6213     87.0474  
  1969 1996   3.0338    14.4548      -77.9650     84.0326  
  1970 1965   3.9098     3.1965      -14.0020     21.8215  
  1970 1966  -5.7213    10.1469      -62.5806     51.1379  
  1970 1967  10.0224     9.0514      -40.6980     60.7428  
  1970 1968  -5.3764     9.6023      -59.1837     48.4309  
  1970 1969  10.5202     6.3060      -24.8163     45.8566  
  1970 1970   5.6377     7.0634      -33.9428     45.2183  
  1970 1971   1.3987     5.0554      -26.9297     29.7271  
  1970 1972   1.3331     9.9630      -54.4957     57.1618  
  1970 1973 -13.0254     3.5868      -33.1246      7.0738  
  1970 1974 -12.7744     4.8529      -39.9684     14.4196  
  1970 1975 -15.3434     4.9765      -43.2299     12.5431  
  1970 1976 -19.8605     4.0152      -42.3602      2.6392  
  1970 1977 -19.5551     6.1868      -54.2234     15.1132  
  1970 1978 -33.3382    11.3308      -96.8318     30.1554  
  1970 1979 -30.5087    13.5404     -106.3838     45.3663  
  1970 1980 -44.6366    11.2559     -107.7102     18.4369  
  1970 1981 -34.0557    11.4024      -97.9504     29.8390  
  1970 1982 -38.7875    10.6562      -98.5005     20.9255  
  1970 1983 -32.9234    20.0372     -145.2041     79.3572  
  1970 1984 -34.0625    19.6180     -143.9940     75.8691  
  1970 1985 -30.6346    19.3823     -139.2453     77.9760  
  1970 1986 -37.0754    20.5583     -152.2764     78.1255  
  1970 1987 -37.6630    23.4784     -169.2265     93.9004  
  1970 1988 -43.0563    21.6326     -164.2767     78.1641  
  1970 1989 -45.1314    18.6974     -149.9041     59.6413  
  1970 1990 -43.1765    21.3856     -163.0130     76.6600  
  1970 1991 -49.9116    20.9584     -167.3545     67.5312  
  1970 1992 -50.9515    17.3083     -147.9403     46.0372  
  1970 1993 -44.5526    22.6533     -171.4926     82.3874  
  1970 1994 -51.5405    18.4825     -155.1093     52.0282  
  1970 1995 -48.4108    22.1367     -172.4562     75.6346  
  1970 1996 -48.0618    21.9354     -170.9793     74.8558  
  1971 1965  -0.3060     3.4849      -19.8343     19.2223  
  1971 1966 -12.4375    10.5886      -71.7720     46.8971  
  1971 1967  17.0967     8.8014      -32.2230     66.4165  
  1971 1968   2.6186     7.6467      -40.2307     45.4680  
  1971 1969  -2.1268     5.7755      -34.4906     30.2370  
  1971 1970   5.7625     7.0733      -33.8735     45.3984  
  1971 1971  -9.3866     7.2471      -49.9964     31.2231  
  1971 1972 -13.8393     7.7418      -57.2216     29.5429  
  1971 1973 -12.4602     8.6850      -61.1278     36.2074  
  1971 1974   0.1729     5.0449      -28.0970     28.4428  
  1971 1975  -8.8785     7.5696      -51.2955     33.5384  
  1971 1976  -7.7923     5.7258      -39.8776     24.2929  
  1971 1977  -6.3192     8.1821      -52.1686     39.5302  
  1971 1978 -17.4985    10.9369      -78.7846     43.7876  
  1971 1979 -16.1999     5.7929      -48.6610     16.2613  
  1971 1980 -22.5395     5.6743      -54.3359      9.2569  
  1971 1981 -12.5894     7.6825      -55.6388     30.4601  
  1971 1982 -20.6385    10.5840      -79.9472     38.6701  
  1971 1983 -11.0888     5.7100      -43.0852     20.9075  
  1971 1984 -12.7478     5.7733      -45.0991     19.6035  
  1971 1985  -9.3683     8.4104      -56.4969     37.7604  
  1971 1986 -16.9260     7.6832      -59.9795     26.1276  
  1971 1987 -12.9962     9.9865      -68.9566     42.9642  
  1971 1988 -14.6487     8.3408      -61.3873     32.0898  
  1971 1989 -18.7126     8.6496      -67.1813     29.7562  
  1971 1990 -17.6198     6.4314      -53.6586     18.4190  
  1971 1991 -17.2789     8.4669      -64.7242     30.1665  
  1971 1992 -22.1825     9.9762      -78.0854     33.7205  
  1971 1993  -9.1278     9.0483      -59.8307     41.5750  
  1971 1994 -13.7091     8.5905      -61.8468     34.4286  
  1971 1995 -15.3270     7.4059      -56.8265     26.1724  
  1971 1996 -11.2124     8.6789      -59.8456     37.4207  
  1972 1965   3.3603     2.5186      -10.7531     17.4737  
  1972 1966  -5.2709    11.5961      -70.2511     59.7093  
  1972 1967   8.3599     9.2510      -43.4788     60.1987  
  1972 1968   5.3444     7.9124      -38.9936     49.6824  
  1972 1969  -6.1540     5.3871      -36.3411     24.0331  
  1972 1970   5.3754     5.4356      -25.0834     35.8342  
  1972 1971  -0.7708     5.5784      -32.0298     30.4883  
  1972 1972  -5.3078     4.7937      -32.1701     21.5544  
  1972 1973  -7.1261     9.2128      -58.7510     44.4987  
  1972 1974  -4.3635     5.1215      -33.0623     24.3354  
  1972 1975 -10.7104     6.6081      -47.7394     26.3186  
  1972 1976  -8.5659     8.0852      -53.8725     36.7406  
  1972 1977  -1.7264     4.1311      -24.8757     21.4229  
  1972 1978 -19.5471     7.5119      -61.6406     22.5465  
  1972 1979  -9.7870    10.8462      -70.5650     50.9910  
  1972 1980 -16.4149     5.7881      -48.8494     16.0196  
  1972 1981  -4.6831     4.6600      -30.7960     21.4298  
  1972 1982  -9.8129     9.1136      -60.8821     41.2564  
  1972 1983  -5.7570     7.1340      -45.7329     34.2190  
  1972 1984 -11.1817     6.2206      -46.0397     23.6762  
  1972 1985  -8.5492     8.2385      -54.7143     37.6158  
  1972 1986  -3.2909     6.0028      -36.9279     30.3462  
  1972 1987 -14.5853     7.4293      -56.2161     27.0456  
  1972 1988 -12.6795     6.6497      -49.9419     24.5829  
  1972 1989 -10.9845     7.1363      -50.9735     29.0045  
  1972 1990  -7.7794     7.2056      -48.1566     32.5978  
  1972 1991 -13.7033     5.2027      -42.8572     15.4507  
  1972 1992 -11.0100     9.2755      -62.9865     40.9666  
  1972 1993 -17.3770     6.9129      -56.1140     21.3600  
  1972 1994 -16.6543     7.3725      -57.9671     24.6584  
  1972 1995 -16.0626     6.5418      -52.7202     20.5950  
  1972 1996 -13.6292     5.1469      -42.4702     15.2119  
  1973 1965   0.3154     3.6206      -19.9733     20.6040  
  1973 1966 -10.0893     9.9813      -66.0205     45.8419  
  1973 1967  16.0570     8.7611      -33.0368     65.1509  
  1973 1968  -4.8486     7.8967      -49.0985     39.4013  
  1973 1969   3.3129     5.5642      -27.8669     34.4927  
  1973 1970   5.5555     7.4287      -36.0718     47.1827  
  1973 1971  -2.0683     7.1251      -41.9945     37.8579  
  1973 1972  -0.9275     6.2392      -35.8894     34.0343  
  1973 1973   4.4106     8.7571      -44.6610     53.4821  
  1973 1974   3.2944     6.2773      -31.8810     38.4698  
  1973 1975   0.0725    11.7003      -65.4911     65.6362  
  1973 1976  -1.1180     6.8260      -39.3684     37.1325  
  1973 1977   2.7203     5.7737      -29.6332     35.0738  
  1973 1978 -10.3862     9.5042      -63.6440     42.8716  
  1973 1979  -3.4722     7.8630      -47.5334     40.5891  
  1973 1980 -11.7465     8.1421      -57.3718     33.8787  
  1973 1981  -3.1322     8.0747      -48.3798     42.1153  
  1973 1982  -7.8264    10.9099      -68.9614     53.3086  
  1973 1983  -4.3281     6.7082      -41.9180     33.2618  
  1973 1984 -10.3847     7.5781      -52.8496     32.0802  
  1973 1985  -3.3503     7.3292      -44.4205     37.7198  
  1973 1986  -9.9416     4.8590      -37.1695     17.2863  
  1973 1987 -10.5611     9.3141      -62.7535     41.6313  
  1973 1988 -13.3770     9.4850      -66.5270     39.7730  
  1973 1989  -9.7072     7.4479      -51.4422     32.0278  
  1973 1990 -12.5464     6.6400      -49.7544     24.6615  
  1973 1991 -15.9396     7.7291      -59.2502     27.3711  
  1973 1992 -17.9985     7.8706      -62.1022     26.1053  
  1973 1993 -13.8426     8.3678      -60.7322     33.0470  
  1973 1994  -9.0985     6.1712      -43.6796     25.4827  
  1973 1995 -12.4104     4.1742      -35.8012     10.9804  
  1973 1996 -14.4985     5.7450      -46.6913     17.6943  
  1974 1965  -1.7117     4.9456      -29.4248     26.0015  
  1974 1966  -3.7313    10.8591      -64.5815     57.1188  
  1974 1967   9.6967     8.7761      -39.4810     58.8744  
  1974 1968  -5.6736     8.2631      -51.9766     40.6294  
  1974 1969   4.7497     5.2724      -24.7948     34.2943  
  1974 1970   8.9528     5.3076      -20.7889     38.6944  
  1974 1971  -8.1562     5.2495      -37.5726     21.2602  
  1974 1972   5.1631     4.0280      -17.4084     27.7346  
  1974 1973  -4.1358     7.2144      -44.5625     36.2908  
  1974 1974  -1.5277     4.6559      -27.6177     24.5623  
  1974 1975  -0.2490     5.1663      -29.1987     28.7007  
  1974 1976  -4.6623     3.8814      -26.4122     17.0875  
  1974 1977  -3.6545     7.2940      -44.5270     37.2181  
  1974 1978  -9.4996     5.8599      -42.3365     23.3372  
  1974 1979  -1.7953     9.8989      -57.2647     53.6741  
  1974 1980 -10.9157     5.1319      -39.6727     17.8414  
  1974 1981  -2.9438     7.2800      -43.7383     37.8508  
  1974 1982  -6.1358     4.8690      -33.4199     21.1483  
  1974 1983  -2.2347     9.1091      -53.2785     48.8092  
  1974 1984  -7.2784     6.8910      -45.8928     31.3360  
  1974 1985   0.9048    11.0342      -60.9263     62.7360  
  1974 1986  -3.4953     9.2264      -55.1967     48.2060  
  1974 1987  -9.3045     8.2542      -55.5580     36.9489  
  1974 1988  -9.0434     8.6678      -57.6142     39.5273  
  1974 1989  -6.4758    10.0098      -62.5668     49.6152  
  1974 1990  -7.6369     8.4986      -55.2598     39.9860  
  1974 1991 -14.7133     7.7174      -57.9586     28.5320  
  1974 1992 -14.7711     8.0615      -59.9444     30.4023  
  1974 1993 -11.2274     9.5723      -64.8667     42.4118  
  1974 1994 -14.4350    10.7385      -74.6091     45.7391  
  1974 1995 -13.4194     9.8742      -68.7504     41.9117  
  1974 1996 -14.8017    10.5500      -73.9196     44.3163  
  1975 1965  19.2544    14.0026      -59.2108     97.7196  
  1975 1966 -10.7092    10.6127      -70.1784     48.7601  
  1975 1967   9.6526     8.9955      -40.7549     60.0601  
  1975 1968   5.2146     7.9016      -39.0630     49.4923  
  1975 1969  -2.1343     6.7769      -40.1092     35.8407  
  1975 1970  -5.6035     8.8883      -55.4101     44.2031  
  1975 1971   3.4917     9.4667      -49.5562     56.5395  
  1975 1972 -15.0108     7.8085      -58.7665     28.7449  
  1975 1973   9.7321     7.1463      -30.3130     49.7772  
  1975 1974   0.5633     5.8727      -32.3449     33.4714  
  1975 1975  -4.9361     3.5738      -24.9625     15.0902  
  1975 1976  -1.1020     4.2886      -25.1335     22.9295  
  1975 1977  -4.3766     9.2893      -56.4300     47.6768  
  1975 1978  -8.3191     7.7290      -51.6295     34.9913  
  1975 1979 -12.7262    14.1017      -91.7466     66.2943  
  1975 1980 -12.3662     5.2244      -41.6415     16.9092  
  1975 1981  -7.7023     6.2579      -42.7689     27.3643  
  1975 1982  -9.7198     9.3131      -61.9070     42.4674  
  1975 1983  -7.3926     5.9008      -40.4584     25.6732  
  1975 1984   8.8507     5.6634      -22.8851     40.5864  
  1975 1985  -5.6163     8.0798      -50.8921     39.6594  
  1975 1986  -5.2183     4.5772      -30.8674     20.4307  
  1975 1987  -0.8638     5.8515      -33.6531     31.9256  
  1975 1988 -15.3668    11.0217      -77.1278     46.3942  
  1975 1989  -5.4933     5.8675      -38.3726     27.3859  
  1975 1990   8.5067     5.6803      -23.3236     40.3369  
  1975 1991   0.7631     5.8979      -32.2864     33.8126  
  1975 1992  -4.2255     6.5854      -41.1276     32.6766  
  1975 1993   1.1200     2.6826      -13.9124     16.1524  
  1975 1994  -8.3655     6.9398      -47.2536     30.5227  
  1975 1995   1.8041     4.2049      -21.7584     25.3666  
  1975 1996  -6.9207     5.3540      -36.9226     23.0812  
  1976 1965  -9.2525     2.4129      -22.7733      4.2682  
  1976 1966  -7.3839    10.1469      -64.2432     49.4754  
  1976 1967   6.1953     9.0514      -44.5250     56.9157  
  1976 1968  -3.4100     7.6537      -46.2985     39.4786  
  1976 1969  -4.5734     5.3509      -34.5578     25.4109  
  1976 1970  13.6356     4.7051      -12.7299     40.0011  
  1976 1971   2.1590     5.1083      -26.4657     30.7837  
  1976 1972  -1.4512     3.6986      -22.1767     19.2743  
  1976 1973 -23.5440     6.8621      -61.9965     14.9085  
  1976 1974  37.6970     4.8065       10.7634     64.6305 *
  1976 1975  -5.8620     1.3852      -13.6241      1.9001  
  1976 1976   7.3375     6.7834      -30.6738     45.3489  
  1976 1977  35.4928     7.0378       -3.9442     74.9298  
  1976 1978  -2.2158     3.3756      -21.1314     16.6998  
  1976 1979   2.7599    11.1105      -59.4992     65.0190  
  1976 1980 -10.1277     5.1657      -39.0745     18.8190  
  1976 1981  -9.1249     7.6546      -52.0185     33.7687  
  1976 1982  -9.7529     5.2585      -39.2197     19.7138  
  1976 1983 -12.2793     5.8047      -44.8066     20.2480  
  1976 1984 -20.1148     2.1456      -32.1378     -8.0917 *
  1976 1985  -0.2053     6.9868      -39.3564     38.9457  
  1976 1986 -27.7992     8.3181      -74.4104     18.8120  
  1976 1987  -9.9985     4.4562      -34.9691     14.9722  
  1976 1988 -22.8540     6.0525      -56.7701     11.0621  
  1976 1989 -14.3020     6.6385      -51.5015     22.8975  
  1976 1990 -16.7275     3.8271      -38.1733      4.7182  
  1976 1991 -29.9838     5.5425      -61.0418      1.0742  
  1976 1992 -35.9431     6.2168      -70.7794     -1.1068 *
  1976 1993 -33.5630     6.2298      -68.4725      1.3465  
  1976 1994 -19.1785     7.2180      -59.6254     21.2683  
  1976 1995 -18.8943     9.0197      -69.4370     31.6484  
  1976 1996 -20.0712     7.6293      -62.8230     22.6805  
  1977 1965   7.9420    10.0542      -48.3977     64.2817  
  1977 1966 -17.8103    12.4207      -87.4110     51.7905  
  1977 1967  22.0500     9.5660      -31.5539     75.6539  
  1977 1968 -12.0551    12.8737      -84.1943     60.0841  
  1977 1969  11.3299    11.7771      -54.6645     77.3244  
  1977 1970   7.9543     7.9588      -36.6439     52.5525  
  1977 1971   0.9514     9.1138      -50.1186     52.0215  
  1977 1972  -1.0798     9.3060      -53.2271     51.0675  
  1977 1973  -2.0153     8.9156      -51.9750     47.9444  
  1977 1974 -10.4409     5.6640      -42.1800     21.2982  
  1977 1975  -2.6782     7.4014      -44.1529     38.7965  
  1977 1976   7.5869    17.3504      -89.6378    104.8115  
  1977 1977  -0.3083    14.6417      -82.3544     81.7379  
  1977 1978 -18.5991    15.8589     -107.4658     70.2677  
  1977 1979  -8.3001    25.9723     -153.8388    137.2387  
  1977 1980 -13.4381    22.7955     -141.1749    114.2987  
  1977 1981 -12.1467    18.8162     -117.5853     93.2918  
  1977 1982 -17.4639    16.2136     -108.3186     73.3908  
  1977 1983   6.1362    26.5031     -142.3766    154.6490  
  1977 1984  -2.9191    20.9898     -120.5375    114.6993  
  1977 1985 -14.8995    19.9984     -126.9629     97.1639  
  1977 1986 -12.3230    14.1001      -91.3344     66.6884  
  1977 1987 -23.6769    24.6475     -161.7918    114.4380  
  1977 1988 -25.5547    22.3131     -150.5886     99.4792  
  1977 1989  -9.2602    27.0136     -160.6337    142.1132  
  1977 1990 -13.7369    26.8740     -164.3281    136.8543  
  1977 1991 -25.9731    23.5938     -158.1835    106.2372  
  1977 1992 -29.9220    21.6996     -151.5181     91.6741  
  1977 1993 -14.9531    24.3941     -151.6478    121.7417  
  1977 1994 -11.6033    31.6747     -189.0958    165.8891  
  1977 1995 -29.0098    19.6368     -139.0466     81.0270  
  1977 1996 -16.0590    20.4389     -130.5903     98.4723  
  1980 1965  -3.1314     2.4129      -16.6521     10.3893  
  1980 1966  -9.4644    10.1469      -66.3237     47.3948  
  1980 1967  12.2092     9.0514      -38.5112     62.9296  
  1980 1968   3.0528     7.6537      -39.8358     45.9413  
  1980 1969  -3.6543     5.3509      -33.6387     26.3300  
  1980 1970  12.7725     4.7051      -13.5930     39.1380  
  1980 1971 -11.0126     5.1083      -39.6373     17.6121  
  1980 1972   5.2094     3.6986      -15.5161     25.9349  
  1980 1973  -8.0378     6.8621      -46.4903     30.4147  
  1980 1974   2.0132     4.8065      -24.9204     28.9467  
  1980 1975  -3.8913     1.3852      -11.6534      3.8707  
  1980 1976   4.9514     6.7834      -33.0600     42.9627  
  1980 1977  -1.8244     3.6248      -22.1364     18.4877  
  1980 1978  -6.3410     9.8931      -61.7780     49.0961  
  1980 1979   5.7875    12.3774      -63.5708     75.1458  
  1980 1980 -12.0465     7.0875      -51.7622     27.6693  
  1980 1981  -7.2766     3.7339      -28.1996     13.6465  
  1980 1982  -7.7888    13.7039      -84.5800     69.0025  
  1980 1983   3.8986     3.7649      -17.1984     24.9956  
  1980 1984  -2.3172     6.3267      -37.7696     33.1351  
  1980 1985   4.4467     5.1164      -24.2234     33.1168  
  1980 1986  -9.5981     7.0565      -49.1398     29.9436  
  1980 1987 -10.0537    11.3335      -73.5622     53.4549  
  1980 1988 -10.9789     9.1300      -62.1397     40.1819  
  1980 1989  -6.9527     6.3603      -42.5931     28.6878  
  1980 1990  -5.3312     6.2450      -40.3256     29.6632  
  1980 1991  -8.8820     8.2207      -54.9474     37.1833  
  1980 1992 -12.0023    11.0607      -73.9819     49.9773  
  1980 1993  -8.3192     7.7315      -51.6432     35.0049  
  1980 1994 -12.5474     7.1011      -52.3394     27.2445  
  1980 1995  -6.7308     8.7926      -56.0010     42.5395  
  1980 1996  -9.1678     7.0565      -48.7099     30.3743  
  1984 1965   3.7550     2.4129       -9.7657     17.2758  
  1984 1966  -9.0520    10.1469      -65.9113     47.8073  
  1984 1967  10.1591     9.0514      -40.5612     60.8795  
  1984 1968  -3.1247     7.6537      -46.0133     39.7638  
  1984 1969   4.0091     5.3509      -25.9752     33.9935  
  1984 1970   4.9470     4.7051      -21.4185     31.3126  
  1984 1971 -12.3840     5.1083      -41.0087     16.2407  
  1984 1972   5.1482     3.6986      -15.5773     25.8737  
  1984 1973  -6.4124     6.8621      -44.8649     32.0401  
  1984 1974  -5.7358     4.8065      -32.6694     21.1977  
  1984 1975  -4.0919     1.3852      -11.8539      3.6702  
  1984 1976   8.7209     6.7834      -29.2904     46.7322  
  1984 1977   2.6679     3.6248      -17.6442     22.9799  
  1984 1978  -7.3955     9.8931      -62.8326     48.0415  
  1984 1979   2.2253    12.3774      -67.1330     71.5836  
  1984 1980  -8.3661     7.0875      -48.0818     31.3497  
  1984 1981  10.0008     5.6947      -21.9101     41.9117  
  1984 1982  -3.2324    10.2795      -60.8348     54.3700  
  1984 1983  11.0979    10.6559      -48.6135     70.8092  
  1984 1984  -1.6979     3.0237      -18.6413     15.2455  
  1984 1985   4.0744     1.1821       -2.5494     10.6982  
  1984 1986  -8.0341     2.9094      -24.3373      8.2691  
  1984 1987 -10.4189     8.9490      -60.5655     39.7277  
  1984 1988  -7.8277     6.1942      -42.5375     26.8821  
  1984 1989  -9.2894     3.4826      -28.8046     10.2258  
  1984 1990  -6.2529     3.0974      -23.6097     11.1038  
  1984 1991 -10.1584     4.5533      -35.6733     15.3565  
  1984 1992 -11.4694     8.6653      -60.0261     37.0873  
  1984 1993  -9.2844     4.4284      -34.0995     15.5307  
  1984 1994 -14.6630     3.4313      -33.8909      4.5649  
  1984 1995 -12.5044     3.3329      -31.1806      6.1717  
  1984 1996 -10.2449     3.2720      -28.5799      8.0902  
  1985 1965  -2.7099     2.4129      -16.2306     10.8108  
  1985 1966  29.3180    10.1469      -27.5412     86.1773  
  1985 1967  -6.8558     9.0514      -57.5762     43.8646  
  1985 1968  -5.9545     7.6537      -48.8431     36.9340  
  1985 1969  12.1675     5.3509      -17.8168     42.1519  
  1985 1970  12.3074     4.7051      -14.0581     38.6729  
  1985 1971   4.9424     5.1083      -23.6823     33.5671  
  1985 1972   5.1718     3.6986      -15.5537     25.8974  
  1985 1973 -41.2443     6.8621      -79.6968     -2.7918 *
  1985 1974   9.0064     4.8065      -17.9271     35.9400  
  1985 1975  -9.1424     1.3852      -16.9044     -1.3803 *
  1985 1976   2.8125     6.7834      -35.1988     40.8238  
  1985 1977  -2.1400     3.6248      -22.4520     18.1721  
  1985 1978   5.7781     9.8931      -49.6589     61.2152  
  1985 1979  -3.8368    12.3774      -73.1951     65.5215  
  1985 1980   1.5265     7.0875      -38.1892     41.2423  
  1985 1981  -2.8105     5.6947      -34.7214     29.1004  
  1985 1982  13.2242    10.2795      -44.3782     70.8266  
  1985 1983  -5.5714    10.6559      -65.2827     54.1399  
  1985 1984  -5.5493     3.0237      -22.4927     11.3941  
  1985 1985  11.4728     5.1053      -17.1351     40.0807  
  1985 1986  10.1715     3.4372       -9.0894     29.4325  
  1985 1987  17.5291     5.1061      -11.0835     46.1417  
  1985 1988  -9.6423     3.9206      -31.6118     12.3272  
  1985 1989  19.8229     5.3527      -10.1716     49.8173  
  1985 1990  26.2350     0.9371       20.9839     31.4861 *
  1985 1991   6.2209     3.5620      -13.7392     26.1810  
  1985 1992  18.3602     6.2606      -16.7215     53.4419  
  1985 1993  23.0343     2.8095        7.2909     38.7777 *
  1985 1994  15.2612     6.1539      -19.2226     49.7450  
  1985 1995  15.4633     4.4738       -9.6062     40.5328  
  1985 1996  26.5282     3.5315        6.7393     46.3172 *
---
Signif. codes: `*' confidence band does not cover 0

Control Group:  Never Treated,  Anticipation Periods:  0
Estimation Method:  Outcome Regression</code></pre>
</div>
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggdid</span>(atts_nyt)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="tarea-3-respuestas_files/figure-html/unnamed-chunk-7-1.png" class="img-fluid" width="672"></p>
</div>
</div></li>
<li><p>[10 puntos] Reporte los resultados agregados obtenidos a partir del estimador Callaway &amp; Sant’Anna (2021), usando una agregación dinámica que muestre los efectos promedio para cada periodo antes y después del tratamiento. Grafique los resultados.</p>
<p><em>Graficamos:</em></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>agg.es <span class="ot">&lt;-</span> <span class="fu">aggte</span>(atts_nyt,</span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>                <span class="at">type =</span> <span class="st">"dynamic"</span>)</span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(agg.es)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
aggte(MP = atts_nyt, type = "dynamic")

Reference: Callaway, Brantly and Pedro H.C. Sant'Anna.  "Difference-in-Differences with Multiple Time Periods." Journal of Econometrics, Vol. 225, No. 2, pp. 200-230, 2021. &lt;https://doi.org/10.1016/j.jeconom.2020.12.001&gt;, &lt;https://arxiv.org/abs/1803.09015&gt; 


Overall summary of ATT's based on event-study/dynamic aggregation:  
      ATT    Std. Error     [ 95%  Conf. Int.]  
 -11.1957         3.271   -17.6067     -4.7846 *


Dynamic Effects:
 Event time Estimate Std. Error [95% Simult.  Conf. Band] 
        -20  -2.7099     2.4129      -19.8379     14.4181 
        -19  16.5365     9.8342      -53.2732     86.3462 
        -18  -7.9539     1.9546      -21.8292      5.9214 
        -17   2.1023    10.7860      -74.4640     78.6686 
        -16   4.5214     2.3279      -12.0035     21.0463 
        -15   4.3951     5.0127      -31.1885     39.9786 
        -14   0.1417     4.5181      -31.9308     32.2142 
        -13   1.6657     7.1936      -49.3994     52.7307 
        -12  -1.5362     9.7434      -70.7009     67.6284 
        -11  -9.1062     5.7918      -50.2201     32.0076 
        -10  10.5744     6.1501      -33.0831     54.2318 
         -9  -5.7346     4.1479      -35.1793     23.7101 
         -8   2.3457     2.6530      -16.4869     21.1783 
         -7  -1.6033     3.9296      -29.4980     26.2915 
         -6   4.3835     3.1444      -17.9375     26.7044 
         -5  -3.0193     3.3643      -26.9009     20.8624 
         -4   4.8722     2.4926      -12.8216     22.5661 
         -3  -0.3596     2.2355      -16.2289     15.5098 
         -2   1.1409     2.4116      -15.9779     18.2597 
         -1   1.9481     2.9384      -18.9108     22.8069 
          0  -0.8065     2.7204      -20.1179     18.5050 
          1  -2.7726     3.3131      -26.2908     20.7456 
          2  -4.2845     4.2475      -34.4362     25.8671 
          3  -3.9743     2.8785      -24.4074     16.4588 
          4  -4.5620     3.3759      -28.5259     19.4020 
          5  -7.4465     3.0342      -28.9852     14.0922 
          6  -6.2541     3.9269      -34.1297     21.6216 
          7 -10.6094     3.5435      -35.7635     14.5447 
          8  -9.9746     3.3538      -33.7817     13.8325 
          9 -10.1110     3.7213      -36.5271     16.3051 
         10 -11.0023     3.9687      -39.1750     17.1703 
         11 -12.2896     3.8440      -39.5769     14.9977 
         12  -8.8234     4.5955      -41.4455     23.7988 
         13 -12.1880     4.3426      -43.0147     18.6386 
         14 -11.2760     4.2938      -41.7561     19.2042 
         15 -14.8487     4.8411      -49.2142     19.5169 
         16 -11.6965     4.7752      -45.5940     22.2010 
         17 -14.3232     4.5913      -46.9152     18.2688 
         18 -17.1010     4.9042      -51.9143     17.7122 
         19 -17.4748     4.5767      -49.9630     15.0135 
         20 -14.9783     4.5861      -47.5336     17.5769 
         21 -15.8960     4.7291      -49.4663     17.6743 
         22 -15.2219     4.4221      -46.6124     16.1687 
         23 -16.2453     5.1432      -52.7553     20.2648 
         24 -17.8714     7.2187      -69.1143     33.3715 
         25 -17.0567    10.0747      -88.5731     54.4597 
         26 -27.4244    19.4967     -165.8243    110.9756 
         27   3.0338    13.1707      -90.4606     96.5282 
---
Signif. codes: `*' confidence band does not cover 0

Control Group:  Never Treated,  Anticipation Periods:  0
Estimation Method:  Outcome Regression</code></pre>
</div>
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggdid</span>(agg.es)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="tarea-3-respuestas_files/figure-html/unnamed-chunk-8-1.png" class="img-fluid" width="672"></p>
</div>
</div></li>
<li><p>[5 puntos] ¿Cuáles son las ventajas del estimador de Callaway &amp; Sant’Anna (2021) respecto al estimador de TWFE?</p>
<p><em>Las ventajas del estimador de Callaway &amp; Sant’Anna respecto a TWFE son las siguientes:</em> <em>- Evita las comapraciones prohibidas (usar unidades tratadas como controles para unidades que son tratadas en periodos posteriores)</em> <em>- Hace explícito el grupo de comparación que se usa para comparar a las unidades tratadas</em> <em>- Hace explícita la manera en que se agregan los resultados de cada comparación <span class="math inline">\(ATT(g,t)\)</span></em> <em>- No impone efectos monótonos en el tiempo ni homogéneos entre unidades</em></p></li>
</ol>
</section>
<section id="pregunta-2" class="level2">
<h2 class="anchored" data-anchor-id="pregunta-2">Pregunta 2</h2>
<p>La ENIGH 2020 incluyó un módulo para la evaluación del Programa Jóvenes Construyendo el futuro. Se buscó que la cobertura de la encuesta pudiera incluir suficientes participantes del programa para poder compararlos con los no participantes. Los datos en <em>datos_jcf_analisis.csv</em> fueron construidos a partir de dicha encuesta. En este ejercicio estimaremos el efecto de participar en el programa sobre el ingreso trimestral, <strong>ingtot_tri</strong>, usando métodos de matching.</p>
<p>Las siguientes variables están incluidas en el archivo de datos: <strong>mujer</strong> (dummy de sexo), <strong>indigena</strong> (dummy de pertenencia a una etnia), <strong>rural</strong> (dummy del ámbito rural), <strong>escoacum</strong> (años de escolaridad), <strong>casadounion</strong> (dummy para casados o en unión libre), <strong>jefehog</strong> (dummy para jefes del hogar), <strong>haymenores</strong> (dummy para la presencia de menores de edad en el hogar), <strong>proggob</strong> (dummy para beneficiarios de programas de gobierno), y <strong>tot_integ</strong> (número de miembros del hogar). También se incluye la clave de las entidades, <strong>cve_ent</strong>.</p>
<ol type="a">
<li><p>[5 puntos] Considere la comparación para el ingreso trimestral, <strong>ingtot_tri</strong>, entre beneficiarios y su grupo de comparación, que serán los jóvenes que no asisten a la escuela y no están empleados. Los beneficiarios tienen <em>jcf2==1</em> y los jóvenes que no asisten a la escuela y no están empleados tienen <em>jcf2==0</em>. Muestre qué tan similares o qué tan diferentes son los individuos en ambos grupos en términos de las características indicadas anteriormente y del ingreso trimestral.</p>
<p><em>Estadística descriptiva:</em></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>data.jcf <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">"../files/datos_jcf_analisis.csv"</span>)</span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1023</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><em>Aquí usé datasummary para calcular la estadística descriptiva por grupos:</em></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="fu">datasummary</span>(ingtot_tri <span class="sc">+</span> mujer <span class="sc">+</span> indigena <span class="sc">+</span> rural <span class="sc">+</span> escoacum <span class="sc">+</span> casadounion <span class="sc">+</span> jefehog <span class="sc">+</span> haymenores <span class="sc">+</span> proggob <span class="sc">+</span> tot_integ <span class="sc">~</span> <span class="fu">factor</span>(jcf2) <span class="sc">*</span> (mean <span class="sc">+</span> sd) <span class="sc">*</span> <span class="fu">Arguments</span>(<span class="at">na.rm=</span><span class="cn">TRUE</span>),</span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>                <span class="at">fmt =</span> <span class="st">"%.2f"</span>,</span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a>                <span class="at">data =</span> data.jcf)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="table table-sm table-striped small" data-quarto-postprocess="true">
<colgroup>
<col style="width: 20%">
<col style="width: 20%">
<col style="width: 20%">
<col style="width: 20%">
<col style="width: 20%">
</colgroup>
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th" style="text-align: left; empty-cells: hide; border-bottom: hidden;"></th>
<th colspan="2" data-quarto-table-cell-role="th" style="text-align: center; border-bottom: hidden; padding-bottom: 0; padding-left: 3px; padding-right: 3px;"><div style="border-bottom: 1px solid #ddd; padding-bottom: 5px; ">
0
</div></th>
<th colspan="2" data-quarto-table-cell-role="th" style="text-align: center; border-bottom: hidden; padding-bottom: 0; padding-left: 3px; padding-right: 3px;"><div style="border-bottom: 1px solid #ddd; padding-bottom: 5px; ">
1
</div></th>
</tr>
<tr class="odd">
<th style="text-align: left;" data-quarto-table-cell-role="th"></th>
<th style="text-align: right;" data-quarto-table-cell-role="th">mean</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">sd</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">mean</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">sd</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">ingtot_tri</td>
<td style="text-align: right;">1510.36</td>
<td style="text-align: right;">8478.60</td>
<td style="text-align: right;">9643.06</td>
<td style="text-align: right;">6632.56</td>
</tr>
<tr class="even">
<td style="text-align: left;">mujer</td>
<td style="text-align: right;">0.76</td>
<td style="text-align: right;">0.43</td>
<td style="text-align: right;">0.59</td>
<td style="text-align: right;">0.49</td>
</tr>
<tr class="odd">
<td style="text-align: left;">indigena</td>
<td style="text-align: right;">0.22</td>
<td style="text-align: right;">0.41</td>
<td style="text-align: right;">0.59</td>
<td style="text-align: right;">0.49</td>
</tr>
<tr class="even">
<td style="text-align: left;">rural</td>
<td style="text-align: right;">0.40</td>
<td style="text-align: right;">0.49</td>
<td style="text-align: right;">0.35</td>
<td style="text-align: right;">0.48</td>
</tr>
<tr class="odd">
<td style="text-align: left;">escoacum</td>
<td style="text-align: right;">10.39</td>
<td style="text-align: right;">3.23</td>
<td style="text-align: right;">12.03</td>
<td style="text-align: right;">2.70</td>
</tr>
<tr class="even">
<td style="text-align: left;">casadounion</td>
<td style="text-align: right;">0.53</td>
<td style="text-align: right;">0.50</td>
<td style="text-align: right;">0.41</td>
<td style="text-align: right;">0.49</td>
</tr>
<tr class="odd">
<td style="text-align: left;">jefehog</td>
<td style="text-align: right;">0.06</td>
<td style="text-align: right;">0.23</td>
<td style="text-align: right;">0.14</td>
<td style="text-align: right;">0.35</td>
</tr>
<tr class="even">
<td style="text-align: left;">haymenores</td>
<td style="text-align: right;">0.66</td>
<td style="text-align: right;">0.47</td>
<td style="text-align: right;">0.54</td>
<td style="text-align: right;">0.50</td>
</tr>
<tr class="odd">
<td style="text-align: left;">proggob</td>
<td style="text-align: right;">0.19</td>
<td style="text-align: right;">0.39</td>
<td style="text-align: right;">0.21</td>
<td style="text-align: right;">0.41</td>
</tr>
<tr class="even">
<td style="text-align: left;">tot_integ</td>
<td style="text-align: right;">4.82</td>
<td style="text-align: right;">1.97</td>
<td style="text-align: right;">4.25</td>
<td style="text-align: right;">2.00</td>
</tr>
</tbody>
</table>


</div>
</div>
<p><em>Claramente los individuos que participan en el programa son diferentes a los que no. En el programa hay una proporción menor de mujeres que en el grupo no tratado; en el grupo tratado hay un nivel mayor de escolaridad acumulada; y los individuos del grupo tratado viven en hogares más pequeños que los del grupo no tratado. Entre muchas otras diferencias.</em></p>
<p><em>El problema entonces es que existen factores que influyen en la probabilidad de recibir el tratamiento y en el ingreso, por lo que una comparación simple de individuos tratados y no tratados confundirá el efecto del tratamiento.</em></p></li>
<li><p>[5 puntos] Estime el TOT (TT o ATT) del programa en el ingreso trimestral, <strong>ingtot_tri</strong> usando el algoritmo de <em>vecino más cercano</em>. Para estimar el impacto en el ingreso trimestral se comparan a los beneficiarios de JCF con los jóvenes que no asisten a la escuela y no están empleados. Los beneficiarios tienen <em>jcf2==1</em> y los jóvenes que no asisten a la escuela y no están empleados tienen <em>jcf2==0</em>. Escoja la especificación del <em>propensity score</em> que más le parezca adecuada. Realice la inferencia estadística con errores agrupados a nivel grupo de emparejamiento. ¿De qué tamaño es el TOT estimado y es este efecto estadísticamente significativo?</p>
<p><em>Este es el modelo para el propensity score que yo escogí:</em></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>sub.data <span class="ot">&lt;-</span> data.jcf <span class="sc">%&gt;%</span></span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>dplyr<span class="sc">::</span><span class="fu">select</span>(ingtot_tri, jcf2, mujer, indigena, cve_ent, rural, escoacum, casadounion,</span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a>    jefehog, haymenores, proggob, tot_integ, factor.x)</span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a>sub.data <span class="ot">&lt;-</span> sub.data[<span class="fu">complete.cases</span>(sub.data), ]</span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-7"><a href="#cb23-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-8"><a href="#cb23-8" aria-hidden="true" tabindex="-1"></a>m.out.a <span class="ot">&lt;-</span> <span class="fu">matchit</span>(<span class="at">formula=</span>jcf2 <span class="sc">~</span> mujer <span class="sc">+</span> indigena <span class="sc">+</span> <span class="fu">factor</span>(cve_ent) <span class="sc">+</span> rural  <span class="sc">+</span> escoacum <span class="sc">+</span> casadounion <span class="sc">+</span> jefehog <span class="sc">+</span> haymenores <span class="sc">+</span> proggob <span class="sc">+</span> tot_integ,</span>
<span id="cb23-9"><a href="#cb23-9" aria-hidden="true" tabindex="-1"></a>                 <span class="at">method =</span> <span class="st">"nearest"</span>,</span>
<span id="cb23-10"><a href="#cb23-10" aria-hidden="true" tabindex="-1"></a>                 <span class="at">distance=</span> <span class="st">"glm"</span>,</span>
<span id="cb23-11"><a href="#cb23-11" aria-hidden="true" tabindex="-1"></a>                 <span class="at">replace =</span> <span class="cn">FALSE</span>,</span>
<span id="cb23-12"><a href="#cb23-12" aria-hidden="true" tabindex="-1"></a>                 <span class="at">data =</span> sub.data)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><em>Estimamos el efecto del tratamiento:</em></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>tt1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(ingtot_tri <span class="sc">~</span> jcf2,</span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>      <span class="at">data =</span> <span class="fu">match.data</span>(m.out.a))</span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a><span class="co">#Errores agrupados a nivel subclass</span></span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a><span class="fu">coeftest</span>(tt1,</span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a>         <span class="at">vcov. =</span> vcovCL,</span>
<span id="cb24-7"><a href="#cb24-7" aria-hidden="true" tabindex="-1"></a>         <span class="at">cluster =</span> <span class="sc">~</span>subclass)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
t test of coefficients:

            Estimate Std. Error t value  Pr(&gt;|t|)    
(Intercept)  1669.95     407.99  4.0931 5.735e-05 ***
jcf2         7973.11     708.27 11.2572 &lt; 2.2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
<p><em>Se estima un efecto de 7973 pesos adicionales de ingreso trimestral para los participantes en el programa.</em></p></li>
<li><p>[5 puntos] En el matching de la parte b., evalúe qué tan bueno es el procedimiento en balancear las características observadas una vez realizado el matching. Cree un <em>love plot</em> para evaluar qué tan bueno es el procedimiento de matching para obtener una muestra balanceada.</p>
<p><em>bal.tab del paquete cobalt nos permite ver un resumen del balance:</em></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Con esto elimino las dummies de estado de la salida</span></span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a><span class="fu">bal.tab</span>(m.out.a, <span class="at">m.threshold=</span><span class="fl">0.1</span>, <span class="at">un=</span>T)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Balance Measures
                       Type Diff.Un Diff.Adj        M.Threshold
distance           Distance  1.1091   0.0881     Balanced, &lt;0.1
mujer                Binary -0.1660   0.0551     Balanced, &lt;0.1
indigena             Binary  0.3714   0.0551     Balanced, &lt;0.1
factor(cve_ent)_01   Binary -0.1720  -0.0157     Balanced, &lt;0.1
factor(cve_ent)_02   Binary -0.3428  -0.0079     Balanced, &lt;0.1
factor(cve_ent)_03   Binary  0.0168   0.0079     Balanced, &lt;0.1
factor(cve_ent)_04   Binary  0.5524   0.0157     Balanced, &lt;0.1
factor(cve_ent)_05   Binary -0.0544   0.0000     Balanced, &lt;0.1
rural                Binary -0.0553   0.0709     Balanced, &lt;0.1
escoacum            Contin.  0.6086  -0.2096 Not Balanced, &gt;0.1
casadounion          Binary -0.1170   0.0709     Balanced, &lt;0.1
jefehog              Binary  0.0831   0.0551     Balanced, &lt;0.1
haymenores           Binary -0.1193   0.0787     Balanced, &lt;0.1
proggob              Binary  0.0220   0.0079     Balanced, &lt;0.1
tot_integ           Contin. -0.2856   0.0158     Balanced, &lt;0.1

Balance tally for mean differences
                   count
Balanced, &lt;0.1        14
Not Balanced, &gt;0.1     1

Variable with the greatest mean difference
 Variable Diff.Adj        M.Threshold
 escoacum  -0.2096 Not Balanced, &gt;0.1

Sample sizes
          Control Treated
All          1894     127
Matched       127     127
Unmatched    1767       0</code></pre>
</div>
</div>
<p><em>Y finalmente el loveplot:</em></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a>m.out.a[[<span class="st">"X"</span>]][[<span class="st">"factor(cve_ent)"</span>]] <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a><span class="fu">love.plot</span>(<span class="fu">bal.tab</span>(m.out.a),</span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a>      <span class="at">threshold =</span> .<span class="dv">1</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="tarea-3-respuestas_files/figure-html/unnamed-chunk-14-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p><em>Parece haber un buen balance, aunque la educación es la única variable que no queda bien balanceada. Después del emparejamiento, las medias (estandarizadas) entre tratados y no tratados difieren en más de 0.1.</em></p></li>
<li><p>[5 puntos] Estime ahora el TOT en el ingreso trimestral, como en la parte b., pero usando un caliper de 0.1 y 3 vecinos a ser emparejados. ¿Cómo cambian sus resultados respecto a los de la parte b.?</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a>sub.data <span class="ot">&lt;-</span> data.jcf <span class="sc">%&gt;%</span> </span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(ingtot_tri, jcf2, mujer, indigena, cve_ent, rural, escoacum, </span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a>           casadounion, jefehog, haymenores, proggob, tot_integ, factor.x)</span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-5"><a href="#cb29-5" aria-hidden="true" tabindex="-1"></a>sub.data <span class="ot">&lt;-</span> sub.data[<span class="fu">complete.cases</span>(sub.data), ] </span>
<span id="cb29-6"><a href="#cb29-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-7"><a href="#cb29-7" aria-hidden="true" tabindex="-1"></a>m.out.c <span class="ot">&lt;-</span> <span class="fu">matchit</span>(<span class="at">formula=</span>jcf2 <span class="sc">~</span> mujer <span class="sc">+</span> indigena <span class="sc">+</span> <span class="fu">factor</span>(cve_ent) <span class="sc">+</span> rural  <span class="sc">+</span> escoacum <span class="sc">+</span> casadounion <span class="sc">+</span> jefehog <span class="sc">+</span> haymenores <span class="sc">+</span> proggob <span class="sc">+</span> tot_integ,</span>
<span id="cb29-8"><a href="#cb29-8" aria-hidden="true" tabindex="-1"></a>                 <span class="at">method =</span> <span class="st">"nearest"</span>,</span>
<span id="cb29-9"><a href="#cb29-9" aria-hidden="true" tabindex="-1"></a>                 <span class="at">distance=</span> <span class="st">"glm"</span>,</span>
<span id="cb29-10"><a href="#cb29-10" aria-hidden="true" tabindex="-1"></a>                 <span class="at">ratio =</span> <span class="dv">3</span>,</span>
<span id="cb29-11"><a href="#cb29-11" aria-hidden="true" tabindex="-1"></a>                 <span class="at">caliper =</span> <span class="fl">0.1</span>,</span>
<span id="cb29-12"><a href="#cb29-12" aria-hidden="true" tabindex="-1"></a>                 <span class="at">replace =</span> <span class="cn">FALSE</span>,</span>
<span id="cb29-13"><a href="#cb29-13" aria-hidden="true" tabindex="-1"></a>                 <span class="at">data =</span> sub.data)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><em>Estimamos el efecto del tratamiento:</em></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>tt3 <span class="ot">&lt;-</span> <span class="fu">lm</span>(ingtot_tri <span class="sc">~</span> jcf2,</span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>      <span class="at">data =</span> <span class="fu">match.data</span>(m.out.c))</span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a><span class="co">#Errores agrupados a nivel subclass</span></span>
<span id="cb30-5"><a href="#cb30-5" aria-hidden="true" tabindex="-1"></a><span class="fu">coeftest</span>(tt3,</span>
<span id="cb30-6"><a href="#cb30-6" aria-hidden="true" tabindex="-1"></a>         <span class="at">vcov. =</span> vcovCL,</span>
<span id="cb30-7"><a href="#cb30-7" aria-hidden="true" tabindex="-1"></a>         <span class="at">cluster =</span> <span class="sc">~</span>subclass)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
t test of coefficients:

            Estimate Std. Error t value  Pr(&gt;|t|)    
(Intercept)  2261.79     438.85   5.154 4.016e-07 ***
jcf2         7302.34     717.02  10.184 &lt; 2.2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
<p><em>Se estima ahora un efecto de 7258 pesos, menor al efecto de 7973 pesos estimado en la parte b.</em></p></li>
</ol>


</section>


<div id="quarto-appendix" class="default"><section id="footnotes" class="footnotes footnotes-end-of-document" role="doc-endnotes"><h2 class="anchored quarto-appendix-heading">Notas</h2>

<ol>
<li id="fn1"><p>Stevenson, B. &amp; Wolfers, J. (2006). Bargaining in the Shadow of the Law: Divorce Laws and Family Distress. <em>The Quarterly Journal of Economics</em>, 121(1), 267-288.<a href="#fnref1" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
</ol>
</section></div></main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copiado");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copiado");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>