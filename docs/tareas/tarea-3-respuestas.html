<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="es" xml:lang="es"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.7.32">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Respuestas a la tarea 3 – Inferencia Causal 2025</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<script src="../site_libs/quarto-html/quarto.js" type="module"></script>
<script src="../site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting-37eea08aefeeee20ff55810ff984fec1.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap-209d9ab60904f1bb8f31161fafd02104.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "Sin resultados",
    "search-matching-documents-text": "documentos encontrados",
    "search-copy-link-title": "Copiar el enlace en la búsqueda",
    "search-hide-matches-text": "Ocultar resultados adicionales",
    "search-more-match-text": "resultado adicional en este documento",
    "search-more-matches-text": "resultados adicionales en este documento",
    "search-clear-button-title": "Borrar",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancelar",
    "search-submit-button-title": "Enviar",
    "search-label": "Buscar"
  }
}</script>

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<link rel="stylesheet" href="../styles.css">
</head>

<body class="nav-sidebar docked quarto-light">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Alternar barra lateral" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item">Respuestas a la tarea 3</li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Alternar barra lateral" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Buscar" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation docked overflow-auto">
    <div class="pt-lg-2 mt-2 text-center sidebar-header">
      <a href="../index.html" class="sidebar-logo-link">
      <img src="../iconoEvaluaciondeProgramasSociales.jpg" alt="" class="sidebar-logo py-0 d-lg-inline d-none">
      </a>
      <div class="sidebar-tools-main">
    <a href="https://github.com/rojasirvin/evaluacion-de-programas" title="GitHub" class="quarto-navigation-tool px-1" aria-label="GitHub"><i class="bi bi-github"></i></a>
</div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Buscar"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Home</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../programa.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Programa</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../reglas.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Reglas</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../lecturas.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Lecturas</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../presentaciones.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Presentaciones</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../cronograma.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Cronograma</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../tareas/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Tareas</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../notas/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Notas</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../diapositivas/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Diapositivas</span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">En esta página</h2>
   
  <ul>
  <li><a href="#respuestas" id="toc-respuestas" class="nav-link active" data-scroll-target="#respuestas">Respuestas</a>
  <ul class="collapse">
  <li><a href="#pregunta-1" id="toc-pregunta-1" class="nav-link" data-scroll-target="#pregunta-1">Pregunta 1</a></li>
  <li><a href="#pregunta-2" id="toc-pregunta-2" class="nav-link" data-scroll-target="#pregunta-2">Pregunta 2</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Respuestas a la tarea 3</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<section id="respuestas" class="level1">
<h1>Respuestas</h1>
<section id="pregunta-1" class="level2">
<h2 class="anchored" data-anchor-id="pregunta-1">Pregunta 1</h2>
<p>Stevenson, B. &amp; Wolfers, J. (2006)<a href="#fn1" class="footnote-ref" id="fnref1" role="doc-noteref"><sup>1</sup></a> estudian los efectos de la introducción de leyes que permiten el divorcio unilateral en los Estados Unidos. La librería <em>bacondecomp</em> incluye los datos usados en dicho artículo (debe instalar y cargar la librería). Usaremos los datos de 1964 a 1996 para mostrar cómo impactan las leyes de divorcio express (unilateral) a la tasa de suicidios en mujeres.</p>
<p>Al correr el pedazo de código anterior, obtendrá un objeto de datos <strong>wd</strong> en donde la variable de impacto es la tasa de suicidios en mujeres, <strong>suicide_rate</strong>, <strong>st</strong> identifica a los estados, <strong>year</strong> identifica a los años y <strong>divyear</strong> es el año en que se introdujo la legislación del divorcio unilateral. La última fila del código crea el indicador de tratamiento <strong>unilaterial</strong>, que toma el valor de 1 para los estados tratados en los periodos post tratamiento.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>wd <span class="ot">&lt;-</span> divorce <span class="sc">%&gt;%</span> </span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">filter</span>(year<span class="sc">&gt;=</span><span class="dv">1964</span> <span class="sc">&amp;</span> year<span class="sc">&lt;=</span><span class="dv">1996</span> <span class="sc">&amp;</span> sex<span class="sc">==</span><span class="dv">2</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">mutate</span>(<span class="at">suicide_rate=</span>suicide<span class="sc">*</span><span class="dv">1000000</span><span class="sc">/</span>(stpop<span class="sc">*</span>fshare),</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>   <span class="at">year=</span><span class="fu">as.numeric</span>(year),</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>   <span class="at">divyear =</span> <span class="fu">ifelse</span>(divyear<span class="sc">&gt;</span><span class="dv">1996</span>, <span class="cn">Inf</span>, divyear),</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>   <span class="at">unilateral=</span><span class="fu">ifelse</span>(year<span class="sc">&gt;</span>divyear, <span class="dv">1</span>, <span class="dv">0</span>))</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ol type="a">
<li><p>[5 puntos] Presente una tabla donde muestre el número de estados que es tratado en cada periodo del panel. ¿Cuántos estados son nunca tratados? ¿Cuántos estados son siempre tratados?</p>
<p><em>Si hacemos un tabulado de <strong>divyear</strong> para un año fijo, notamos cuántos estados se vuelven tratados en cada año. Solo 5 estados son nunca tratados. Por otro lado, como el panel comienza en 1964 y hay 9 estados tratados en 1950, estos 9 estados son siempre tratados.</em></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(<span class="fu">filter</span>(wd, year<span class="sc">==</span><span class="dv">1996</span>)<span class="sc">$</span>divyear)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
1950 1969 1970 1971 1972 1973 1974 1975 1976 1977 1980 1984 1985  Inf 
   9    2    2    7    3   11    3    2    1    3    1    1    1    5 </code></pre>
</div>
</div></li>
<li><p>[5 puntos] Como punto de partida, estime el efecto del tratamiento sobre <strong>suicide_rate</strong> usando efectos fijos por estado y año (TWFE) y empleando una librería específica para efectos fijos, como <em>felm</em>. Tome en cuenta la agrupación de los errores. Interprete sus resultados.</p>
<p><em>Usando felm podemos incorporar ya el nivel de agrupación de los errores:</em></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(<span class="fu">felm</span>(suicide_rate <span class="sc">~</span> unilateral <span class="sc">|</span> st <span class="sc">+</span> year <span class="sc">|</span> <span class="dv">0</span> <span class="sc">|</span> st,</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>              <span class="at">data =</span> wd))</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
   felm(formula = suicide_rate ~ unilateral | st + year | 0 | st,      data = wd) 

Residuals:
    Min      1Q  Median      3Q     Max 
-37.517  -6.157  -0.141   5.577  57.004 

Coefficients:
           Estimate Cluster s.e. t value Pr(&gt;|t|)  
unilateral   -3.777        2.201  -1.716   0.0923 .
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 10.85 on 1599 degrees of freedom
Multiple R-squared(full model): 0.6844   Adjusted R-squared: 0.668 
Multiple R-squared(proj model): 0.007963   Adjusted R-squared: -0.04353 
F-statistic(full model, *iid*):41.77 on 83 and 1599 DF, p-value: &lt; 2.2e-16 
F-statistic(proj model): 2.945 on 1 and 50 DF, p-value: 0.09231 </code></pre>
</div>
</div></li>
<li><p>[5 puntos] Compruebe que puede obtener el mismo resultado con una regresión lineal usando el paquete <em>lm</em> e incluyendo, además de la variable de tratamiento, dummies de estado y de año.</p>
<p><em>Estimamos con dummies:</em></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(m1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(suicide_rate <span class="sc">~</span> unilateral <span class="sc">+</span> <span class="fu">factor</span>(st) <span class="sc">+</span> <span class="fu">factor</span>(year),</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>              <span class="at">data =</span> wd))<span class="sc">$</span>coef[<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>,<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>]</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>             Estimate Std. Error   t value
(Intercept) 56.732642   2.468251 22.984953
unilateral  -3.776552   1.054148 -3.582562</code></pre>
</div>
</div>
<p><em>Luego estimamos errores agrupados:</em></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="fu">modelsummary</span>(<span class="fu">list</span>(m1),</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>             <span class="at">output =</span> <span class="st">'gt'</span>,</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>             <span class="at">vcov=</span>clubSandwich<span class="sc">::</span><span class="fu">vcovCR</span>(m1, <span class="at">type=</span><span class="st">'CR1'</span>, <span class="at">cluster=</span>wd<span class="sc">$</span>st),</span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>             <span class="at">coef_map =</span> <span class="st">"unilateral"</span>,</span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>             <span class="at">gof_map =</span> <span class="st">"nobs"</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="kadquisfyv" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#kadquisfyv table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#kadquisfyv thead, #kadquisfyv tbody, #kadquisfyv tfoot, #kadquisfyv tr, #kadquisfyv td, #kadquisfyv th {
  border-style: none;
}

#kadquisfyv p {
  margin: 0;
  padding: 0;
}

#kadquisfyv .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#kadquisfyv .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#kadquisfyv .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#kadquisfyv .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#kadquisfyv .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#kadquisfyv .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#kadquisfyv .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#kadquisfyv .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#kadquisfyv .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#kadquisfyv .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#kadquisfyv .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#kadquisfyv .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#kadquisfyv .gt_spanner_row {
  border-bottom-style: hidden;
}

#kadquisfyv .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#kadquisfyv .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#kadquisfyv .gt_from_md > :first-child {
  margin-top: 0;
}

#kadquisfyv .gt_from_md > :last-child {
  margin-bottom: 0;
}

#kadquisfyv .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#kadquisfyv .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#kadquisfyv .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#kadquisfyv .gt_row_group_first td {
  border-top-width: 2px;
}

#kadquisfyv .gt_row_group_first th {
  border-top-width: 2px;
}

#kadquisfyv .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#kadquisfyv .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#kadquisfyv .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#kadquisfyv .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#kadquisfyv .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#kadquisfyv .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#kadquisfyv .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#kadquisfyv .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#kadquisfyv .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#kadquisfyv .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#kadquisfyv .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#kadquisfyv .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#kadquisfyv .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#kadquisfyv .gt_left {
  text-align: left;
}

#kadquisfyv .gt_center {
  text-align: center;
}

#kadquisfyv .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#kadquisfyv .gt_font_normal {
  font-weight: normal;
}

#kadquisfyv .gt_font_bold {
  font-weight: bold;
}

#kadquisfyv .gt_font_italic {
  font-style: italic;
}

#kadquisfyv .gt_super {
  font-size: 65%;
}

#kadquisfyv .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#kadquisfyv .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#kadquisfyv .gt_indent_1 {
  text-indent: 5px;
}

#kadquisfyv .gt_indent_2 {
  text-indent: 10px;
}

#kadquisfyv .gt_indent_3 {
  text-indent: 15px;
}

#kadquisfyv .gt_indent_4 {
  text-indent: 20px;
}

#kadquisfyv .gt_indent_5 {
  text-indent: 25px;
}

#kadquisfyv .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#kadquisfyv div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>

<table class="gt_table caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
<thead>
<tr class="gt_col_headings header">
<th id="a-" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" scope="col"></th>
<th id="a(1)" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" scope="col">(1)</th>
</tr>
</thead>
<tbody class="gt_table_body">
<tr class="odd">
<td class="gt_row gt_left" headers=" ">unilateral</td>
<td class="gt_row gt_center" headers="(1)">-3.777</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers=" " style="border-bottom-width: 1px; border-bottom-style: solid; border-bottom-color: #000000"></td>
<td class="gt_row gt_center" headers="(1)" style="border-bottom-width: 1px; border-bottom-style: solid; border-bottom-color: #000000">(2.200)</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers=" ">Num.Obs.</td>
<td class="gt_row gt_center" headers="(1)">1683</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<p><em>Obtenemos los mismos coeficientes. Aquí también podrán volver a comprobar la importancia de usar errores agrupados. El error agrupado es más de dos veces más grande que el error clásico.</em></p></li>
<li><p>[10 puntos] Ahora muestre que podemos obtener el coeficiente de TWFE a partir de una regresión bivariada entre la tasa de suicidios y <strong>unilateral</strong>, una vez <em>purgada</em> por efectos fijos. Para ello, primero estime una regresión de <strong>unilateral</strong> en función de los efectos fijos. Obtenga la predicción y luego defina una nueva variable igual a la diferencia entre <strong>unilateral</strong> y la predicción que acaba de obtener. Finalmente, obtenga el coeficiente de TWFE con una regresión de la tasa de suicidios en función de la diferencia antes definida.</p>
<p><em>Corremos la primera regresión para purgar los efectos fijos:</em></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>d1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(unilateral <span class="sc">~</span> <span class="fu">factor</span>(st) <span class="sc">+</span> <span class="fu">factor</span>(year),</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>              <span class="at">data =</span> wd)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><em>Definimos la nueva variable:</em></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>wd <span class="ot">&lt;-</span> wd <span class="sc">%&gt;%</span> </span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">unilateral_hat =</span> unilateral<span class="sc">-</span><span class="fu">predict</span>(d1))</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><em>Y finalmente estimamos:</em></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(m2 <span class="ot">&lt;-</span> <span class="fu">lm</span>(suicide_rate <span class="sc">~</span> unilateral_hat,</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>              <span class="at">data =</span> wd))<span class="sc">$</span>coef[<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>,<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>]</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                Estimate Std. Error    t value
(Intercept)    54.422503  0.4585884 118.673960
unilateral_hat -3.776552  1.8276582  -2.066334</code></pre>
</div>
</div>
<p><em>Obtenemos el mismo coeficiente. Frisch–Waugh–Lovell tenían razón.</em></p></li>
<li><p>[10 puntos] Realice la descomposición de Goodman-Bacon (2021). Construya un gráfico donde muestre en el eje <span class="math inline">\(x\)</span> el peso otorgado a cada comparación 2x2 que el estimador de TWFE realiza mecánicamente y en el eje <span class="math inline">\(y\)</span> el efecto estimado correspondiente a cada comparación. Interprete el gráfico obtenido.</p>
<p><em>Como vimos en laboratorio, la descomposición de Bacon se puede obtener con la función bacon:</em></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Goodman-Bacon decomposition</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>df_bacon <span class="ot">&lt;-</span> <span class="fu">bacon</span>(suicide_rate <span class="sc">~</span> unilateral,</span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>                  <span class="at">data =</span> wd,</span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>                  <span class="at">id_var =</span> <span class="st">"st"</span>,</span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>                  <span class="at">time_var =</span> <span class="st">"year"</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                      type  weight  avg_est
1 Earlier vs Later Treated 0.11558  0.13489
2  Later vs Always Treated 0.41990 -6.95245
3 Later vs Earlier Treated 0.23125  2.33743
4     Treated vs Untreated 0.23328 -6.05881</code></pre>
</div>
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>coef_bacon <span class="ot">&lt;-</span> <span class="fu">sum</span>(df_bacon<span class="sc">$</span>estimate <span class="sc">*</span> df_bacon<span class="sc">$</span>weight)</span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">"Suma ponderada de la descomposición ="</span>, <span class="fu">round</span>(coef_bacon, <span class="dv">4</span>)))</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Suma ponderada de la descomposición = -3.7766"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>twfe <span class="ot">&lt;-</span> <span class="fu">felm</span>(suicide_rate <span class="sc">~</span> unilateral <span class="sc">|</span> st <span class="sc">+</span> year <span class="sc">|</span> <span class="dv">0</span> <span class="sc">|</span> st,</span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>              <span class="at">data =</span> wd)</span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a><span class="co">#Gráfico----</span></span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a>df_bacon <span class="sc">%&gt;%</span> </span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span>weight,</span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a>             <span class="at">y=</span>estimate,</span>
<span id="cb17-8"><a href="#cb17-8" aria-hidden="true" tabindex="-1"></a>             <span class="at">shape=</span>type)) <span class="sc">+</span></span>
<span id="cb17-9"><a href="#cb17-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb17-10"><a href="#cb17-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="fu">round</span>(twfe<span class="sc">$</span>coefficients, <span class="dv">4</span>))</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="tarea-3-respuestas_files/figure-html/unnamed-chunk-9-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p><em>Las comparaciones que más pesan en el estimador de efectos fijos son las de estados tratados con los que siempre estuvieron tratados en el panel, recibiendo dos de esas comparaciones alrededor de 13 y el 7% del peso (los dos triángulos más hacia la derecha). otra comparación que recibe alrededor de 7% del peso es la de los tratados con los nunca tratados (cruz más hacia la derecha). En total, las comparaciones con los estados que iniciaron siendo tratados se llevan el 42% del peso. Las comparaciones entre los tratados tarde y los tratados temprano también reciben un peso alto de 23%.</em></p></li>
<li><p>[10 puntos] Implemente el estimador de Callaway &amp; Sant’Anna (2021) para estimar los efectos del tratamiento específicos para cada cohorte, usando el paquete <em>did</em>. Utilice como grupo de comparación los estados <em>no tratados aún</em>. La columna <strong>stid</strong> es un identificador numérico de los estados (lo requerirá cuando use <em>att_gt</em> del paquete <em>did</em>).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>atts_nyt <span class="ot">&lt;-</span> <span class="fu">att_gt</span>(<span class="at">yname =</span> <span class="st">"suicide_rate"</span>,</span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>                      <span class="at">tname =</span> <span class="st">"year"</span>,</span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>                      <span class="at">idname =</span> <span class="st">"stid"</span>,</span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a>                      <span class="at">gname =</span> <span class="st">"divyear"</span>,</span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a>                      <span class="at">data =</span> wd,</span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a>                      <span class="at">control_group =</span> <span class="st">"notyettreated"</span>,</span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true" tabindex="-1"></a>                      <span class="at">est_method =</span> <span class="st">'reg'</span>,</span>
<span id="cb18-8"><a href="#cb18-8" aria-hidden="true" tabindex="-1"></a>                      <span class="at">bstrap =</span> <span class="cn">TRUE</span>,</span>
<span id="cb18-9"><a href="#cb18-9" aria-hidden="true" tabindex="-1"></a>                      <span class="at">biters =</span> <span class="dv">1000</span>,</span>
<span id="cb18-10"><a href="#cb18-10" aria-hidden="true" tabindex="-1"></a>                      <span class="at">print_details =</span> <span class="cn">FALSE</span>,</span>
<span id="cb18-11"><a href="#cb18-11" aria-hidden="true" tabindex="-1"></a>                      <span class="at">panel =</span> <span class="cn">TRUE</span>)</span>
<span id="cb18-12"><a href="#cb18-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-13"><a href="#cb18-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-14"><a href="#cb18-14" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(atts_nyt)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
att_gt(yname = "suicide_rate", tname = "year", idname = "stid", 
    gname = "divyear", data = wd, panel = TRUE, control_group = "notyettreated", 
    bstrap = TRUE, biters = 1000, est_method = "reg", print_details = FALSE)

Reference: Callaway, Brantly and Pedro H.C. Sant'Anna.  "Difference-in-Differences with Multiple Time Periods." Journal of Econometrics, Vol. 225, No. 2, pp. 200-230, 2021. &lt;https://doi.org/10.1016/j.jeconom.2020.12.001&gt;, &lt;https://arxiv.org/abs/1803.09015&gt; 

Group-Time Average Treatment Effects:
 Group Time ATT(g,t) Std. Error [95% Simult.  Conf. Band]  
  1969 1965  -1.9053     6.1405      -29.5867     25.7762  
  1969 1966   4.5124     7.0525      -27.2805     36.3054  
  1969 1967   0.5622     4.9455      -21.7321     22.8566  
  1969 1968   5.1789     2.9064       -7.9232     18.2811  
  1969 1969  -0.7447     4.9934      -23.2553     21.7659  
  1969 1970 -10.2717     8.3010      -47.6929     27.1495  
  1969 1971 -12.3880     7.1386      -44.5689     19.7929  
  1969 1972  -4.1259     3.4478      -19.6687     11.4168  
  1969 1973   1.4524     6.9567      -29.9089     32.8136  
  1969 1974  -1.4022     5.2420      -25.0332     22.2288  
  1969 1975  -0.9265     4.3767      -20.6570     18.8039  
  1969 1976 -12.7344     6.4442      -41.7851     16.3164  
  1969 1977  -2.3415     9.7262      -46.1877     41.5046  
  1969 1978 -11.4247    11.1641      -61.7529     38.9035  
  1969 1979  -6.0427     8.6425      -45.0036     32.9182  
  1969 1980  -7.9345     5.3771      -32.1748     16.3057  
  1969 1981  -1.7430     9.6420      -45.2095     41.7235  
  1969 1982  -6.7020     8.3839      -44.4971     31.0931  
  1969 1983   4.7154    10.2818      -41.6355     51.0663  
  1969 1984  -9.5175    12.9128      -67.7290     48.6939  
  1969 1985   5.9598    17.4902      -72.8866     84.8062  
  1969 1986  -8.5962    11.2498      -59.3109     42.1185  
  1969 1987  -8.6897     7.3489      -41.8189     24.4395  
  1969 1988 -11.9815     8.1718      -48.8201     24.8571  
  1969 1989  -5.9781    15.1128      -74.1072     62.1511  
  1969 1990  -7.7327    11.3717      -58.9966     43.5313  
  1969 1991 -14.7659    11.0815      -64.7218     35.1900  
  1969 1992  -6.6956     6.0470      -33.9556     20.5645  
  1969 1993   0.5290    12.7587      -56.9878     58.0457  
  1969 1994  -6.1575    15.7991      -77.3803     65.0653  
  1969 1995  -6.7870    16.7453      -82.2757     68.7017  
  1969 1996   3.0338    13.1707      -56.3404     62.4081  
  1970 1965   2.4919     3.1569      -11.7396     16.7234  
  1970 1966   1.8500     3.2563      -12.8297     16.5297  
  1970 1967  -2.0438     3.9505      -19.8529     15.7653  
  1970 1968  -3.7538     7.9866      -39.7579     32.2502  
  1970 1969   9.0725     3.6711       -7.4768     25.6219  
  1970 1970   0.3548     4.9721      -22.0598     22.7694  
  1970 1971  -1.9698     3.3700      -17.1620     13.2225  
  1970 1972  -1.4067     6.9512      -32.7428     29.9294  
  1970 1973 -11.2801     4.0056      -29.3377      6.7775  
  1970 1974 -11.1775     3.5540      -27.1990      4.8441  
  1970 1975 -12.0330     6.3060      -40.4607     16.3948  
  1970 1976 -17.7592     7.6619      -52.2993     16.7809  
  1970 1977 -16.3994     5.4061      -40.7704      7.9717  
  1970 1978 -29.1877    12.0586      -83.5482     25.1729  
  1970 1979 -26.8802    13.1501      -86.1612     32.4008  
  1970 1980 -39.5660    13.6041     -100.8939     21.7620  
  1970 1981 -30.0122    12.7738      -87.5968     27.5724  
  1970 1982 -36.1714    10.0301      -81.3874      9.0445  
  1970 1983 -31.0969    18.8352     -116.0069     53.8131  
  1970 1984 -31.4749    20.0628     -121.9187     58.9688  
  1970 1985 -30.6346    20.5371     -123.2168     61.9475  
  1970 1986 -37.0754    24.1231     -145.8233     71.6724  
  1970 1987 -37.6630    23.9844     -145.7855     70.4594  
  1970 1988 -43.0563    22.4801     -144.3977     58.2850  
  1970 1989 -45.1314    19.3803     -132.4987     42.2359  
  1970 1990 -43.1765    21.4977     -140.0891     53.7361  
  1970 1991 -49.9116    20.9655     -144.4248     44.6015  
  1970 1992 -50.9515    19.2650     -137.7991     35.8960  
  1970 1993 -44.5526    23.8805     -152.2067     63.1015  
  1970 1994 -51.5405    19.0185     -137.2768     34.1957  
  1970 1995 -48.4108    22.9589     -151.9102     55.0887  
  1970 1996 -48.0618    25.1718     -161.5372     65.4136  
  1971 1965  -2.2110     3.5787      -18.3438     13.9219  
  1971 1966  -5.9450     3.5492      -21.9450     10.0549  
  1971 1967   6.1535     3.6374      -10.2442     22.5512  
  1971 1968   5.3039     3.4918      -10.4371     21.0450  
  1971 1969  -4.8826     3.8605      -22.2858     12.5207  
  1971 1970   0.5878     4.9943      -21.9267     23.1023  
  1971 1971  -7.5805     5.6301      -32.9613     17.8003  
  1971 1972 -11.4260     7.0729      -43.3109     20.4589  
  1971 1973  -5.8221     7.7347      -40.6904     29.0462  
  1971 1974   5.7926     5.4662      -18.8492     30.4344  
  1971 1975   0.0590     5.4859      -24.6715     24.7895  
  1971 1976  -0.7920     8.5274      -39.2338     37.6499  
  1971 1977   0.5899     8.2679      -36.6820     37.8619  
  1971 1978  -9.5946     9.5717      -52.7441     33.5549  
  1971 1979  -8.8180     5.5568      -33.8683     16.2324  
  1971 1980 -15.0039     6.9828      -46.4826     16.4748  
  1971 1981  -6.0810     7.9577      -41.9544     29.7925  
  1971 1982 -15.5575     9.0667      -56.4308     25.3157  
  1971 1983  -6.7973     5.5044      -31.6115     18.0169  
  1971 1984  -8.1090     7.0814      -40.0322     23.8142  
  1971 1985  -9.3683     8.0469      -45.6441     26.9076  
  1971 1986 -16.9260     7.4456      -50.4909     16.6390  
  1971 1987 -12.9962    10.7142      -61.2963     35.3039  
  1971 1988 -14.6487     8.4502      -52.7426     23.4451  
  1971 1989 -18.7126     9.5400      -61.7194     24.2942  
  1971 1990 -17.6198     6.5576      -47.1816     11.9421  
  1971 1991 -17.2789     8.9760      -57.7429     23.1852  
  1971 1992 -22.1825     9.7247      -66.0218     21.6569  
  1971 1993  -9.1278     9.2652      -50.8956     32.6400  
  1971 1994 -13.7091     8.6419      -52.6673     25.2490  
  1971 1995 -15.3270     6.9067      -46.4628     15.8087  
  1971 1996 -11.2124     9.3091      -53.1781     30.7533  
  1972 1965   1.9641     1.7895       -6.1030     10.0311  
  1972 1966   2.3826     5.3453      -21.7144     26.4796  
  1972 1967  -3.8865     5.2064      -27.3572     19.5841  
  1972 1968   7.6954     2.4746       -3.4603     18.8511  
  1972 1969  -8.7084     3.0510      -22.4625      5.0457  
  1972 1970   0.1004     2.4459      -10.9258     11.1267  
  1972 1971   1.1463     3.4439      -14.3791     16.6717  
  1972 1972  -4.8115     4.6367      -25.7141     16.0911  
  1972 1973  -2.3073     6.0866      -29.7460     25.1315  
  1972 1974   0.7950     5.2143      -22.7113     24.3012  
  1972 1975  -2.8930     4.6312      -23.7704     17.9845  
  1972 1976  -2.9838     9.8721      -47.4875     41.5200  
  1972 1977   2.8759     6.0891      -24.5740     30.3259  
  1972 1978 -13.9499     6.8883      -45.0027     17.1029  
  1972 1979  -4.7118     9.2013      -46.1916     36.7679  
  1972 1980  -9.9424     6.8411      -40.7822     20.8974  
  1972 1981   0.7622     6.6688      -29.3010     30.8255  
  1972 1982  -5.7949     7.0085      -37.3896     25.7998  
  1972 1983  -2.5286     7.4045      -35.9084     30.8512  
  1972 1984  -5.7192     8.3715      -43.4584     32.0200  
  1972 1985  -8.5492     8.0820      -44.9834     27.8849  
  1972 1986  -3.2909     6.1695      -31.1033     24.5216  
  1972 1987 -14.5853     7.5205      -48.4879     19.3173  
  1972 1988 -12.6795     6.7632      -43.1684     17.8095  
  1972 1989 -10.9845     7.9994      -47.0461     25.0772  
  1972 1990  -7.7794     7.3224      -40.7891     25.2302  
  1972 1991 -13.7033     5.4556      -38.2974     10.8909  
  1972 1992 -11.0100     9.1167      -52.1084     30.0885  
  1972 1993 -17.3770     7.4747      -51.0732     16.3192  
  1972 1994 -16.6543     8.0225      -52.8199     19.5112  
  1972 1995 -16.0626     6.9916      -47.5812     15.4559  
  1972 1996 -13.6292     5.4203      -38.0640     10.8057  
  1973 1965  -1.6544     3.3908      -16.9401     13.6313  
  1973 1966  -3.5308     4.2538      -22.7071     15.6455  
  1973 1967   5.5388     5.9207      -21.1518     32.2294  
  1973 1968  -4.1286     5.2589      -27.8358     19.5785  
  1973 1969   1.9470     4.2496      -17.2104     21.1044  
  1973 1970   0.3836     5.0894      -22.5598     23.3270  
  1973 1971  -0.4064     6.4190      -29.3436     28.5309  
  1973 1972  -0.7103     6.3407      -29.2943     27.8737  
  1973 1973   9.0122     6.2397      -19.1168     37.1412  
  1973 1974   7.0826     6.5874      -22.6134     36.7787  
  1973 1975   8.7932     9.8902      -35.7923     53.3788  
  1973 1976   5.5815     6.7014      -24.6285     35.7915  
  1973 1977   9.2638     7.2308      -23.3328     41.8604  
  1973 1978  -2.8479     7.3702      -36.0733     30.3774  
  1973 1979   3.5441     7.8393      -31.7957     38.8840  
  1973 1980  -3.7998     8.8341      -43.6241     36.0245  
  1973 1981   3.7874     8.4189      -34.1656     41.7403  
  1973 1982  -2.3342     9.7743      -46.3970     41.7286  
  1973 1983   0.3746     7.1505      -31.8599     32.6092  
  1973 1984  -4.0602     8.9706      -44.4999     36.3795  
  1973 1985  -3.3503     7.1619      -35.6365     28.9359  
  1973 1986  -9.9416     5.1414      -33.1190     13.2358  
  1973 1987 -10.5611     9.2034      -52.0505     30.9283  
  1973 1988 -13.3770    10.0727      -58.7853     32.0313  
  1973 1989  -9.7072     7.0279      -41.3893     21.9748  
  1973 1990 -12.5464     6.0801      -39.9556     14.8627  
  1973 1991 -15.9396     7.5664      -50.0492     18.1700  
  1973 1992 -17.9985     7.3728      -51.2353     15.2384  
  1973 1993 -13.8426     8.5178      -52.2413     24.5561  
  1973 1994  -9.0985     5.9673      -35.9993     17.8024  
  1973 1995 -12.4104     4.0925      -30.8596      6.0387  
  1973 1996 -14.4985     5.3929      -38.8097      9.8127  
  1974 1965  -3.4980     5.3549      -27.6379     20.6419  
  1974 1966   4.0405     5.7593      -21.9227     30.0038  
  1974 1967  -2.4469     2.7233      -14.7234      9.8297  
  1974 1968  -4.1701     5.3265      -28.1820     19.8417  
  1974 1969   3.0794     1.8790       -5.3912     11.5500  
  1974 1970   3.9844     2.5294       -7.4183     15.3872  
  1974 1971  -7.0304     3.2012      -21.4618      7.4009  
  1974 1972   6.3385     3.7154      -10.4108     23.0879  
  1974 1973   0.5656     4.9582      -21.7862     22.9174  
  1974 1974  -2.4409     4.3293      -21.9574     17.0756  
  1974 1975   1.3647     5.4887      -23.3788     26.1081  
  1974 1976  -3.5756     5.8645      -30.0131     22.8619  
  1974 1977  -4.0728     5.5191      -28.9531     20.8076  
  1974 1978  -8.9231     5.6111      -34.2184     16.3721  
  1974 1979  -1.7408     6.2794      -30.0487     26.5670  
  1974 1980  -9.7770     5.3324      -33.8154     14.2615  
  1974 1981  -2.8322     5.7976      -28.9681     23.3036  
  1974 1982  -7.4517     5.1045      -30.4632     15.5598  
  1974 1983  -4.3400     7.0794      -36.2543     27.5742  
  1974 1984  -7.8279     6.3810      -36.5937     20.9378  
  1974 1985   0.9048    10.6609      -47.1550     48.9646  
  1974 1986  -3.4953     8.8307      -43.3043     36.3137  
  1974 1987  -9.3045     8.4951      -47.6009     28.9918  
  1974 1988  -9.0434     8.3841      -46.8392     28.7524  
  1974 1989  -6.4758     9.7218      -50.3020     37.3503  
  1974 1990  -7.6369     8.7947      -47.2836     32.0098  
  1974 1991 -14.7133     7.6798      -49.3340     19.9074  
  1974 1992 -14.7711     7.8638      -50.2215     20.6794  
  1974 1993 -11.2274     9.0898      -52.2046     29.7497  
  1974 1994 -14.4350    11.3593      -65.6433     36.7733  
  1974 1995 -13.4194    10.4330      -60.4518     33.6131  
  1974 1996 -14.8017    10.2410      -60.9686     31.3653  
  1975 1965  18.6039     4.5532       -1.9223     39.1300  
  1975 1966  -3.3872     3.6281      -19.7431     12.9686  
  1975 1967  -2.4321     2.3069      -12.8315      7.9674  
  1975 1968   7.3667     5.0856      -15.5592     30.2927  
  1975 1969  -4.2480     5.3591      -28.4072     19.9113  
  1975 1970 -11.4912     6.0386      -38.7133     15.7309  
  1975 1971   5.6632     7.2295      -26.9279     38.2542  
  1975 1972 -15.6310     7.0752      -47.5265     16.2645  
  1975 1973  16.2449     6.3931      -12.5755     45.0653  
  1975 1974  -0.4082     5.9861      -27.3937     26.5773  
  1975 1975  -2.3510     2.5635      -13.9074      9.2055  
  1975 1976  -2.3824     5.6502      -27.8537     23.0888  
  1975 1977  -4.1345     7.3110      -37.0928     28.8239  
  1975 1978  -7.0822     6.2944      -35.4574     21.2930  
  1975 1979 -12.0112     9.8368      -56.3558     32.3333  
  1975 1980 -10.7602     5.0286      -33.4292     11.9087  
  1975 1981  -7.1236     5.1424      -30.3057     16.0585  
  1975 1982 -10.5685     7.1460      -42.7829     21.6459  
  1975 1983  -9.0308     5.9109      -35.6774     17.6158  
  1975 1984   9.8022     3.0016       -3.7292     23.3335  
  1975 1985  -5.6163     8.0798      -42.0402     30.8075  
  1975 1986  -5.2183     4.5772      -25.8527     15.4161  
  1975 1987  -0.8638     5.2844      -24.6860     22.9585  
  1975 1988 -15.3668    11.0217      -65.0528     34.3193  
  1975 1989  -5.4933     5.8172      -31.7177     20.7311  
  1975 1990   8.5067     4.0466       -9.7354     26.7487  
  1975 1991   0.7631     5.9418      -26.0228     27.5491  
  1975 1992  -4.2255     6.0546      -31.5199     23.0689  
  1975 1993   1.1200     2.6826      -10.9734     13.2134  
  1975 1994  -8.3655     7.5932      -42.5957     25.8648  
  1975 1995   1.8041     3.4424      -13.7143     17.3225  
  1975 1996  -6.9207     5.4284      -31.3923     17.5509  
  1976 1965 -11.0522     1.6058      -18.2911     -3.8132 *
  1976 1966   0.1018     2.0890       -9.3156      9.5192  
  1976 1967  -5.9143     2.2212      -15.9274      4.0988  
  1976 1968  -1.6479     1.9821      -10.5832      7.2874  
  1976 1969  -6.6407     1.7017      -14.3121      1.0306  
  1976 1970   8.5784     2.0845       -0.8185     17.9753  
  1976 1971   4.0973     2.4906       -7.1305     15.3250  
  1976 1972  -0.9903     2.9130      -14.1222     12.1417  
  1976 1973 -20.1263     3.6767      -36.7010     -3.5515 *
  1976 1974  39.6133     2.6393       27.7152     51.5114 *
  1976 1975  -3.5747     2.6605      -15.5685      8.4190  
  1976 1976   3.7698     5.2253      -19.7862     27.3257  
  1976 1977  33.5942     4.7714       12.0846     55.1038 *
  1976 1978  -3.1195     2.3719      -13.8123      7.5732  
  1976 1979   1.3342     7.1944      -31.0986     33.7670  
  1976 1980 -10.4124     3.8152      -27.6116      6.7868  
  1976 1981 -10.4368     5.7455      -36.3375     15.4639  
  1976 1982 -12.4922     3.5001      -28.2710      3.2866  
  1976 1983 -15.8081     6.2465      -43.9674     12.3512  
  1976 1984 -20.6870     2.9192      -33.8468     -7.5272 *
  1976 1985  -0.2053     6.9868      -31.7019     31.2913  
  1976 1986 -27.7992     8.3181      -65.2974      9.6990  
  1976 1987  -9.9985     4.4562      -30.0870     10.0901  
  1976 1988 -22.8540     6.0525      -50.1391      4.4311  
  1976 1989 -14.3020     6.9493      -45.6298     17.0258  
  1976 1990 -16.7275     3.8271      -33.9804      0.5254  
  1976 1991 -29.9838     5.5425      -54.9696     -4.9980 *
  1976 1992 -35.9431     6.2168      -63.9685     -7.9176 *
  1976 1993 -33.5630     6.2298      -61.6473     -5.4787 *
  1976 1994 -19.1785     7.2180      -51.7176     13.3605  
  1976 1995 -18.8943     9.0197      -59.5553     21.7668  
  1976 1996 -20.0712     8.0000      -56.1354     15.9929  
  1977 1965   6.8982    11.8858      -46.6836     60.4801  
  1977 1966 -11.1214     8.0894      -47.5887     25.3460  
  1977 1967  10.8566     5.9309      -15.8802     37.5935  
  1977 1968 -11.0425    11.8746      -64.5737     42.4886  
  1977 1969  10.1932    12.4584      -45.9698     66.3561  
  1977 1970   2.9004     6.3109      -25.5492     31.3500  
  1977 1971   3.0530     9.1348      -38.1268     44.2329  
  1977 1972  -0.6535    10.3244      -47.1964     45.8894  
  1977 1973   3.1405     8.4259      -34.8436     41.1246  
  1977 1974 -14.4506     6.1112      -42.0001     13.0988  
  1977 1975  -0.1240     5.0587      -22.9290     22.6810  
  1977 1976   5.5263    19.3433      -81.6743     92.7269  
  1977 1977  -0.1462    15.7106      -70.9703     70.6779  
  1977 1978 -17.4422    17.7823      -97.6056     62.7212  
  1977 1979  -7.6652    30.2685     -144.1170    128.7865  
  1977 1980 -12.0752    25.0520     -125.0107    100.8604  
  1977 1981 -11.8110    21.3475     -108.0464     84.4245  
  1977 1982 -18.5556    17.8316      -98.9413     61.8302  
  1977 1983   4.2551    31.8680     -139.4071    147.9172  
  1977 1984  -3.0226    24.6992     -114.3677    108.3225  
  1977 1985 -14.8995    20.5774     -107.6631     77.8640  
  1977 1986 -12.3230    14.7968      -79.0274     54.3815  
  1977 1987 -23.6769    28.6050     -152.6296    105.2757  
  1977 1988 -25.5547    22.5058     -127.0119     75.9025  
  1977 1989  -9.2602    29.9520     -144.2850    125.7645  
  1977 1990 -13.7369    29.6655     -147.4700    119.9962  
  1977 1991 -25.9731    24.8184     -137.8555     85.9093  
  1977 1992 -29.9220    23.5284     -135.9889     76.1449  
  1977 1993 -14.9531    27.8362     -140.4398    110.5337  
  1977 1994 -11.6033    35.8457     -173.1972    149.9905  
  1977 1995 -29.0098    21.3924     -125.4474     67.4278  
  1977 1996 -16.0590    22.1479     -115.9024     83.7844  
  1980 1965  -4.7817     1.6287      -12.1238      2.5604  
  1980 1966  -2.0295     2.0824      -11.4171      7.3581  
  1980 1967   0.2462     2.1926       -9.6383     10.1308  
  1980 1968   4.9725     1.9833       -3.9684     13.9134  
  1980 1969  -5.6981     1.7426      -13.5538      2.1576  
  1980 1970   7.6920     2.1250       -1.8874     17.2714  
  1980 1971  -9.5134     2.4770      -20.6797      1.6530  
  1980 1972   5.9170     2.9142       -7.2204     19.0545  
  1980 1973  -3.6509     4.0446      -21.8840     14.5821  
  1980 1974   1.1846     4.3682      -18.5076     20.8768  
  1980 1975  -1.4249     2.7006      -13.5995     10.7497  
  1980 1976   1.5220     5.8098      -24.6690     27.7129  
  1980 1977  -1.8998     2.7272      -14.1943     10.3947  
  1980 1978  -6.1099     5.6679      -31.6611     19.4413  
  1980 1979   6.0177     8.3504      -31.6263     43.6617  
  1980 1980 -11.0694     5.2999      -34.9617     12.8229  
  1980 1981  -7.3267     2.5718      -18.9203      4.2669  
  1980 1982  -9.2663     9.4583      -51.9049     33.3723  
  1980 1983   1.6316     3.2861      -13.1823     16.4455  
  1980 1984  -2.4538     5.2385      -26.0692     21.1616  
  1980 1985   4.4467     5.1164      -18.6181     27.5115  
  1980 1986  -9.5981     7.0565      -41.4090     22.2127  
  1980 1987 -10.0537    11.3335      -61.1456     41.0382  
  1980 1988 -10.9789     9.1300      -52.1372     30.1794  
  1980 1989  -6.9527     5.9212      -33.6456     19.7403  
  1980 1990  -5.3312     5.6717      -30.8994     20.2371  
  1980 1991  -8.8820     7.9543      -44.7405     26.9765  
  1980 1992 -12.0023     9.9672      -56.9347     32.9302  
  1980 1993  -8.3192     7.7315      -43.1729     26.5345  
  1980 1994 -12.5474     7.1011      -44.5596     19.4648  
  1980 1995  -6.7308     8.7926      -46.3682     32.9066  
  1980 1996  -9.1678     7.0565      -40.9790     22.6433  
  1984 1965   2.2727     1.6854       -5.3253      9.8707  
  1984 1966  -1.6070     2.0826      -10.9955      7.7815  
  1984 1967  -1.8538     2.1902      -11.7272      8.0195  
  1984 1968  -1.3557     1.9852      -10.3051      7.5938  
  1984 1969   2.1619     1.7259       -5.6184      9.9422  
  1984 1970  -0.3449     2.0943       -9.7861      9.0962  
  1984 1971 -10.9305     2.4526      -21.9868      0.1258  
  1984 1972   5.8536     2.8914       -7.1809     18.8881  
  1984 1973  -1.9239     4.0438      -20.1534     16.3056  
  1984 1974  -7.1605     4.3743      -26.8800     12.5590  
  1984 1975  -1.6437     2.7194      -13.9029     10.6155  
  1984 1976   5.6685     5.4752      -19.0140     30.3509  
  1984 1977   3.2342     2.8571       -9.6457     16.1141  
  1984 1978  -7.3151     5.6041      -32.5786     17.9483  
  1984 1979   1.9466     8.3188      -35.5549     39.4481  
  1984 1980  -8.6205     5.8434      -34.9628     17.7218  
  1984 1981  10.4692     4.8613      -11.4459     32.3843  
  1984 1982  -5.4364     7.9954      -41.4799     30.6070  
  1984 1983  12.0264     8.4379      -26.0121     50.0649  
  1984 1984  -0.7730     2.6232      -12.5986     11.0526  
  1984 1985   4.0744     1.1821       -1.2543      9.4031  
  1984 1986  -8.0341     2.9464      -21.3167      5.2485  
  1984 1987 -10.4189     8.0305      -46.6206     25.7828  
  1984 1988  -7.8277     5.8269      -34.0957     18.4403  
  1984 1989  -9.2894     3.8762      -26.7635      8.1847  
  1984 1990  -6.2529     2.9419      -19.5153      7.0094  
  1984 1991 -10.1584     4.5533      -30.6849     10.3681  
  1984 1992 -11.4694     6.6641      -41.5116     18.5728  
  1984 1993  -9.2844     3.9688      -27.1761      8.6072  
  1984 1994 -14.6630     5.2893      -38.5073      9.1813  
  1984 1995 -12.5044     3.7261      -29.3018      4.2929  
  1984 1996 -10.2449     3.2047      -24.6918      4.2020  
  1985 1965  -4.3499     1.6407      -11.7463      3.0465  
  1985 1966  37.6989     1.8389       29.4092     45.9886 *
  1985 1967 -19.2838     2.0802      -28.6616     -9.9059 *
  1985 1968  -4.2545     1.9740      -13.1535      4.6445  
  1985 1969  10.5295     1.7417        2.6778     18.3812 *
  1985 1970   7.2143     2.1248       -2.3642     16.7929  
  1985 1971   6.9735     2.4796       -4.2048     18.1517  
  1985 1972   5.8781     2.8898       -7.1493     18.9054  
  1985 1973 -38.9329     3.1557      -53.1589    -24.7068 *
  1985 1974   8.7158     4.4172      -11.1969     28.6285  
  1985 1975  -7.1533     2.7115      -19.3770      5.0703  
  1985 1976  -0.8308     5.7377      -26.6967     25.0351  
  1985 1977  -2.2605     2.7566      -14.6871     10.1662  
  1985 1978   7.7405     6.1687      -20.0684     35.5494  
  1985 1979  -4.9814     8.5844      -43.6802     33.7174  
  1985 1980   2.9209     6.0354      -24.2868     30.1286  
  1985 1981  -4.4773     4.8291      -26.2472     17.2926  
  1985 1982  13.7629     8.6731      -25.3358     52.8617  
  1985 1983  -7.4210     8.6868      -46.5814     31.7393  
  1985 1984  -5.5493     3.0943      -19.4986      8.4000  
  1985 1985  11.4728     5.1053      -11.5419     34.4876  
  1985 1986  10.1715     3.6996       -6.5063     26.8494  
  1985 1987  17.5291     5.0068       -5.0418     40.1000  
  1985 1988  -9.6423     3.9206      -27.3165      8.0320  
  1985 1989  19.8229     5.3527       -4.3074     43.9531  
  1985 1990  26.2350     1.7402       18.3899     34.0800 *
  1985 1991   6.2209     3.3361       -8.8184     21.2603  
  1985 1992  18.3602     5.5364       -6.5980     43.3183  
  1985 1993  23.0343     2.8585       10.1483     35.9203 *
  1985 1994  15.2612     6.2622      -12.9690     43.4914  
  1985 1995  15.4633     4.4738       -4.7048     35.6314  
  1985 1996  26.5282     3.9405        8.7644     44.2921 *
---
Signif. codes: `*' confidence band does not cover 0

Control Group:  Not Yet Treated,  Anticipation Periods:  0
Estimation Method:  Outcome Regression</code></pre>
</div>
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggdid</span>(atts_nyt)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="tarea-3-respuestas_files/figure-html/unnamed-chunk-10-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div></li>
<li><p>[5 puntos] Reporte los resultados agregados obtenidos a partir del estimador Callaway &amp; Sant’Anna (2021), usando una agregación dinámica que muestre los efectos promedio para cada periodo antes y después del tratamiento. Grafique e interprete los resultados.</p>
<p><em>Graficamos:</em></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>agg.es <span class="ot">&lt;-</span> <span class="fu">aggte</span>(atts_nyt,</span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>                <span class="at">type =</span> <span class="st">"dynamic"</span>)</span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(agg.es)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
aggte(MP = atts_nyt, type = "dynamic")

Reference: Callaway, Brantly and Pedro H.C. Sant'Anna.  "Difference-in-Differences with Multiple Time Periods." Journal of Econometrics, Vol. 225, No. 2, pp. 200-230, 2021. &lt;https://doi.org/10.1016/j.jeconom.2020.12.001&gt;, &lt;https://arxiv.org/abs/1803.09015&gt; 


Overall summary of ATT's based on event-study/dynamic aggregation:  
    ATT    Std. Error     [ 95%  Conf. Int.]  
 -9.628        3.8918   -17.2558     -2.0002 *


Dynamic Effects:
 Event time Estimate Std. Error [95% Simult.  Conf. Band]  
        -20  -4.3499     1.7921       -9.3943      0.6944  
        -19  19.9858    23.6977      -46.7195     86.6911  
        -18 -10.4454     7.0683      -30.3415      9.4508  
        -17  -3.0542     1.0459       -5.9983     -0.1100 *
        -16   4.5869     4.3571       -7.6777     16.8515  
        -15   1.5315     3.2949       -7.7430     10.8060  
        -14   1.5330     2.3018       -4.9462      8.0122  
        -13  -1.6021     5.3517      -16.6663     13.4621  
        -12  -1.2353     9.0354      -26.6685     24.1978  
        -11  -6.1889     4.8516      -19.8455      7.4676  
        -10   7.0286     5.1899       -7.5801     21.6374  
         -9  -5.6915     3.2654      -14.8832      3.5002  
         -8   1.1876     2.3880       -5.5342      7.9094  
         -7  -0.6219     1.9867       -6.2142      4.9703  
         -6   1.1581     2.6690       -6.3548      8.6711  
         -5  -2.9106     2.2622       -9.2783      3.4572  
         -4   2.9082     1.4393       -1.1433      6.9596  
         -3  -1.9822     2.6297       -9.3844      5.4201  
         -2   0.7311     2.7557       -7.0259      8.4880  
         -1   1.4763     2.4124       -5.3142      8.2668  
          0   0.5890     2.9098       -7.6015      8.7795  
          1  -1.2422     2.9375       -9.5107      7.0263  
          2  -0.3815     4.5247      -13.1178     12.3548  
          3  -0.4662     3.8040      -11.1739     10.2415  
          4  -0.3563     4.1637      -12.0765     11.3639  
          5  -3.4207     4.8787      -17.1535     10.3120  
          6  -2.4065     4.2852      -14.4688      9.6557  
          7  -6.4250     4.6679      -19.5644      6.7144  
          8  -5.8964     4.8428      -19.5282      7.7354  
          9  -6.3944     4.2842      -18.4537      5.6649  
         10  -7.7061     4.7531      -21.0852      5.6731  
         11  -8.8186     5.1289      -23.2557      5.6185  
         12  -7.2921     4.4729      -19.8826      5.2984  
         13 -11.1384     4.2276      -23.0384      0.7615  
         14 -11.1558     4.3484      -23.3958      1.0842  
         15 -14.8167     5.1863      -29.4154     -0.2180 *
         16 -11.6965     5.2377      -26.4399      3.0469  
         17 -14.3232     4.8250      -27.9048     -0.7416 *
         18 -17.1010     4.8981      -30.8883     -3.3137 *
         19 -17.4748     4.4929      -30.1215     -4.8280 *
         20 -14.9783     4.5324      -27.7363     -2.2203 *
         21 -15.8960     4.4911      -28.5378     -3.2541 *
         22 -15.2219     4.6886      -28.4195     -2.0243 *
         23 -16.2453     4.8231      -29.8216     -2.6689 *
         24 -17.8714     6.9834      -37.5285      1.7857  
         25 -17.0567     9.2628      -43.1301      9.0167  
         26 -27.4244    16.8407      -74.8283     19.9796  
         27   3.0338    13.1707      -34.0398     40.1074  
---
Signif. codes: `*' confidence band does not cover 0

Control Group:  Not Yet Treated,  Anticipation Periods:  0
Estimation Method:  Outcome Regression</code></pre>
</div>
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggdid</span>(agg.es)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="tarea-3-respuestas_files/figure-html/unnamed-chunk-11-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p><em>Se obtiene una reducción en la tasa de suicidios que es estadísticamente significativa a partir de 13 años después de la introducción de la legislación.</em></p></li>
<li><p>[5 puntos] Reporte los resultados agregados obtenidos a partir del estimador Callaway &amp; Sant’Anna (2021), usando una agregación or grupos que muestre los efectos promedio para cada cohorte del tratamiento. Grafique e interprete los resultados.</p>
<p><em>Graficamos:</em></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>agg.es <span class="ot">&lt;-</span> <span class="fu">aggte</span>(atts_nyt,</span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>                <span class="at">type =</span> <span class="st">"group"</span>)</span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(agg.es)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
aggte(MP = atts_nyt, type = "group")

Reference: Callaway, Brantly and Pedro H.C. Sant'Anna.  "Difference-in-Differences with Multiple Time Periods." Journal of Econometrics, Vol. 225, No. 2, pp. 200-230, 2021. &lt;https://doi.org/10.1016/j.jeconom.2020.12.001&gt;, &lt;https://arxiv.org/abs/1803.09015&gt; 


Overall summary of ATT's based on group/cohort aggregation:  
     ATT    Std. Error     [ 95%  Conf. Int.]  
 -8.2876        3.1192   -14.4011     -2.1741 *


Group Effects:
 Group Estimate Std. Error [95% Simult.  Conf. Band]  
  1969  -5.3569     8.0971      -23.2771     12.5633  
  1970 -30.6010    12.7292      -58.7726     -2.4294 *
  1971 -10.3173     5.9356      -23.4538      2.8192  
  1972  -7.9006     4.0826      -16.9361      1.1349  
  1973  -4.5364     5.1108      -15.8473      6.7745  
  1974  -7.3929     6.3528      -21.4526      6.6668  
  1975  -4.3417     3.3483      -11.7521      3.0686  
  1976 -13.5133     4.8325      -24.2083     -2.8182 *
  1977 -14.6717    21.5771      -62.4251     33.0817  
  1980  -7.3295     6.2622      -21.1887      6.5297  
  1984  -8.2189     2.8177      -14.4550     -1.9829 *
  1985  15.0381     2.6844        9.0971     20.9791 *
---
Signif. codes: `*' confidence band does not cover 0

Control Group:  Not Yet Treated,  Anticipation Periods:  0
Estimation Method:  Outcome Regression</code></pre>
</div>
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggdid</span>(agg.es)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="tarea-3-respuestas_files/figure-html/unnamed-chunk-12-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p><em>Notamos un efecto negativo en la tasa de suicidos que es estadísticamente significativa para los estados que fueron tratados en 1970, 1986 y 1984.</em></p></li>
<li><p>[5 puntos] ¿Cuáles son las ventajas del estimador de Callaway &amp; Sant’Anna (2021) respecto al estimador de TWFE?</p>
<p><em>Las ventajas del estimador de Callaway &amp; Sant’Anna respecto a TWFE son las siguientes:</em> <em>- Evita las comapraciones prohibidas (usar unidades tratadas como controles para unidades que son tratadas en periodos posteriores)</em> <em>- Hace explícito el grupo de comparación que se usa para comparar a las unidades tratadas</em> <em>- Hace explícita la manera en que se agregan los resultados de cada comparación <span class="math inline">\(ATT(g,t)\)</span></em> <em>- No impone efectos monótonos en el tiempo ni homogéneos entre unidades</em></p></li>
</ol>
</section>
<section id="pregunta-2" class="level2">
<h2 class="anchored" data-anchor-id="pregunta-2">Pregunta 2</h2>
<p>La ENIGH 2020 incluyó un módulo para la evaluación del Programa Jóvenes Construyendo el futuro. Se buscó que la cobertura de la encuesta pudiera incluir suficientes participantes del programa para poder compararlos con los no participantes. Los datos en <em>datos_jcf_analisis.csv</em> fueron construidos a partir de dicha encuesta. En este ejercicio estimaremos el efecto de participar en el programa sobre el ingreso trimestral, <strong>ingtot_tri</strong>, usando métodos de matching.</p>
<p>Las siguientes variables están incluidas en el archivo de datos: <strong>mujer</strong> (dummy de sexo), <strong>indigena</strong> (dummy de pertenencia a una etnia), <strong>rural</strong> (dummy del ámbito rural), <strong>escoacum</strong> (años de escolaridad), <strong>casadounion</strong> (dummy para casados o en unión libre), <strong>jefehog</strong> (dummy para jefes del hogar), <strong>haymenores</strong> (dummy para la presencia de menores de edad en el hogar), <strong>proggob</strong> (dummy para beneficiarios de programas de gobierno), y <strong>tot_integ</strong> (número de miembros del hogar). También se incluye la clave de las entidades, <strong>cve_ent</strong>.</p>
<ol type="a">
<li><p>[5 puntos] Considere la comparación para el ingreso trimestral, <strong>ingtot_tri</strong>, entre beneficiarios y su grupo de comparación, que serán los jóvenes que no asisten a la escuela y no están empleados. Los beneficiarios tienen <em>jcf2==1</em> y los jóvenes que no asisten a la escuela y no están empleados tienen <em>jcf2==0</em>. Muestre qué tan similares o qué tan diferentes son los individuos en ambos grupos en términos de las características indicadas anteriormente y del ingreso trimestral.</p>
<p><em>Estadística descriptiva:</em></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>data.jcf <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">"../files/datos_jcf_analisis.csv"</span>)</span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1023</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><em>Aquí usé datasummary para calcular la estadística descriptiva por grupos:</em></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="fu">datasummary</span>(ingtot_tri <span class="sc">+</span> mujer <span class="sc">+</span> indigena <span class="sc">+</span> rural <span class="sc">+</span> escoacum <span class="sc">+</span> casadounion <span class="sc">+</span> jefehog <span class="sc">+</span> haymenores <span class="sc">+</span> proggob <span class="sc">+</span> tot_integ <span class="sc">~</span> <span class="fu">factor</span>(jcf2) <span class="sc">*</span> (mean <span class="sc">+</span> sd) <span class="sc">*</span> <span class="fu">Arguments</span>(<span class="at">na.rm=</span><span class="cn">TRUE</span>),</span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>                <span class="at">fmt =</span> <span class="st">"%.2f"</span>,</span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a>                <span class="at">data =</span> data.jcf)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<!-- preamble start -->

    <script>

      function styleCell_o319cneo8effsfcg38ue(i, j, css_id) {
          var table = document.getElementById("tinytable_o319cneo8effsfcg38ue");
          var cell = table.querySelector(`[data-row="${i}"][data-col="${j}"]`);
          if (cell) {
              console.log(`Styling cell at (${i}, ${j}) with class ${css_id}`);
              cell.classList.add(css_id);
          } else {
              console.warn(`Cell at (${i}, ${j}) not found.`);
          }
      }
      function spanCell_o319cneo8effsfcg38ue(i, j, rowspan, colspan) {
        var table = document.getElementById("tinytable_o319cneo8effsfcg38ue");
        const targetCell = table.querySelector(`[data-row="${i}"][data-col="${j}"]`);
        if (!targetCell) {
          console.warn(`Cell at (${i}, ${j}) not found.`);
        }

        // Get all cells that need to be removed
        const cellsToRemove = [];
        for (let r = 0; r < rowspan; r++) {
          for (let c = 0; c < colspan; c++) {
            if (r === 0 && c === 0) continue; // Skip the target cell
            const cell = table.querySelector(`[data-row="${i + r}"][data-col="${j + c}"]`);
            if (cell) {
              cellsToRemove.push(cell);
            }
          }
        }

        // Remove all cells
        cellsToRemove.forEach(cell => cell.remove());

        // Set rowspan and colspan of the target cell if it exists
        if (targetCell) {
          targetCell.rowSpan = rowspan;
          targetCell.colSpan = colspan;
        }
      }
      // tinytable span after
      window.addEventListener('load', function () {
          var cellsToStyle = [
            // tinytable style arrays after
          { positions: [ { i: '-1', j: 4 }, { i: '-1', j: 3 },  ], css_id: 'tinytable_css_0yqui8arvthnnaij9ef1',}, 
          { positions: [ { i: '10', j: 1 }, { i: '10', j: 3 }, { i: '10', j: 2 }, { i: '10', j: 4 },  ], css_id: 'tinytable_css_uy949959h4oavhy4bb3w',}, 
          { positions: [ { i: '1', j: 1 }, { i: '2', j: 1 }, { i: '3', j: 1 }, { i: '4', j: 1 }, { i: '5', j: 1 }, { i: '6', j: 1 }, { i: '7', j: 1 }, { i: '8', j: 1 }, { i: '1', j: 2 }, { i: '2', j: 2 }, { i: '3', j: 2 }, { i: '4', j: 2 }, { i: '5', j: 2 }, { i: '6', j: 2 }, { i: '7', j: 2 }, { i: '8', j: 2 }, { i: '9', j: 2 }, { i: '9', j: 1 }, { i: '3', j: 3 }, { i: '1', j: 4 }, { i: '1', j: 3 }, { i: '2', j: 3 }, { i: '7', j: 3 }, { i: '4', j: 3 }, { i: '5', j: 3 }, { i: '6', j: 3 }, { i: '3', j: 4 }, { i: '8', j: 3 }, { i: '9', j: 3 }, { i: '2', j: 4 }, { i: '7', j: 4 }, { i: '4', j: 4 }, { i: '5', j: 4 }, { i: '6', j: 4 }, { i: '8', j: 4 }, { i: '9', j: 4 },  ], css_id: 'tinytable_css_5z7kieg41eh3ajo5xwpf',}, 
          { positions: [ { i: '-1', j: 1 }, { i: '-1', j: 2 },  ], css_id: 'tinytable_css_xz4jsovqyj368hcdqj43',}, 
          { positions: [ { i: '0', j: 1 }, { i: '0', j: 4 }, { i: '0', j: 3 }, { i: '0', j: 2 },  ], css_id: 'tinytable_css_p4cqrq4zc0yzpl955wnh',}, 
          { positions: [ { i: '10', j: 0 },  ], css_id: 'tinytable_css_vo1f9z8qq1hckx65an83',}, 
          { positions: [ { i: '1', j: 0 }, { i: '2', j: 0 }, { i: '3', j: 0 }, { i: '4', j: 0 }, { i: '5', j: 0 }, { i: '6', j: 0 }, { i: '7', j: 0 }, { i: '8', j: 0 }, { i: '9', j: 0 },  ], css_id: 'tinytable_css_lb3olvsqqn1vp6y6vaxw',}, 
          { positions: [ { i: '-1', j: 0 },  ], css_id: 'tinytable_css_4vgw1gktcznutol253vj',}, 
          { positions: [ { i: '0', j: 0 },  ], css_id: 'tinytable_css_zyruoz028ig4ioptxxgm',}, 
          ];

          // Loop over the arrays to style the cells
          cellsToStyle.forEach(function (group) {
              group.positions.forEach(function (cell) {
                  styleCell_o319cneo8effsfcg38ue(cell.i, cell.j, group.css_id);
              });
          });
      });
    </script>

    <style>
      /* tinytable css entries after */
      .table td.tinytable_css_0yqui8arvthnnaij9ef1, .table th.tinytable_css_0yqui8arvthnnaij9ef1 { text-align: right; text-align: center; border-top: solid #d3d8dc 0.1em; text-align: center; }
      .table td.tinytable_css_uy949959h4oavhy4bb3w, .table th.tinytable_css_uy949959h4oavhy4bb3w { text-align: right; border-bottom: solid #d3d8dc 0.1em; }
      .table td.tinytable_css_5z7kieg41eh3ajo5xwpf, .table th.tinytable_css_5z7kieg41eh3ajo5xwpf { text-align: right; }
      .table td.tinytable_css_xz4jsovqyj368hcdqj43, .table th.tinytable_css_xz4jsovqyj368hcdqj43 { text-align: right; text-align: center; border-top: solid #d3d8dc 0.1em; text-align: center; border-bottom: solid #d3d8dc 0.05em; }
      .table td.tinytable_css_p4cqrq4zc0yzpl955wnh, .table th.tinytable_css_p4cqrq4zc0yzpl955wnh { text-align: right; border-bottom: solid #d3d8dc 0.05em; }
      .table td.tinytable_css_vo1f9z8qq1hckx65an83, .table th.tinytable_css_vo1f9z8qq1hckx65an83 { text-align: left; border-bottom: solid #d3d8dc 0.1em; }
      .table td.tinytable_css_lb3olvsqqn1vp6y6vaxw, .table th.tinytable_css_lb3olvsqqn1vp6y6vaxw { text-align: left; }
      .table td.tinytable_css_4vgw1gktcznutol253vj, .table th.tinytable_css_4vgw1gktcznutol253vj { text-align: left; text-align: center; border-top: solid #d3d8dc 0.1em; text-align: center; }
      .table td.tinytable_css_zyruoz028ig4ioptxxgm, .table th.tinytable_css_zyruoz028ig4ioptxxgm { text-align: left; border-bottom: solid #d3d8dc 0.05em; }
    </style>
    <div class="container">
      <table class="table table-borderless" id="tinytable_o319cneo8effsfcg38ue" style="width: auto; margin-left: auto; margin-right: auto;" data-quarto-disable-processing="true">
        <thead>
<tr>
<th scope="col" align="center" colspan="1" data-row="-1" data-col="0"> </th>
<th scope="col" align="center" colspan="2" data-row="-1" data-col="1">0</th>
<th scope="col" align="center" colspan="2" data-row="-1" data-col="2">1</th>
</tr>

              <tr>
                <th scope="col" data-row="0" data-col="0"> </th>
                <th scope="col" data-row="0" data-col="1">mean</th>
                <th scope="col" data-row="0" data-col="2">sd</th>
                <th scope="col" data-row="0" data-col="3">mean</th>
                <th scope="col" data-row="0" data-col="4">sd</th>
              </tr>
        </thead>

        <tbody>
                <tr>
                  <td data-row="1" data-col="0">ingtot_tri</td>
                  <td data-row="1" data-col="1">1510.36</td>
                  <td data-row="1" data-col="2">8478.60</td>
                  <td data-row="1" data-col="3">9643.06</td>
                  <td data-row="1" data-col="4">6632.56</td>
                </tr>
                <tr>
                  <td data-row="2" data-col="0">mujer</td>
                  <td data-row="2" data-col="1">0.76</td>
                  <td data-row="2" data-col="2">0.43</td>
                  <td data-row="2" data-col="3">0.59</td>
                  <td data-row="2" data-col="4">0.49</td>
                </tr>
                <tr>
                  <td data-row="3" data-col="0">indigena</td>
                  <td data-row="3" data-col="1">0.22</td>
                  <td data-row="3" data-col="2">0.41</td>
                  <td data-row="3" data-col="3">0.59</td>
                  <td data-row="3" data-col="4">0.49</td>
                </tr>
                <tr>
                  <td data-row="4" data-col="0">rural</td>
                  <td data-row="4" data-col="1">0.40</td>
                  <td data-row="4" data-col="2">0.49</td>
                  <td data-row="4" data-col="3">0.35</td>
                  <td data-row="4" data-col="4">0.48</td>
                </tr>
                <tr>
                  <td data-row="5" data-col="0">escoacum</td>
                  <td data-row="5" data-col="1">10.39</td>
                  <td data-row="5" data-col="2">3.23</td>
                  <td data-row="5" data-col="3">12.03</td>
                  <td data-row="5" data-col="4">2.70</td>
                </tr>
                <tr>
                  <td data-row="6" data-col="0">casadounion</td>
                  <td data-row="6" data-col="1">0.53</td>
                  <td data-row="6" data-col="2">0.50</td>
                  <td data-row="6" data-col="3">0.41</td>
                  <td data-row="6" data-col="4">0.49</td>
                </tr>
                <tr>
                  <td data-row="7" data-col="0">jefehog</td>
                  <td data-row="7" data-col="1">0.06</td>
                  <td data-row="7" data-col="2">0.23</td>
                  <td data-row="7" data-col="3">0.14</td>
                  <td data-row="7" data-col="4">0.35</td>
                </tr>
                <tr>
                  <td data-row="8" data-col="0">haymenores</td>
                  <td data-row="8" data-col="1">0.66</td>
                  <td data-row="8" data-col="2">0.47</td>
                  <td data-row="8" data-col="3">0.54</td>
                  <td data-row="8" data-col="4">0.50</td>
                </tr>
                <tr>
                  <td data-row="9" data-col="0">proggob</td>
                  <td data-row="9" data-col="1">0.19</td>
                  <td data-row="9" data-col="2">0.39</td>
                  <td data-row="9" data-col="3">0.21</td>
                  <td data-row="9" data-col="4">0.41</td>
                </tr>
                <tr>
                  <td data-row="10" data-col="0">tot_integ</td>
                  <td data-row="10" data-col="1">4.82</td>
                  <td data-row="10" data-col="2">1.97</td>
                  <td data-row="10" data-col="3">4.25</td>
                  <td data-row="10" data-col="4">2.00</td>
                </tr>
        </tbody>
      </table>
    </div>
<!-- hack to avoid NA insertion in last line -->
</div>
</div>
<p><em>Claramente los individuos que participan en el programa son diferentes a los que no. En el programa hay una proporción menor de mujeres que en el grupo no tratado; en el grupo tratado hay un nivel mayor de escolaridad acumulada; y los individuos del grupo tratado viven en hogares más pequeños que los del grupo no tratado. Entre muchas otras diferencias.</em></p>
<p><em>El problema entonces es que existen factores que influyen en la probabilidad de recibir el tratamiento y en el ingreso, por lo que una comparación simple de individuos tratados y no tratados confundirá el efecto del tratamiento.</em></p></li>
<li><p>[5 puntos] Estime el TOT (TT o ATT) del programa en el ingreso trimestral, <strong>ingtot_tri</strong> usando el algoritmo de <em>vecino más cercano</em>. Para estimar el impacto en el ingreso trimestral se comparan a los beneficiarios de JCF con los jóvenes que no asisten a la escuela y no están empleados. Los beneficiarios tienen <em>jcf2==1</em> y los jóvenes que no asisten a la escuela y no están empleados tienen <em>jcf2==0</em>. Escoja la especificación del <em>propensity score</em> que más le parezca adecuada. Realice la inferencia estadística con errores agrupados a nivel grupo de emparejamiento. ¿De qué tamaño es el TOT estimado y es este efecto estadísticamente significativo?</p>
<p><em>Este es el modelo para el propensity score que yo escogí:</em></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a>sub.data <span class="ot">&lt;-</span> data.jcf <span class="sc">%&gt;%</span></span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>dplyr<span class="sc">::</span><span class="fu">select</span>(ingtot_tri, jcf2, mujer, indigena, cve_ent, rural, escoacum, casadounion,</span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a>    jefehog, haymenores, proggob, tot_integ, factor.x)</span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-5"><a href="#cb29-5" aria-hidden="true" tabindex="-1"></a>sub.data <span class="ot">&lt;-</span> sub.data[<span class="fu">complete.cases</span>(sub.data), ]</span>
<span id="cb29-6"><a href="#cb29-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-7"><a href="#cb29-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-8"><a href="#cb29-8" aria-hidden="true" tabindex="-1"></a>m.out.a <span class="ot">&lt;-</span> <span class="fu">matchit</span>(<span class="at">formula=</span>jcf2 <span class="sc">~</span> mujer <span class="sc">+</span> indigena <span class="sc">+</span> <span class="fu">factor</span>(cve_ent) <span class="sc">+</span> rural  <span class="sc">+</span> escoacum <span class="sc">+</span> casadounion <span class="sc">+</span> jefehog <span class="sc">+</span> haymenores <span class="sc">+</span> proggob <span class="sc">+</span> tot_integ,</span>
<span id="cb29-9"><a href="#cb29-9" aria-hidden="true" tabindex="-1"></a>                 <span class="at">method =</span> <span class="st">"nearest"</span>,</span>
<span id="cb29-10"><a href="#cb29-10" aria-hidden="true" tabindex="-1"></a>                 <span class="at">distance=</span> <span class="st">"glm"</span>,</span>
<span id="cb29-11"><a href="#cb29-11" aria-hidden="true" tabindex="-1"></a>                 <span class="at">replace =</span> <span class="cn">FALSE</span>,</span>
<span id="cb29-12"><a href="#cb29-12" aria-hidden="true" tabindex="-1"></a>                 <span class="at">data =</span> sub.data)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><em>Estimamos el efecto del tratamiento:</em></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>tt1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(ingtot_tri <span class="sc">~</span> jcf2,</span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>      <span class="at">data =</span> <span class="fu">match.data</span>(m.out.a))</span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a><span class="co">#Errores agrupados a nivel subclass</span></span>
<span id="cb30-5"><a href="#cb30-5" aria-hidden="true" tabindex="-1"></a><span class="fu">coeftest</span>(tt1,</span>
<span id="cb30-6"><a href="#cb30-6" aria-hidden="true" tabindex="-1"></a>         <span class="at">vcov. =</span> vcovCL,</span>
<span id="cb30-7"><a href="#cb30-7" aria-hidden="true" tabindex="-1"></a>         <span class="at">cluster =</span> <span class="sc">~</span>subclass)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
t test of coefficients:

            Estimate Std. Error t value  Pr(&gt;|t|)    
(Intercept)  1669.95     407.99  4.0931 5.735e-05 ***
jcf2         7973.11     708.27 11.2572 &lt; 2.2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
<p><em>Se estima un efecto de 7973 pesos adicionales de ingreso trimestral para los participantes en el programa.</em></p></li>
<li><p>[5 puntos] En el matching de la parte b., evalúe qué tan bueno es el procedimiento en balancear las características observadas una vez realizado el matching. Cree un <em>love plot</em> para evaluar qué tan bueno es el procedimiento de matching para obtener una muestra balanceada.</p>
<p><em>bal.tab del paquete cobalt nos permite ver un resumen del balance:</em></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Con esto elimino las dummies de estado de la salida</span></span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a><span class="fu">bal.tab</span>(m.out.a, <span class="at">m.threshold=</span><span class="fl">0.1</span>, <span class="at">un=</span>T)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Balance Measures
                       Type Diff.Un Diff.Adj        M.Threshold
distance           Distance  1.1091   0.0881     Balanced, &lt;0.1
mujer                Binary -0.1660   0.0551     Balanced, &lt;0.1
indigena             Binary  0.3714   0.0551     Balanced, &lt;0.1
factor(cve_ent)_01   Binary -0.1720  -0.0157     Balanced, &lt;0.1
factor(cve_ent)_02   Binary -0.3428  -0.0079     Balanced, &lt;0.1
factor(cve_ent)_03   Binary  0.0168   0.0079     Balanced, &lt;0.1
factor(cve_ent)_04   Binary  0.5524   0.0157     Balanced, &lt;0.1
factor(cve_ent)_05   Binary -0.0544   0.0000     Balanced, &lt;0.1
rural                Binary -0.0553   0.0709     Balanced, &lt;0.1
escoacum            Contin.  0.6086  -0.2096 Not Balanced, &gt;0.1
casadounion          Binary -0.1170   0.0709     Balanced, &lt;0.1
jefehog              Binary  0.0831   0.0551     Balanced, &lt;0.1
haymenores           Binary -0.1193   0.0787     Balanced, &lt;0.1
proggob              Binary  0.0220   0.0079     Balanced, &lt;0.1
tot_integ           Contin. -0.2856   0.0158     Balanced, &lt;0.1

Balance tally for mean differences
                   count
Balanced, &lt;0.1        14
Not Balanced, &gt;0.1     1

Variable with the greatest mean difference
 Variable Diff.Adj        M.Threshold
 escoacum  -0.2096 Not Balanced, &gt;0.1

Sample sizes
          Control Treated
All          1894     127
Matched       127     127
Unmatched    1767       0</code></pre>
</div>
</div>
<p><em>Y finalmente el loveplot:</em></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a>m.out.a[[<span class="st">"X"</span>]][[<span class="st">"factor(cve_ent)"</span>]] <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a><span class="fu">love.plot</span>(<span class="fu">bal.tab</span>(m.out.a),</span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a>      <span class="at">threshold =</span> .<span class="dv">1</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="tarea-3-respuestas_files/figure-html/unnamed-chunk-18-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p><em>Parece haber un buen balance, aunque la educación es la única variable que no queda bien balanceada. Después del emparejamiento, las medias (estandarizadas) entre tratados y no tratados difieren en más de 0.1.</em></p></li>
<li><p>[5 puntos] Estime ahora el TOT en el ingreso trimestral, como en la parte b., pero usando un caliper de 0.05 y 5 vecinos a ser emparejados. ¿Cómo cambian sus resultados respecto a los de la parte b.?</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a>sub.data <span class="ot">&lt;-</span> data.jcf <span class="sc">%&gt;%</span> </span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(ingtot_tri, jcf2, mujer, indigena, cve_ent, rural, escoacum, </span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a>           casadounion, jefehog, haymenores, proggob, tot_integ, factor.x)</span>
<span id="cb35-4"><a href="#cb35-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-5"><a href="#cb35-5" aria-hidden="true" tabindex="-1"></a>sub.data <span class="ot">&lt;-</span> sub.data[<span class="fu">complete.cases</span>(sub.data), ] </span>
<span id="cb35-6"><a href="#cb35-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-7"><a href="#cb35-7" aria-hidden="true" tabindex="-1"></a>m.out.c <span class="ot">&lt;-</span> <span class="fu">matchit</span>(<span class="at">formula=</span>jcf2 <span class="sc">~</span> mujer <span class="sc">+</span> indigena <span class="sc">+</span> <span class="fu">factor</span>(cve_ent) <span class="sc">+</span> rural  <span class="sc">+</span> escoacum <span class="sc">+</span> casadounion <span class="sc">+</span> jefehog <span class="sc">+</span> haymenores <span class="sc">+</span> proggob <span class="sc">+</span> tot_integ,</span>
<span id="cb35-8"><a href="#cb35-8" aria-hidden="true" tabindex="-1"></a>                 <span class="at">method =</span> <span class="st">"nearest"</span>,</span>
<span id="cb35-9"><a href="#cb35-9" aria-hidden="true" tabindex="-1"></a>                 <span class="at">distance=</span> <span class="st">"glm"</span>,</span>
<span id="cb35-10"><a href="#cb35-10" aria-hidden="true" tabindex="-1"></a>                 <span class="at">ratio =</span> <span class="dv">5</span>,</span>
<span id="cb35-11"><a href="#cb35-11" aria-hidden="true" tabindex="-1"></a>                 <span class="at">caliper =</span> <span class="fl">0.05</span>,</span>
<span id="cb35-12"><a href="#cb35-12" aria-hidden="true" tabindex="-1"></a>                 <span class="at">replace =</span> <span class="cn">FALSE</span>,</span>
<span id="cb35-13"><a href="#cb35-13" aria-hidden="true" tabindex="-1"></a>                 <span class="at">data =</span> sub.data)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><em>Estimamos el efecto del tratamiento:</em></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a>tt3 <span class="ot">&lt;-</span> <span class="fu">lm</span>(ingtot_tri <span class="sc">~</span> jcf2,</span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a>      <span class="at">data =</span> <span class="fu">match.data</span>(m.out.c))</span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-4"><a href="#cb36-4" aria-hidden="true" tabindex="-1"></a><span class="co">#Errores agrupados a nivel subclass</span></span>
<span id="cb36-5"><a href="#cb36-5" aria-hidden="true" tabindex="-1"></a><span class="fu">coeftest</span>(tt3,</span>
<span id="cb36-6"><a href="#cb36-6" aria-hidden="true" tabindex="-1"></a>         <span class="at">vcov. =</span> vcovCL,</span>
<span id="cb36-7"><a href="#cb36-7" aria-hidden="true" tabindex="-1"></a>         <span class="at">cluster =</span> <span class="sc">~</span>subclass)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
t test of coefficients:

            Estimate Std. Error t value  Pr(&gt;|t|)    
(Intercept)  2135.55     372.22  5.7374 1.717e-08 ***
jcf2         7155.74     699.21 10.2341 &lt; 2.2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
<p><em>Se estima ahora un efecto de 7155 pesos, menor al efecto de 7973 pesos estimado en la parte b.</em></p></li>
</ol>


</section>
</section>


<div id="quarto-appendix" class="default"><section id="footnotes" class="footnotes footnotes-end-of-document" role="doc-endnotes"><h2 class="anchored quarto-appendix-heading">Notas</h2>

<ol>
<li id="fn1"><p>Stevenson, B. &amp; Wolfers, J. (2006). Bargaining in the Shadow of the Law: Divorce Laws and Family Distress. <em>The Quarterly Journal of Economics</em>, 121(1), 267-288.<a href="#fnref1" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
</ol>
</section></div></main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copiado");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copiado");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
        const codeEl = trigger.previousElementSibling.cloneNode(true);
        for (const childEl of codeEl.children) {
          if (isCodeAnnotation(childEl)) {
            childEl.remove();
          }
        }
        return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp('/' + window.location.host + '/');
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
</div> <!-- /content -->




</body></html>