<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="es" xml:lang="es"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.7.32">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Respuestas a la tarea 3 – Inferencia Causal 2025</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<script src="../site_libs/quarto-html/quarto.js" type="module"></script>
<script src="../site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting-37eea08aefeeee20ff55810ff984fec1.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap-209d9ab60904f1bb8f31161fafd02104.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "Sin resultados",
    "search-matching-documents-text": "documentos encontrados",
    "search-copy-link-title": "Copiar el enlace en la búsqueda",
    "search-hide-matches-text": "Ocultar resultados adicionales",
    "search-more-match-text": "resultado adicional en este documento",
    "search-more-matches-text": "resultados adicionales en este documento",
    "search-clear-button-title": "Borrar",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancelar",
    "search-submit-button-title": "Enviar",
    "search-label": "Buscar"
  }
}</script>

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<link rel="stylesheet" href="../styles.css">
</head>

<body class="nav-sidebar docked quarto-light">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Alternar barra lateral" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item">Respuestas a la tarea 3</li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Alternar barra lateral" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Buscar" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation docked overflow-auto">
    <div class="pt-lg-2 mt-2 text-center sidebar-header">
      <a href="../index.html" class="sidebar-logo-link">
      <img src="../iconoEvaluaciondeProgramasSociales.jpg" alt="" class="sidebar-logo py-0 d-lg-inline d-none">
      </a>
      <div class="sidebar-tools-main">
    <a href="https://github.com/rojasirvin/evaluacion-de-programas" title="GitHub" class="quarto-navigation-tool px-1" aria-label="GitHub"><i class="bi bi-github"></i></a>
</div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Buscar"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Home</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../programa.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Programa</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../reglas.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Reglas</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../lecturas.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Lecturas</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../presentaciones.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Presentaciones</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../cronograma.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Cronograma</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../tareas/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Tareas</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../notas/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Notas</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../diapositivas/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Diapositivas</span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">En esta página</h2>
   
  <ul>
  <li><a href="#respuestas" id="toc-respuestas" class="nav-link active" data-scroll-target="#respuestas">Respuestas</a>
  <ul class="collapse">
  <li><a href="#pregunta-1" id="toc-pregunta-1" class="nav-link" data-scroll-target="#pregunta-1">Pregunta 1</a></li>
  <li><a href="#pregunta-2" id="toc-pregunta-2" class="nav-link" data-scroll-target="#pregunta-2">Pregunta 2</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Respuestas a la tarea 3</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<section id="respuestas" class="level1">
<h1>Respuestas</h1>
<section id="pregunta-1" class="level2">
<h2 class="anchored" data-anchor-id="pregunta-1">Pregunta 1</h2>
<p>Stevenson, B. &amp; Wolfers, J. (2006)<a href="#fn1" class="footnote-ref" id="fnref1" role="doc-noteref"><sup>1</sup></a> estudian los efectos de la introducción de leyes que permiten el divorcio unilateral en los Estados Unidos. La librería <em>bacondecomp</em> incluye los datos usados en dicho artículo (debe instalar y cargar la librería). Usaremos los datos de 1964 a 1996 para mostrar cómo impactan las leyes de divorcio express (unilateral) a la tasa de suicidios en mujeres.</p>
<p>Al correr el pedazo de código anterior, obtendrá un objeto de datos <strong>wd</strong> en donde la variable de impacto es la tasa de suicidios en mujeres, <strong>suicide_rate</strong>, <strong>st</strong> identifica a los estados, <strong>year</strong> identifica a los años y <strong>divyear</strong> es el año en que se introdujo la legislación del divorcio unilateral. La última fila del código crea el indicador de tratamiento <strong>unilaterial</strong>, que toma el valor de 1 para los estados tratados en los periodos post tratamiento.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>wd <span class="ot">&lt;-</span> divorce <span class="sc">%&gt;%</span> </span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">filter</span>(year<span class="sc">&gt;=</span><span class="dv">1964</span> <span class="sc">&amp;</span> year<span class="sc">&lt;=</span><span class="dv">1996</span> <span class="sc">&amp;</span> sex<span class="sc">==</span><span class="dv">2</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">mutate</span>(<span class="at">suicide_rate=</span>suicide<span class="sc">*</span><span class="dv">1000000</span><span class="sc">/</span>(stpop<span class="sc">*</span>fshare),</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>   <span class="at">year=</span><span class="fu">as.numeric</span>(year),</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>   <span class="at">divyear =</span> <span class="fu">ifelse</span>(divyear<span class="sc">&gt;</span><span class="dv">1996</span>, <span class="cn">Inf</span>, divyear),</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>   <span class="at">unilateral=</span><span class="fu">ifelse</span>(year<span class="sc">&gt;</span>divyear, <span class="dv">1</span>, <span class="dv">0</span>))</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ol type="a">
<li><p>[5 puntos] Presente una tabla donde muestre el número de estados que es tratado en cada periodo del panel. ¿Cuántos estados son nunca tratados? ¿Cuántos estados son siempre tratados?</p>
<p><em>Si hacemos un tabulado de <strong>divyear</strong> para un año fijo, notamos cuántos estados se vuelven tratados en cada año. Solo 5 estados son nunca tratados. Por otro lado, como el panel comienza en 1964 y hay 9 estados tratados en 1950, estos 9 estados son siempre tratados.</em></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(<span class="fu">filter</span>(wd, year<span class="sc">==</span><span class="dv">1996</span>)<span class="sc">$</span>divyear)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
1950 1969 1970 1971 1972 1973 1974 1975 1976 1977 1980 1984 1985  Inf 
   9    2    2    7    3   11    3    2    1    3    1    1    1    5 </code></pre>
</div>
</div></li>
<li><p>[5 puntos] Como punto de partida, estime el efecto del tratamiento sobre <strong>suicide_rate</strong> usando efectos fijos por estado y año (TWFE) y empleando una librería específica para efectos fijos, como <em>felm</em>. Tome en cuenta la agrupación de los errores. Interprete sus resultados.</p>
<p><em>Usando felm podemos incorporar ya el nivel de agrupación de los errores:</em></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(<span class="fu">felm</span>(suicide_rate <span class="sc">~</span> unilateral <span class="sc">|</span> st <span class="sc">+</span> year <span class="sc">|</span> <span class="dv">0</span> <span class="sc">|</span> st,</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>              <span class="at">data =</span> wd))</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
   felm(formula = suicide_rate ~ unilateral | st + year | 0 | st,      data = wd) 

Residuals:
    Min      1Q  Median      3Q     Max 
-37.517  -6.157  -0.141   5.577  57.004 

Coefficients:
           Estimate Cluster s.e. t value Pr(&gt;|t|)  
unilateral   -3.777        2.201  -1.716   0.0923 .
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 10.85 on 1599 degrees of freedom
Multiple R-squared(full model): 0.6844   Adjusted R-squared: 0.668 
Multiple R-squared(proj model): 0.007963   Adjusted R-squared: -0.04353 
F-statistic(full model, *iid*):41.77 on 83 and 1599 DF, p-value: &lt; 2.2e-16 
F-statistic(proj model): 2.945 on 1 and 50 DF, p-value: 0.09231 </code></pre>
</div>
</div></li>
<li><p>[5 puntos] Compruebe que puede obtener el mismo resultado con una regresión lineal usando el paquete <em>lm</em> e incluyendo, además de la variable de tratamiento, dummies de estado y de año.</p>
<p><em>Estimamos con dummies:</em></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(m1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(suicide_rate <span class="sc">~</span> unilateral <span class="sc">+</span> <span class="fu">factor</span>(st) <span class="sc">+</span> <span class="fu">factor</span>(year),</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>              <span class="at">data =</span> wd))<span class="sc">$</span>coef[<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>,<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>]</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>             Estimate Std. Error   t value
(Intercept) 56.732642   2.468251 22.984953
unilateral  -3.776552   1.054148 -3.582562</code></pre>
</div>
</div>
<p><em>Luego estimamos errores agrupados:</em></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="fu">modelsummary</span>(<span class="fu">list</span>(m1),</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>             <span class="at">output =</span> <span class="st">'gt'</span>,</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>             <span class="at">vcov=</span>clubSandwich<span class="sc">::</span><span class="fu">vcovCR</span>(m1, <span class="at">type=</span><span class="st">'CR1'</span>, <span class="at">cluster=</span>wd<span class="sc">$</span>st),</span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>             <span class="at">coef_map =</span> <span class="st">"unilateral"</span>,</span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>             <span class="at">gof_map =</span> <span class="st">"nobs"</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="wheipjmukv" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#wheipjmukv table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#wheipjmukv thead, #wheipjmukv tbody, #wheipjmukv tfoot, #wheipjmukv tr, #wheipjmukv td, #wheipjmukv th {
  border-style: none;
}

#wheipjmukv p {
  margin: 0;
  padding: 0;
}

#wheipjmukv .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#wheipjmukv .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#wheipjmukv .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#wheipjmukv .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#wheipjmukv .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#wheipjmukv .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#wheipjmukv .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#wheipjmukv .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#wheipjmukv .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#wheipjmukv .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#wheipjmukv .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#wheipjmukv .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#wheipjmukv .gt_spanner_row {
  border-bottom-style: hidden;
}

#wheipjmukv .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#wheipjmukv .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#wheipjmukv .gt_from_md > :first-child {
  margin-top: 0;
}

#wheipjmukv .gt_from_md > :last-child {
  margin-bottom: 0;
}

#wheipjmukv .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#wheipjmukv .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#wheipjmukv .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#wheipjmukv .gt_row_group_first td {
  border-top-width: 2px;
}

#wheipjmukv .gt_row_group_first th {
  border-top-width: 2px;
}

#wheipjmukv .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#wheipjmukv .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#wheipjmukv .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#wheipjmukv .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#wheipjmukv .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#wheipjmukv .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#wheipjmukv .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#wheipjmukv .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#wheipjmukv .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#wheipjmukv .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#wheipjmukv .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#wheipjmukv .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#wheipjmukv .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#wheipjmukv .gt_left {
  text-align: left;
}

#wheipjmukv .gt_center {
  text-align: center;
}

#wheipjmukv .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#wheipjmukv .gt_font_normal {
  font-weight: normal;
}

#wheipjmukv .gt_font_bold {
  font-weight: bold;
}

#wheipjmukv .gt_font_italic {
  font-style: italic;
}

#wheipjmukv .gt_super {
  font-size: 65%;
}

#wheipjmukv .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#wheipjmukv .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#wheipjmukv .gt_indent_1 {
  text-indent: 5px;
}

#wheipjmukv .gt_indent_2 {
  text-indent: 10px;
}

#wheipjmukv .gt_indent_3 {
  text-indent: 15px;
}

#wheipjmukv .gt_indent_4 {
  text-indent: 20px;
}

#wheipjmukv .gt_indent_5 {
  text-indent: 25px;
}

#wheipjmukv .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#wheipjmukv div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>

<table class="gt_table caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
<thead>
<tr class="gt_col_headings header">
<th id="a-" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" scope="col"></th>
<th id="a(1)" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" scope="col">(1)</th>
</tr>
</thead>
<tbody class="gt_table_body">
<tr class="odd">
<td class="gt_row gt_left" headers=" ">unilateral</td>
<td class="gt_row gt_center" headers="(1)">-3.777</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers=" " style="border-bottom-width: 1px; border-bottom-style: solid; border-bottom-color: #000000"></td>
<td class="gt_row gt_center" headers="(1)" style="border-bottom-width: 1px; border-bottom-style: solid; border-bottom-color: #000000">(2.200)</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers=" ">Num.Obs.</td>
<td class="gt_row gt_center" headers="(1)">1683</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<p><em>Obtenemos los mismos coeficientes. Aquí también podrán volver a comprobar la importancia de usar errores agrupados. El error agrupado es más de dos veces más grande que el error clásico.</em></p></li>
<li><p>[10 puntos] Ahora muestre que podemos obtener el coeficiente de TWFE a partir de una regresión bivariada entre la tasa de suicidios y <strong>unilateral</strong>, una vez <em>purgada</em> por efectos fijos. Para ello, primero estime una regresión de <strong>unilateral</strong> en función de los efectos fijos. Obtenga la predicción y luego defina una nueva variable igual a la diferencia entre <strong>unilateral</strong> y la predicción que acaba de obtener. Finalmente, obtenga el coeficiente de TWFE con una regresión de la tasa de suicidios en función de la diferencia antes definida.</p>
<p><em>Corremos la primera regresión para purgar los efectos fijos:</em></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>d1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(unilateral <span class="sc">~</span> <span class="fu">factor</span>(st) <span class="sc">+</span> <span class="fu">factor</span>(year),</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>              <span class="at">data =</span> wd)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><em>Definimos la nueva variable:</em></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>wd <span class="ot">&lt;-</span> wd <span class="sc">%&gt;%</span> </span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">unilateral_hat =</span> unilateral<span class="sc">-</span><span class="fu">predict</span>(d1))</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><em>Y finalmente estimamos:</em></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(m2 <span class="ot">&lt;-</span> <span class="fu">lm</span>(suicide_rate <span class="sc">~</span> unilateral_hat,</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>              <span class="at">data =</span> wd))<span class="sc">$</span>coef[<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>,<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>]</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                Estimate Std. Error    t value
(Intercept)    54.422503  0.4585884 118.673960
unilateral_hat -3.776552  1.8276582  -2.066334</code></pre>
</div>
</div>
<p><em>Obtenemos el mismo coeficiente. Frisch–Waugh–Lovell tenían razón.</em></p></li>
<li><p>[10 puntos] Realice la descomposición de Goodman-Bacon (2021). Construya un gráfico donde muestre en el eje <span class="math inline">\(x\)</span> el peso otorgado a cada comparación 2x2 que el estimador de TWFE realiza mecánicamente y en el eje <span class="math inline">\(y\)</span> el efecto estimado correspondiente a cada comparación. Interprete el gráfico obtenido.</p>
<p><em>Como vimos en laboratorio, la descomposición de Bacon se puede obtener con la función bacon:</em></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Goodman-Bacon decomposition</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>df_bacon <span class="ot">&lt;-</span> <span class="fu">bacon</span>(suicide_rate <span class="sc">~</span> unilateral,</span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>                  <span class="at">data =</span> wd,</span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>                  <span class="at">id_var =</span> <span class="st">"st"</span>,</span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>                  <span class="at">time_var =</span> <span class="st">"year"</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                      type  weight  avg_est
1 Earlier vs Later Treated 0.11558  0.13489
2  Later vs Always Treated 0.41990 -6.95245
3 Later vs Earlier Treated 0.23125  2.33743
4     Treated vs Untreated 0.23328 -6.05881</code></pre>
</div>
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>coef_bacon <span class="ot">&lt;-</span> <span class="fu">sum</span>(df_bacon<span class="sc">$</span>estimate <span class="sc">*</span> df_bacon<span class="sc">$</span>weight)</span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">"Suma ponderada de la descomposición ="</span>, <span class="fu">round</span>(coef_bacon, <span class="dv">4</span>)))</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Suma ponderada de la descomposición = -3.7766"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>twfe <span class="ot">&lt;-</span> <span class="fu">felm</span>(suicide_rate <span class="sc">~</span> unilateral <span class="sc">|</span> st <span class="sc">+</span> year <span class="sc">|</span> <span class="dv">0</span> <span class="sc">|</span> st,</span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>              <span class="at">data =</span> wd)</span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a><span class="co">#Gráfico----</span></span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a>df_bacon <span class="sc">%&gt;%</span> </span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span>weight,</span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a>             <span class="at">y=</span>estimate,</span>
<span id="cb17-8"><a href="#cb17-8" aria-hidden="true" tabindex="-1"></a>             <span class="at">shape=</span>type)) <span class="sc">+</span></span>
<span id="cb17-9"><a href="#cb17-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb17-10"><a href="#cb17-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="fu">round</span>(twfe<span class="sc">$</span>coefficients, <span class="dv">4</span>))</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="tarea-3-respuestas_files/figure-html/unnamed-chunk-9-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p><em>Las comparaciones que más pesan en el estimador de efectos fijos son las de estados tratados con los que siempre estuvieron tratados en el panel, recibiendo dos de esas comparaciones alrededor de 13 y el 7% del peso (los dos triángulos más hacia la derecha). otra comparación que recibe alrededor de 7% del peso es la de los tratados con los nunca tratados (cruz más hacia la derecha). En total, las comparaciones con los estados que iniciaron siendo tratados se llevan el 42% del peso. Las comparaciones entre los tratados tarde y los tratados temprano también reciben un peso alto de 23%.</em></p></li>
<li><p>[10 puntos] Implemente el estimador de Callaway &amp; Sant’Anna (2021) para estimar los efectos del tratamiento específicos para cada cohorte, usando el paquete <em>did</em>. Utilice como grupo de comparación los estados <em>no tratados aún</em>. La columna <strong>stid</strong> es un identificador numérico de los estados (lo requerirá cuando use <em>att_gt</em> del paquete <em>did</em>).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>atts_nyt <span class="ot">&lt;-</span> <span class="fu">att_gt</span>(<span class="at">yname =</span> <span class="st">"suicide_rate"</span>,</span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>                      <span class="at">tname =</span> <span class="st">"year"</span>,</span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>                      <span class="at">idname =</span> <span class="st">"stid"</span>,</span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a>                      <span class="at">gname =</span> <span class="st">"divyear"</span>,</span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a>                      <span class="at">data =</span> wd,</span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a>                      <span class="at">control_group =</span> <span class="st">"notyettreated"</span>,</span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true" tabindex="-1"></a>                      <span class="at">est_method =</span> <span class="st">'reg'</span>,</span>
<span id="cb18-8"><a href="#cb18-8" aria-hidden="true" tabindex="-1"></a>                      <span class="at">bstrap =</span> <span class="cn">TRUE</span>,</span>
<span id="cb18-9"><a href="#cb18-9" aria-hidden="true" tabindex="-1"></a>                      <span class="at">biters =</span> <span class="dv">1000</span>,</span>
<span id="cb18-10"><a href="#cb18-10" aria-hidden="true" tabindex="-1"></a>                      <span class="at">print_details =</span> <span class="cn">FALSE</span>,</span>
<span id="cb18-11"><a href="#cb18-11" aria-hidden="true" tabindex="-1"></a>                      <span class="at">panel =</span> <span class="cn">TRUE</span>)</span>
<span id="cb18-12"><a href="#cb18-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-13"><a href="#cb18-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-14"><a href="#cb18-14" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(atts_nyt)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
att_gt(yname = "suicide_rate", tname = "year", idname = "stid", 
    gname = "divyear", data = wd, panel = TRUE, control_group = "notyettreated", 
    bstrap = TRUE, biters = 1000, est_method = "reg", print_details = FALSE)

Reference: Callaway, Brantly and Pedro H.C. Sant'Anna.  "Difference-in-Differences with Multiple Time Periods." Journal of Econometrics, Vol. 225, No. 2, pp. 200-230, 2021. &lt;https://doi.org/10.1016/j.jeconom.2020.12.001&gt;, &lt;https://arxiv.org/abs/1803.09015&gt; 

Group-Time Average Treatment Effects:
 Group Time ATT(g,t) Std. Error [95% Simult.  Conf. Band]  
  1969 1965  -1.9053     7.0572      -39.0623     35.2518  
  1969 1966   4.5124    10.0156      -48.2206     57.2455  
  1969 1967   0.5622     5.2998      -27.3419     28.4664  
  1969 1968   5.1789     2.7723       -9.4173     19.7752  
  1969 1969  -0.7447     5.4614      -29.4994     28.0101  
  1969 1970 -10.2717     9.2713      -59.0859     38.5424  
  1969 1971 -12.3880     6.9920      -49.2018     24.4258  
  1969 1972  -4.1259     3.3773      -21.9076     13.6557  
  1969 1973   1.4524     7.1506      -36.1963     39.1010  
  1969 1974  -1.4022     5.1447      -28.4894     25.6850  
  1969 1975  -0.9265     4.3403      -23.7784     21.9253  
  1969 1976 -12.7344     6.0599      -44.6402     19.1715  
  1969 1977  -2.3415     9.6918      -53.3699     48.6869  
  1969 1978 -11.4247    12.4206      -76.8201     53.9707  
  1969 1979  -6.0427     8.6208      -51.4318     39.3464  
  1969 1980  -7.9345     5.6002      -37.4203     21.5512  
  1969 1981  -1.7430     9.3594      -51.0210     47.5350  
  1969 1982  -6.7020     9.0969      -54.5980     41.1939  
  1969 1983   4.7154     9.6070      -45.8666     55.2974  
  1969 1984  -9.5175    12.5532      -75.6111     56.5761  
  1969 1985   5.9598    15.5895      -76.1205     88.0400  
  1969 1986  -8.5962    12.2159      -72.9141     55.7217  
  1969 1987  -8.6897     7.5690      -48.5411     31.1618  
  1969 1988 -11.9815     7.7495      -52.7835     28.8205  
  1969 1989  -5.9781    14.2117      -80.8041     68.8480  
  1969 1990  -7.7327    11.2463      -66.9453     51.4799  
  1969 1991 -14.7659    10.8223      -71.7462     42.2144  
  1969 1992  -6.6956     6.5026      -40.9322     27.5410  
  1969 1993   0.5290    11.2436      -58.6698     59.7278  
  1969 1994  -6.1575    15.2517      -86.4593     74.1443  
  1969 1995  -6.7870    15.8605      -90.2940     76.7201  
  1969 1996   3.0338    14.1444      -71.4378     77.5055  
  1970 1965   2.4919     3.1943      -14.3263     19.3102  
  1970 1966   1.8500     3.1101      -14.5247     18.2248  
  1970 1967  -2.0438     4.0361      -23.2940     19.2064  
  1970 1968  -3.7538     5.4377      -32.3838     24.8762  
  1970 1969   9.0725     3.3390       -8.5078     26.6528  
  1970 1970   0.3548     4.4089      -22.8586     23.5683  
  1970 1971  -1.9698     3.1420      -18.5125     14.5729  
  1970 1972  -1.4067     5.9751      -32.8663     30.0529  
  1970 1973 -11.2801     3.7183      -30.8574      8.2972  
  1970 1974 -11.1775     3.6988      -30.6519      8.2969  
  1970 1975 -12.0330     5.6099      -41.5696     17.5036  
  1970 1976 -17.7592     8.0714      -60.2561     24.7377  
  1970 1977 -16.3994     4.9080      -42.2405      9.4418  
  1970 1978 -29.1877     6.8930      -65.4801      7.1047  
  1970 1979 -26.8802    12.4043      -92.1899     38.4295  
  1970 1980 -39.5660     9.9635      -92.0246     12.8927  
  1970 1981 -30.0122    11.0109      -87.9856     27.9612  
  1970 1982 -36.1714     8.2688      -79.7077      7.3648  
  1970 1983 -31.0969    12.3308      -96.0195     33.8257  
  1970 1984 -31.4749    10.8687      -88.6994     25.7496  
  1970 1985 -30.6346    19.3823     -132.6841     71.4149  
  1970 1986 -37.0754    18.5711     -134.8543     60.7034  
  1970 1987 -37.6630    10.9869      -95.5102     20.1841  
  1970 1988 -43.0563    12.0044     -106.2605     20.1479  
  1970 1989 -45.1314    14.6881     -122.4657     32.2029  
  1970 1990 -43.1765     8.2585      -86.6584      0.3054  
  1970 1991 -49.9116     9.3342      -99.0570     -0.7663 *
  1970 1992 -50.9515    12.8379     -118.5441     16.6411  
  1970 1993 -44.5526    12.3309     -109.4757     20.3705  
  1970 1994 -51.5405    17.7129     -144.8006     41.7195  
  1970 1995 -48.4108    17.3598     -139.8116     42.9901  
  1970 1996 -48.0618    17.3677     -139.5043     43.3808  
  1971 1965  -2.2110     3.6725      -21.5468     17.1248  
  1971 1966  -5.9450     3.3119      -23.3826     11.4926  
  1971 1967   6.1535     4.0326      -15.0788     27.3858  
  1971 1968   5.3039     3.3491      -12.3295     22.9374  
  1971 1969  -4.8826     3.7835      -24.8029     15.0378  
  1971 1970   0.5878     5.3984      -27.8354     29.0111  
  1971 1971  -7.5805     6.1797      -40.1173     24.9563  
  1971 1972 -11.4260     7.5255      -51.0484     28.1965  
  1971 1973  -5.8221     8.3926      -50.0100     38.3658  
  1971 1974   5.7926     5.2219      -21.7013     33.2865  
  1971 1975   0.0590     5.8315      -30.6442     30.7623  
  1971 1976  -0.7920     8.6544      -46.3580     44.7740  
  1971 1977   0.5899     8.2686      -42.9451     44.1250  
  1971 1978  -9.5946    10.1294      -62.9268     43.7376  
  1971 1979  -8.8180     5.6286      -38.4532     20.8173  
  1971 1980 -15.0039     6.7263      -50.4185     20.4107  
  1971 1981  -6.0810     8.1803      -49.1512     36.9893  
  1971 1982 -15.5575     9.1887      -63.9370     32.8220  
  1971 1983  -6.7973     5.7527      -37.0856     23.4910  
  1971 1984  -8.1090     7.0145      -45.0412     28.8231  
  1971 1985  -9.3683     8.5398      -54.3312     35.5946  
  1971 1986 -16.9260     7.5456      -56.6544     22.8024  
  1971 1987 -12.9962    11.6309      -74.2337     48.2413  
  1971 1988 -14.6487     8.6930      -60.4184     31.1210  
  1971 1989 -18.7126     8.5303      -63.6256     26.2005  
  1971 1990 -17.6198     6.9640      -54.2860     19.0464  
  1971 1991 -17.2789     9.2226      -65.8366     31.2789  
  1971 1992 -22.1825    10.4539      -77.2234     32.8584  
  1971 1993  -9.1278     9.5580      -59.4514     41.1958  
  1971 1994 -13.7091     9.2257      -62.2832     34.8650  
  1971 1995 -15.3270     7.4496      -54.5501     23.8961  
  1971 1996 -11.2124     9.5628      -61.5615     39.1367  
  1972 1965   1.9641     1.9969       -8.5499     12.4781  
  1972 1966   2.3826     6.5296      -31.9966     36.7618  
  1972 1967  -3.8865     5.8760      -34.8240     27.0510  
  1972 1968   7.6954     2.7166       -6.6078     21.9986  
  1972 1969  -8.7084     3.0096      -24.5544      7.1376  
  1972 1970   0.1004     2.5095      -13.1122     13.3131  
  1972 1971   1.1463     3.2441      -15.9340     18.2266  
  1972 1972  -4.8115     4.7424      -29.7805     20.1575  
  1972 1973  -2.3073     6.4622      -36.3315     31.7170  
  1972 1974   0.7950     5.0202      -25.6369     27.2269  
  1972 1975  -2.8930     4.6783      -27.5248     21.7389  
  1972 1976  -2.9838     9.7337      -54.2328     48.2652  
  1972 1977   2.8759     6.1908      -29.7190     35.4709  
  1972 1978 -13.9499     6.6983      -49.2169     21.3170  
  1972 1979  -4.7118    10.1748      -58.2833     48.8596  
  1972 1980  -9.9424     7.3103      -48.4319     28.5470  
  1972 1981   0.7622     7.2792      -37.5635     39.0880  
  1972 1982  -5.7949     7.2989      -44.2241     32.6342  
  1972 1983  -2.5286     8.4320      -46.9241     41.8670  
  1972 1984  -5.7192     8.0162      -47.9252     36.4868  
  1972 1985  -8.5492     8.4316      -52.9426     35.8441  
  1972 1986  -3.2909     6.4394      -37.1947     30.6129  
  1972 1987 -14.5853     7.4985      -54.0654     24.8948  
  1972 1988 -12.6795     6.2789      -45.7386     20.3796  
  1972 1989 -10.9845     6.5195      -45.3105     23.3415  
  1972 1990  -7.7794     7.2121      -45.7516     30.1927  
  1972 1991 -13.7033     5.3380      -41.8085     14.4020  
  1972 1992 -11.0100     8.7377      -57.0148     34.9949  
  1972 1993 -17.3770     7.0511      -54.5017     19.7477  
  1972 1994 -16.6543     7.8108      -57.7792     24.4705  
  1972 1995 -16.0626     6.6296      -50.9680     18.8427  
  1972 1996 -13.6292     5.4649      -42.4023     15.1440  
  1973 1965  -1.6544     3.2794      -18.9206     15.6118  
  1973 1966  -3.5308     3.8462      -23.7817     16.7200  
  1973 1967   5.5388     5.4983      -23.4103     34.4880  
  1973 1968  -4.1286     5.5552      -33.3772     25.1200  
  1973 1969   1.9470     4.1738      -20.0284     23.9224  
  1973 1970   0.3836     5.0403      -26.1542     26.9214  
  1973 1971  -0.4064     6.2964      -33.5578     32.7450  
  1973 1972  -0.7103     6.6695      -35.8256     34.4050  
  1973 1973   9.0122     6.5496      -25.4723     43.4967  
  1973 1974   7.0826     6.7716      -28.5703     42.7355  
  1973 1975   8.7932    10.0226      -43.9766     61.5631  
  1973 1976   5.5815     6.5396      -28.8501     40.0132  
  1973 1977   9.2638     7.6810      -31.1773     49.7049  
  1973 1978  -2.8479     7.6181      -42.9579     37.2621  
  1973 1979   3.5441     7.7835      -37.4368     44.5251  
  1973 1980  -3.7998     9.5099      -53.8704     46.2709  
  1973 1981   3.7874     8.7116      -42.0801     49.6548  
  1973 1982  -2.3342    10.0158      -55.0684     50.4000  
  1973 1983   0.3746     7.3659      -38.4077     39.1569  
  1973 1984  -4.0602     9.2947      -52.9978     44.8774  
  1973 1985  -3.3503     7.3315      -41.9516     35.2509  
  1973 1986  -9.9416     4.8532      -35.4940     15.6108  
  1973 1987 -10.5611     9.6965      -61.6143     40.4920  
  1973 1988 -13.3770     9.9206      -65.6100     38.8560  
  1973 1989  -9.7072     7.2830      -48.0532     28.6387  
  1973 1990 -12.5464     6.4817      -46.6733     21.5804  
  1973 1991 -15.9396     7.8730      -57.3916     25.5124  
  1973 1992 -17.9985     8.0284      -60.2685     24.2716  
  1973 1993 -13.8426     8.7832      -60.0867     32.4015  
  1973 1994  -9.0985     6.4961      -43.3008     25.1039  
  1973 1995 -12.4104     4.1396      -34.2056      9.3847  
  1973 1996 -14.4985     5.7950      -45.0098     16.0128  
  1974 1965  -3.4980     4.5212      -27.3026     20.3066  
  1974 1966   4.0405     5.5468      -25.1638     33.2449  
  1974 1967  -2.4469     2.5648      -15.9505     11.0568  
  1974 1968  -4.1701     5.3528      -32.3532     24.0129  
  1974 1969   3.0794     1.9885       -7.3902     13.5490  
  1974 1970   3.9844     2.5994       -9.7016     17.6705  
  1974 1971  -7.0304     3.1216      -23.4660      9.4052  
  1974 1972   6.3385     3.5155      -12.1709     24.8480  
  1974 1973   0.5656     5.2490      -27.0708     28.2020  
  1974 1974  -2.4409     4.3693      -25.4458     20.5640  
  1974 1975   1.3647     5.4472      -27.3156     30.0450  
  1974 1976  -3.5756     6.1293      -35.8468     28.6955  
  1974 1977  -4.0728     5.5412      -33.2478     25.1022  
  1974 1978  -8.9231     5.5465      -38.1260     20.2797  
  1974 1979  -1.7408     6.1767      -34.2617     30.7801  
  1974 1980  -9.7770     5.1335      -36.8052     17.2512  
  1974 1981  -2.8322     5.7942      -33.3390     27.6745  
  1974 1982  -7.4517     4.5001      -31.1450     16.2417  
  1974 1983  -4.3400     6.9428      -40.8943     32.2142  
  1974 1984  -7.8279     6.1533      -40.2257     24.5698  
  1974 1985   0.9048    11.2545      -58.3512     60.1608  
  1974 1986  -3.4953     8.4319      -47.8899     40.8993  
  1974 1987  -9.3045     8.2294      -52.6333     34.0242  
  1974 1988  -9.0434     8.2684      -52.5776     34.4907  
  1974 1989  -6.4758     9.6254      -57.1544     44.2028  
  1974 1990  -7.6369     8.3287      -51.4882     36.2144  
  1974 1991 -14.7133     7.4502      -53.9396     24.5129  
  1974 1992 -14.7711     7.6625      -55.1148     25.5726  
  1974 1993 -11.2274     8.3720      -55.3068     32.8520  
  1974 1994 -14.4350    10.6890      -70.7136     41.8436  
  1974 1995 -13.4194     9.3154      -62.4656     35.6269  
  1974 1996 -14.8017     9.7075      -65.9127     36.3093  
  1975 1965  18.6039     3.9126       -1.9964     39.2041  
  1975 1966  -3.3872     3.5526      -22.0922     15.3178  
  1975 1967  -2.4321     2.1711      -13.8631      8.9990  
  1975 1968   7.3667     4.6966      -17.3612     32.0946  
  1975 1969  -4.2480     4.8938      -30.0144     21.5185  
  1975 1970 -11.4912     5.1716      -38.7201     15.7378  
  1975 1971   5.6632     6.6708      -29.4591     40.7855  
  1975 1972 -15.6310     6.4630      -49.6593     18.3973  
  1975 1973  16.2449     6.5509      -18.2462     50.7360  
  1975 1974  -0.4082     5.8981      -31.4623     30.6458  
  1975 1975  -2.3510     2.7861      -17.0202     12.3183  
  1975 1976  -2.3824     5.5960      -31.8459     27.0810  
  1975 1977  -4.1345     6.6712      -39.2589     30.9900  
  1975 1978  -7.0822     6.4168      -40.8674     26.7031  
  1975 1979 -12.0112     9.5629      -62.3607     38.3383  
  1975 1980 -10.7602     4.9792      -36.9763     15.4559  
  1975 1981  -7.1236     5.2218      -34.6169     20.3697  
  1975 1982 -10.5685     7.1179      -48.0451     26.9082  
  1975 1983  -9.0308     5.8802      -39.9906     21.9291  
  1975 1984   9.8022     2.8005       -4.9427     24.5471  
  1975 1985  -5.6163     8.3116      -49.3778     38.1452  
  1975 1986  -5.2183     5.0173      -31.6349     21.1982  
  1975 1987  -0.8638     5.8515      -31.6723     29.9448  
  1975 1988 -15.3668    10.9143      -72.8316     42.0981  
  1975 1989  -5.4933     5.7476      -35.7551     24.7684  
  1975 1990   8.5067     4.0466      -12.7988     29.8122  
  1975 1991   0.7631     5.7580      -29.5535     31.0797  
  1975 1992  -4.2255     6.5854      -38.8983     30.4473  
  1975 1993   1.1200     2.8153      -13.7030     15.9430  
  1975 1994  -8.3655     7.5932      -48.3441     31.6132  
  1975 1995   1.8041     4.2049      -20.3350     23.9432  
  1975 1996  -6.9207     5.3719      -35.2043     21.3630  
  1976 1965 -11.0522     1.6798      -19.8962     -2.2081 *
  1976 1966   0.1018     2.1737      -11.3428     11.5464  
  1976 1967  -5.9143     2.1229      -17.0915      5.2628  
  1976 1968  -1.6479     2.0120      -12.2410      8.9452  
  1976 1969  -6.6407     1.8045      -16.1415      2.8600  
  1976 1970   8.5784     2.0017       -1.9610     19.1178  
  1976 1971   4.0973     2.3447       -8.2476     16.4421  
  1976 1972  -0.9903     2.8209      -15.8425     13.8620  
  1976 1973 -20.1263     3.7743      -39.9981     -0.2544 *
  1976 1974  39.6133     2.4581       26.6710     52.5556 *
  1976 1975  -3.5747     2.8462      -18.5605     11.4110  
  1976 1976   3.7698     5.4077      -24.7024     32.2419  
  1976 1977  33.5942     4.9989        7.2744     59.9141 *
  1976 1978  -3.1195     2.1796      -14.5951      8.3561  
  1976 1979   1.3342     7.2019      -36.5845     39.2529  
  1976 1980 -10.4124     3.8156      -30.5021      9.6773  
  1976 1981 -10.4368     5.7455      -40.6871     19.8136  
  1976 1982 -12.4922     3.6589      -31.7564      6.7720  
  1976 1983 -15.8081     6.2755      -48.8492     17.2330  
  1976 1984 -20.6870     5.5589      -49.9552      8.5812  
  1976 1985  -0.2053    16.2410      -85.7159     85.3053  
  1976 1986 -27.7992     8.3181      -71.5946     15.9963  
  1976 1987  -9.9985     4.4562      -33.4606     13.4637  
  1976 1988 -22.8540     6.0525      -54.7213      9.0132  
  1976 1989 -14.3020     6.6385      -49.2543     20.6503  
  1976 1990 -16.7275     5.9040      -47.8126     14.3576  
  1976 1991 -29.9838     5.5425      -59.1656     -0.8020 *
  1976 1992 -35.9431     6.2168      -68.6749     -3.2112 *
  1976 1993 -33.5630     6.2298      -66.3637     -0.7624 *
  1976 1994 -19.1785    13.9477      -92.6147     54.2577  
  1976 1995 -18.8943     9.0197      -66.3837     28.5952  
  1976 1996 -20.0712     8.3706      -64.1432     24.0008  
  1977 1965   6.8982    16.2098      -78.4478     92.2443  
  1977 1966 -11.1214     9.1429      -59.2595     37.0167  
  1977 1967  10.8566     6.0844      -21.1785     42.8918  
  1977 1968 -11.0425    11.8293      -73.3250     51.2399  
  1977 1969  10.1932    17.7861      -83.4523    103.8386  
  1977 1970   2.9004     5.7858      -27.5623     33.3630  
  1977 1971   3.0530     8.8195      -43.3826     49.4887  
  1977 1972  -0.6535    10.3787      -55.2981     53.9911  
  1977 1973   3.1405     8.7955      -43.1688     49.4499  
  1977 1974 -14.4506     5.9038      -45.5346     16.6333  
  1977 1975  -0.1240     4.8736      -25.7839     25.5359  
  1977 1976   5.5263    19.9139      -99.3224    110.3750  
  1977 1977  -0.1462    23.2079     -122.3382    122.0458  
  1977 1978 -17.4422    23.7997     -142.7498    107.8654  
  1977 1979  -7.6652    34.3624     -188.5866    173.2562  
  1977 1980 -12.0752    34.1460     -191.8571    167.7067  
  1977 1981 -11.8110    26.7649     -152.7309    129.1089  
  1977 1982 -18.5556    18.9923     -118.5517     81.4406  
  1977 1983   4.2551    35.6925     -183.6695    192.1797  
  1977 1984  -3.0226    28.7452     -154.3688    148.3237  
  1977 1985 -14.8995    19.9984     -120.1932     90.3942  
  1977 1986 -12.3230    14.5061      -88.6990     64.0531  
  1977 1987 -23.6769    33.2784     -198.8911    151.5372  
  1977 1988 -25.5547    23.3057     -148.2617     97.1523  
  1977 1989  -9.2602    41.5282     -227.9104    209.3899  
  1977 1990 -13.7369    46.2834     -257.4234    229.9497  
  1977 1991 -25.9731    34.1811     -205.9396    153.9934  
  1977 1992 -29.9220    25.4317     -163.8221    103.9781  
  1977 1993 -14.9531    37.6407     -213.1349    183.2287  
  1977 1994 -11.6033    48.3145     -265.9837    242.7770  
  1977 1995 -29.0098    23.5668     -153.0911     95.0716  
  1977 1996 -16.0590    27.7976     -162.4158    130.2978  
  1980 1965  -4.7817     1.7068      -13.7683      4.2049  
  1980 1966  -2.0295     2.1561      -13.3814      9.3224  
  1980 1967   0.2462     2.1062      -10.8433     11.3358  
  1980 1968   4.9725     2.0130       -5.6260     15.5710  
  1980 1969  -5.6981     1.8015      -15.1831      3.7870  
  1980 1970   7.6920     1.9744       -2.7031     18.0872  
  1980 1971  -9.5134     2.3514      -21.8938      2.8671  
  1980 1972   5.9170     2.8670       -9.1781     21.0121  
  1980 1973  -3.6509     3.9430      -24.4110     17.1091  
  1980 1974   1.1846     4.5627      -22.8387     25.2079  
  1980 1975  -1.4249     2.9403      -16.9059     14.0561  
  1980 1976   1.5220     6.0043      -30.0910     33.1349  
  1980 1977  -1.8998     2.8489      -16.8995     13.1000  
  1980 1978  -6.1099     5.6679      -35.9520     23.7322  
  1980 1979   6.0177     8.1746      -37.0225     49.0579  
  1980 1980 -11.0694     5.1001      -37.9219     15.7831  
  1980 1981  -7.3267     2.5718      -20.8673      6.2139  
  1980 1982  -9.2663     9.4756      -59.1560     40.6235  
  1980 1983   1.6316     3.2901      -15.6911     18.9543  
  1980 1984  -2.4538     5.0698      -29.1466     24.2389  
  1980 1985   4.4467     5.1164      -22.4915     31.3848  
  1980 1986  -9.5981     7.5428      -49.3118     30.1156  
  1980 1987 -10.0537    11.3335      -69.7257     49.6183  
  1980 1988 -10.9789     9.1300      -59.0491     37.0913  
  1980 1989  -6.9527     6.3603      -40.4401     26.5348  
  1980 1990  -5.3312     6.2450      -38.2116     27.5492  
  1980 1991  -8.8820     8.2207      -52.1646     34.4005  
  1980 1992 -12.0023     9.9672      -64.4804     40.4759  
  1980 1993  -8.3192     7.7315      -49.0260     32.3877  
  1980 1994 -12.5474     7.1011      -49.9356     24.8407  
  1980 1995  -6.7308     8.7926      -53.0246     39.5631  
  1980 1996  -9.1678     7.0565      -46.3212     27.9855  
  1984 1965   2.2727     1.6513       -6.4214     10.9668  
  1984 1966  -1.6070     2.1610      -12.9847      9.7707  
  1984 1967  -1.8538     2.1116      -12.9715      9.2639  
  1984 1968  -1.3557     2.0117      -11.9474      9.2360  
  1984 1969   2.1619     1.8266       -7.4555     11.7793  
  1984 1970  -0.3449     1.9920      -10.8328     10.1429  
  1984 1971 -10.9305     2.3220      -23.1560      1.2950  
  1984 1972   5.8536     2.8708       -9.2615     20.9686  
  1984 1973  -1.9239     3.9946      -22.9560     19.1082  
  1984 1974  -7.1605     4.3802      -30.2228     15.9018  
  1984 1975  -1.6437     2.9145      -16.9888     13.7014  
  1984 1976   5.6685     5.8802      -25.2916     36.6285  
  1984 1977   3.2342     2.7744      -11.3734     17.8418  
  1984 1978  -7.3151     5.5636      -36.6083     21.9780  
  1984 1979   1.9466     8.1404      -40.9135     44.8067  
  1984 1980  -8.6205     5.5291      -37.7316     20.4906  
  1984 1981  10.4692     4.9997      -15.8549     36.7933  
  1984 1982  -5.4364     7.9954      -47.5329     36.6600  
  1984 1983  12.0264     8.4379      -32.4001     56.4529  
  1984 1984  -0.7730     2.7483      -15.2428     13.6968  
  1984 1985   4.0744     6.4308      -29.7841     37.9329  
  1984 1986  -8.0341     2.9464      -23.5473      7.4791  
  1984 1987 -10.4189     8.0305      -52.7001     31.8623  
  1984 1988  -7.8277     5.8269      -38.5070     22.8516  
  1984 1989  -9.2894     3.8762      -29.6980     11.1192  
  1984 1990  -6.2529     2.9419      -21.7425      9.2366  
  1984 1991 -10.1584     4.9176      -36.0501     15.7333  
  1984 1992 -11.4694     6.6641      -46.5567     23.6179  
  1984 1993  -9.2844     4.4284      -32.6004     14.0316  
  1984 1994 -14.6630     5.2893      -42.5116     13.1856  
  1984 1995 -12.5044     3.7261      -32.1227      7.1138  
  1984 1996 -10.2449     3.2047      -27.1179      6.6281  
  1985 1965  -4.3499     1.6768      -13.1784      4.4785  
  1985 1966  37.6989     1.8952       27.7207     47.6771 *
  1985 1967 -19.2838     2.0016      -29.8224     -8.7451 *
  1985 1968  -4.2545     1.9931      -14.7482      6.2392  
  1985 1969  10.5295     1.7919        1.0948     19.9642 *
  1985 1970   7.2143     1.9826       -3.2244     17.6531  
  1985 1971   6.9735     2.3178       -5.2302     19.1771  
  1985 1972   5.8781     2.8300       -9.0219     20.7780  
  1985 1973 -38.9329     2.9480      -54.4544    -23.4113 *
  1985 1974   8.7158     4.6454      -15.7428     33.1744  
  1985 1975  -7.1533     2.7277      -21.5149      7.2083  
  1985 1976  -0.8308     5.8892      -31.8378     30.1762  
  1985 1977  -2.2605     2.7916      -16.9586     12.4376  
  1985 1978   7.7405     5.7327      -22.4426     37.9236  
  1985 1979  -4.9814     8.4658      -49.5548     39.5919  
  1985 1980   2.9209     6.2508      -29.9903     35.8320  
  1985 1981  -4.4773     5.0164      -30.8891     21.9345  
  1985 1982  13.7629     8.6635      -31.8514     59.3772  
  1985 1983  -7.4210     9.1244      -55.4620     40.6199  
  1985 1984  -5.5493     3.0237      -21.4692     10.3705  
  1985 1985  11.4728     8.5549      -33.5693     56.5150  
  1985 1986  10.1715     3.4372       -7.9259     28.2689  
  1985 1987  17.5291     5.0068       -8.8322     43.8905  
  1985 1988  -9.6423     4.1182      -31.3252     12.0407  
  1985 1989  19.8229     5.3527       -8.3597     48.0054  
  1985 1990  26.2350     1.7402       17.0725     35.3975 *
  1985 1991   6.2209     3.5620      -12.5334     24.9753  
  1985 1992  18.3602     6.2606      -14.6023     51.3226  
  1985 1993  23.0343     2.8585        7.9843     38.0843 *
  1985 1994  15.2612     6.3705      -18.2802     48.8027  
  1985 1995  15.4633     4.6990       -9.2773     40.2040  
  1985 1996  26.5282     3.9405        5.7812     47.2753 *
---
Signif. codes: `*' confidence band does not cover 0

Control Group:  Not Yet Treated,  Anticipation Periods:  0
Estimation Method:  Outcome Regression</code></pre>
</div>
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggdid</span>(atts_nyt)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="tarea-3-respuestas_files/figure-html/unnamed-chunk-10-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div></li>
<li><p>[5 puntos] Reporte los resultados agregados obtenidos a partir del estimador Callaway &amp; Sant’Anna (2021), usando una agregación dinámica que muestre los efectos promedio para cada periodo antes y después del tratamiento. Grafique e interprete los resultados.</p>
<p><em>Graficamos:</em></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>agg.es <span class="ot">&lt;-</span> <span class="fu">aggte</span>(atts_nyt,</span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>                <span class="at">type =</span> <span class="st">"dynamic"</span>)</span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(agg.es)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
aggte(MP = atts_nyt, type = "dynamic")

Reference: Callaway, Brantly and Pedro H.C. Sant'Anna.  "Difference-in-Differences with Multiple Time Periods." Journal of Econometrics, Vol. 225, No. 2, pp. 200-230, 2021. &lt;https://doi.org/10.1016/j.jeconom.2020.12.001&gt;, &lt;https://arxiv.org/abs/1803.09015&gt; 


Overall summary of ATT's based on event-study/dynamic aggregation:  
    ATT    Std. Error     [ 95%  Conf. Int.]  
 -9.628        3.6202   -16.7235     -2.5324 *


Dynamic Effects:
 Event time Estimate Std. Error [95% Simult.  Conf. Band]  
        -20  -4.3499     1.6586       -8.9332      0.2333  
        -19  19.9858     3.0773       11.4825     28.4890 *
        -18 -10.4454     7.2920      -30.5949      9.7041  
        -17  -3.0542     1.0627       -5.9907     -0.1176 *
        -16   4.5869     2.0551       -1.0917     10.2655  
        -15   1.5315     3.5582       -8.3008     11.3638  
        -14   1.5330     2.3823       -5.0498      8.1159  
        -13  -1.6021     5.2497      -16.1081     12.9040  
        -12  -1.2353     9.6435      -27.8826     25.4119  
        -11  -6.1889     4.7398      -19.2860      6.9082  
        -10   7.0286     4.8331       -6.3265     20.3838  
         -9  -5.6915     3.2833      -14.7640      3.3810  
         -8   1.1876     2.4203       -5.5003      7.8756  
         -7  -0.6219     2.1423       -6.5416      5.2978  
         -6   1.1581     2.7324       -6.3922      8.7084  
         -5  -2.9106     2.3377       -9.3702      3.5490  
         -4   2.9082     1.6167       -1.5593      7.3756  
         -3  -1.9822     2.7160       -9.4871      5.5228  
         -2   0.7311     2.6676       -6.6402      8.1023  
         -1   1.4763     2.4530       -5.3021      8.2547  
          0   0.5890     2.7588       -7.0341      8.2121  
          1  -1.2422     3.0842       -9.7647      7.2803  
          2  -0.3815     4.2496      -12.1243     11.3613  
          3  -0.4662     3.7764      -10.9013      9.9688  
          4  -0.3563     4.3566      -12.3946     11.6820  
          5  -3.4207     4.6214      -16.1909      9.3494  
          6  -2.4065     4.4579      -14.7248      9.9117  
          7  -6.4250     4.5353      -18.9570      6.1070  
          8  -5.8964     4.5719      -18.5297      6.7369  
          9  -6.3944     4.3414      -18.3906      5.6018  
         10  -7.7061     4.6488      -20.5519      5.1397  
         11  -8.8186     4.8328      -22.1729      4.5357  
         12  -7.2921     4.0934      -18.6032      4.0189  
         13 -11.1384     4.1426      -22.5854      0.3085  
         14 -11.1558     4.1368      -22.5867      0.2751  
         15 -14.8167     5.4134      -29.7752      0.1418  
         16 -11.6965     5.3451      -26.4662      3.0732  
         17 -14.3232     4.6877      -27.2765     -1.3698 *
         18 -17.1010     4.8452      -30.4896     -3.7125 *
         19 -17.4748     4.6692      -30.3768     -4.5727 *
         20 -14.9783     4.5190      -27.4654     -2.4913 *
         21 -15.8960     4.7437      -29.0041     -2.7879 *
         22 -15.2219     4.4291      -27.4605     -2.9832 *
         23 -16.2453     5.0376      -30.1652     -2.3253 *
         24 -17.8714     7.4445      -38.4424      2.6996  
         25 -17.0567    10.2117      -45.2741     11.1607  
         26 -27.4244    18.3839      -78.2235     23.3748  
         27   3.0338    13.1707      -33.3601     39.4277  
---
Signif. codes: `*' confidence band does not cover 0

Control Group:  Not Yet Treated,  Anticipation Periods:  0
Estimation Method:  Outcome Regression</code></pre>
</div>
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggdid</span>(agg.es)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="tarea-3-respuestas_files/figure-html/unnamed-chunk-11-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p><em>Se obtiene una reducción en la tasa de suicidios que es estadísticamente significativa a partir de 13 años después de la introducción de la legislación.</em></p></li>
<li><p>[5 puntos] Reporte los resultados agregados obtenidos a partir del estimador Callaway &amp; Sant’Anna (2021), usando una agregación or grupos que muestre los efectos promedio para cada cohorte del tratamiento. Grafique e interprete los resultados.</p>
<p><em>Graficamos:</em></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>agg.es <span class="ot">&lt;-</span> <span class="fu">aggte</span>(atts_nyt,</span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>                <span class="at">type =</span> <span class="st">"group"</span>)</span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(agg.es)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
aggte(MP = atts_nyt, type = "group")

Reference: Callaway, Brantly and Pedro H.C. Sant'Anna.  "Difference-in-Differences with Multiple Time Periods." Journal of Econometrics, Vol. 225, No. 2, pp. 200-230, 2021. &lt;https://doi.org/10.1016/j.jeconom.2020.12.001&gt;, &lt;https://arxiv.org/abs/1803.09015&gt; 


Overall summary of ATT's based on group/cohort aggregation:  
     ATT    Std. Error     [ 95%  Conf. Int.]  
 -8.2876        2.8832   -13.9385     -2.6366 *


Group Effects:
 Group Estimate Std. Error [95% Simult.  Conf. Band]  
  1969  -5.3569     7.9997      -23.6505     12.9367  
  1970 -30.6010     8.7371      -50.5808    -10.6211 *
  1971 -10.3173     5.8748      -23.7516      3.1171  
  1972  -7.9006     4.5322      -18.2647      2.4635  
  1973  -4.5364     5.1854      -16.3943      7.3214  
  1974  -7.3929     5.9527      -21.0054      6.2197  
  1975  -4.3417     3.1211      -11.4791      2.7956  
  1976 -13.5133     4.7545      -24.3857     -2.6408 *
  1977 -14.6717    21.8573      -64.6546     35.3112  
  1980  -7.3295     5.5698      -20.0665      5.4074  
  1984  -8.2189     2.9046      -14.8611     -1.5767 *
  1985  15.0381     2.6844        8.8995     21.1767 *
---
Signif. codes: `*' confidence band does not cover 0

Control Group:  Not Yet Treated,  Anticipation Periods:  0
Estimation Method:  Outcome Regression</code></pre>
</div>
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggdid</span>(agg.es)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="tarea-3-respuestas_files/figure-html/unnamed-chunk-12-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p><em>Notamos un efecto negativo en la tasa de suicidos que es estadísticamente significativa para los estados que fueron tratados en 1970, 1986 y 1984.</em></p></li>
<li><p>[5 puntos] ¿Cuáles son las ventajas del estimador de Callaway &amp; Sant’Anna (2021) respecto al estimador de TWFE?</p>
<p><em>Las ventajas del estimador de Callaway &amp; Sant’Anna respecto a TWFE son las siguientes:</em> <em>- Evita las comapraciones prohibidas (usar unidades tratadas como controles para unidades que son tratadas en periodos posteriores)</em> <em>- Hace explícito el grupo de comparación que se usa para comparar a las unidades tratadas</em> <em>- Hace explícita la manera en que se agregan los resultados de cada comparación <span class="math inline">\(ATT(g,t)\)</span></em> <em>- No impone efectos monótonos en el tiempo ni homogéneos entre unidades</em></p></li>
</ol>
</section>
<section id="pregunta-2" class="level2">
<h2 class="anchored" data-anchor-id="pregunta-2">Pregunta 2</h2>
<p>La ENIGH 2020 incluyó un módulo para la evaluación del Programa Jóvenes Construyendo el futuro. Se buscó que la cobertura de la encuesta pudiera incluir suficientes participantes del programa para poder compararlos con los no participantes. Los datos en <em>datos_jcf_analisis.csv</em> fueron construidos a partir de dicha encuesta. En este ejercicio estimaremos el efecto de participar en el programa sobre el ingreso trimestral, <strong>ingtot_tri</strong>, usando métodos de matching.</p>
<p>Las siguientes variables están incluidas en el archivo de datos: <strong>mujer</strong> (dummy de sexo), <strong>indigena</strong> (dummy de pertenencia a una etnia), <strong>rural</strong> (dummy del ámbito rural), <strong>escoacum</strong> (años de escolaridad), <strong>casadounion</strong> (dummy para casados o en unión libre), <strong>jefehog</strong> (dummy para jefes del hogar), <strong>haymenores</strong> (dummy para la presencia de menores de edad en el hogar), <strong>proggob</strong> (dummy para beneficiarios de programas de gobierno), y <strong>tot_integ</strong> (número de miembros del hogar). También se incluye la clave de las entidades, <strong>cve_ent</strong>.</p>
<ol type="a">
<li><p>[5 puntos] Considere la comparación para el ingreso trimestral, <strong>ingtot_tri</strong>, entre beneficiarios y su grupo de comparación, que serán los jóvenes que no asisten a la escuela y no están empleados. Los beneficiarios tienen <em>jcf2==1</em> y los jóvenes que no asisten a la escuela y no están empleados tienen <em>jcf2==0</em>. Muestre qué tan similares o qué tan diferentes son los individuos en ambos grupos en términos de las características indicadas anteriormente y del ingreso trimestral.</p>
<p><em>Estadística descriptiva:</em></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>data.jcf <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">"../files/datos_jcf_analisis.csv"</span>)</span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1023</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><em>Aquí usé datasummary para calcular la estadística descriptiva por grupos:</em></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="fu">datasummary</span>(ingtot_tri <span class="sc">+</span> mujer <span class="sc">+</span> indigena <span class="sc">+</span> rural <span class="sc">+</span> escoacum <span class="sc">+</span> casadounion <span class="sc">+</span> jefehog <span class="sc">+</span> haymenores <span class="sc">+</span> proggob <span class="sc">+</span> tot_integ <span class="sc">~</span> <span class="fu">factor</span>(jcf2) <span class="sc">*</span> (mean <span class="sc">+</span> sd) <span class="sc">*</span> <span class="fu">Arguments</span>(<span class="at">na.rm=</span><span class="cn">TRUE</span>),</span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>                <span class="at">fmt =</span> <span class="st">"%.2f"</span>,</span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a>                <span class="at">data =</span> data.jcf)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<!-- preamble start -->

    <script>

      function styleCell_o319cneo8effsfcg38ue(i, j, css_id) {
          var table = document.getElementById("tinytable_o319cneo8effsfcg38ue");
          var cell = table.rows[i]?.cells[j];  // Safe navigation to avoid errors
          if (cell) {
              console.log(`Styling cell at (${i}, ${j}) with class ${css_id}`);
              cell.classList.add(css_id);
          } else {
              console.warn(`Cell at (${i}, ${j}) not found.`);
          }
      }
      function insertSpanRow(i, colspan, content) {
        var table = document.getElementById('tinytable_o319cneo8effsfcg38ue');
        var newRow = table.insertRow(i);
        var newCell = newRow.insertCell(0);
        newCell.setAttribute("colspan", colspan);
        // newCell.innerText = content;
        // this may be unsafe, but innerText does not interpret <br>
        newCell.innerHTML = content;
      }
      function spanCell_o319cneo8effsfcg38ue(i, j, rowspan, colspan) {
        var table = document.getElementById("tinytable_o319cneo8effsfcg38ue");
        const targetRow = table.rows[i];
        const targetCell = targetRow.cells[j];
        for (let r = 0; r < rowspan; r++) {
          // Only start deleting cells to the right for the first row (r == 0)
          if (r === 0) {
            // Delete cells to the right of the target cell in the first row
            for (let c = colspan - 1; c > 0; c--) {
              if (table.rows[i + r].cells[j + c]) {
                table.rows[i + r].deleteCell(j + c);
              }
            }
          }
          // For rows below the first, delete starting from the target column
          if (r > 0) {
            for (let c = colspan - 1; c >= 0; c--) {
              if (table.rows[i + r] && table.rows[i + r].cells[j]) {
                table.rows[i + r].deleteCell(j);
              }
            }
          }
        }
        // Set rowspan and colspan of the target cell
        targetCell.rowSpan = rowspan;
        targetCell.colSpan = colspan;
      }
      // tinytable span after
      window.addEventListener('load', function () {
          var cellsToStyle = [
            // tinytable style arrays after
          { positions: [ { i: 0, j: 4 }, { i: 0, j: 3 },  ], css_id: 'tinytable_css_0yqui8arvthnnaij9ef1',}, 
          { positions: [ { i: 11, j: 1 }, { i: 11, j: 3 }, { i: 11, j: 2 }, { i: 11, j: 4 },  ], css_id: 'tinytable_css_uy949959h4oavhy4bb3w',}, 
          { positions: [ { i: 2, j: 1 }, { i: 3, j: 1 }, { i: 4, j: 1 }, { i: 5, j: 1 }, { i: 6, j: 1 }, { i: 7, j: 1 }, { i: 8, j: 1 }, { i: 9, j: 1 }, { i: 2, j: 2 }, { i: 3, j: 2 }, { i: 4, j: 2 }, { i: 5, j: 2 }, { i: 6, j: 2 }, { i: 7, j: 2 }, { i: 8, j: 2 }, { i: 9, j: 2 }, { i: 10, j: 2 }, { i: 10, j: 1 }, { i: 4, j: 3 }, { i: 2, j: 4 }, { i: 2, j: 3 }, { i: 3, j: 3 }, { i: 8, j: 3 }, { i: 5, j: 3 }, { i: 6, j: 3 }, { i: 7, j: 3 }, { i: 4, j: 4 }, { i: 9, j: 3 }, { i: 10, j: 3 }, { i: 3, j: 4 }, { i: 8, j: 4 }, { i: 5, j: 4 }, { i: 6, j: 4 }, { i: 7, j: 4 }, { i: 9, j: 4 }, { i: 10, j: 4 },  ], css_id: 'tinytable_css_5z7kieg41eh3ajo5xwpf',}, 
          { positions: [ { i: 0, j: 1 }, { i: 0, j: 2 },  ], css_id: 'tinytable_css_xz4jsovqyj368hcdqj43',}, 
          { positions: [ { i: 1, j: 1 }, { i: 1, j: 4 }, { i: 1, j: 3 }, { i: 1, j: 2 },  ], css_id: 'tinytable_css_p4cqrq4zc0yzpl955wnh',}, 
          { positions: [ { i: 11, j: 0 },  ], css_id: 'tinytable_css_vo1f9z8qq1hckx65an83',}, 
          { positions: [ { i: 2, j: 0 }, { i: 3, j: 0 }, { i: 4, j: 0 }, { i: 5, j: 0 }, { i: 6, j: 0 }, { i: 7, j: 0 }, { i: 8, j: 0 }, { i: 9, j: 0 }, { i: 10, j: 0 },  ], css_id: 'tinytable_css_lb3olvsqqn1vp6y6vaxw',}, 
          { positions: [ { i: 0, j: 0 },  ], css_id: 'tinytable_css_4vgw1gktcznutol253vj',}, 
          { positions: [ { i: 1, j: 0 },  ], css_id: 'tinytable_css_zyruoz028ig4ioptxxgm',}, 
          ];

          // Loop over the arrays to style the cells
          cellsToStyle.forEach(function (group) {
              group.positions.forEach(function (cell) {
                  styleCell_o319cneo8effsfcg38ue(cell.i, cell.j, group.css_id);
              });
          });
      });
    </script>

    <style>
      /* tinytable css entries after */
      .table td.tinytable_css_0yqui8arvthnnaij9ef1, .table th.tinytable_css_0yqui8arvthnnaij9ef1 { text-align: right; text-align: center; border-top: solid #d3d8dc 0.1em; text-align: center; }
      .table td.tinytable_css_uy949959h4oavhy4bb3w, .table th.tinytable_css_uy949959h4oavhy4bb3w { text-align: right; border-bottom: solid #d3d8dc 0.1em; }
      .table td.tinytable_css_5z7kieg41eh3ajo5xwpf, .table th.tinytable_css_5z7kieg41eh3ajo5xwpf { text-align: right; }
      .table td.tinytable_css_xz4jsovqyj368hcdqj43, .table th.tinytable_css_xz4jsovqyj368hcdqj43 { text-align: right; text-align: center; border-top: solid #d3d8dc 0.1em; text-align: center; border-bottom: solid #d3d8dc 0.05em; }
      .table td.tinytable_css_p4cqrq4zc0yzpl955wnh, .table th.tinytable_css_p4cqrq4zc0yzpl955wnh { text-align: right; border-bottom: solid #d3d8dc 0.05em; }
      .table td.tinytable_css_vo1f9z8qq1hckx65an83, .table th.tinytable_css_vo1f9z8qq1hckx65an83 { text-align: left; border-bottom: solid #d3d8dc 0.1em; }
      .table td.tinytable_css_lb3olvsqqn1vp6y6vaxw, .table th.tinytable_css_lb3olvsqqn1vp6y6vaxw { text-align: left; }
      .table td.tinytable_css_4vgw1gktcznutol253vj, .table th.tinytable_css_4vgw1gktcznutol253vj { text-align: left; text-align: center; border-top: solid #d3d8dc 0.1em; text-align: center; }
      .table td.tinytable_css_zyruoz028ig4ioptxxgm, .table th.tinytable_css_zyruoz028ig4ioptxxgm { text-align: left; border-bottom: solid #d3d8dc 0.05em; }
    </style>
    <div class="container">
      <table class="table table-borderless" id="tinytable_o319cneo8effsfcg38ue" style="width: auto; margin-left: auto; margin-right: auto;" data-quarto-disable-processing="true">
        <thead>
<tr>
<th scope="col" align="center" colspan="1"> </th>
<th scope="col" align="center" colspan="2">0</th>
<th scope="col" align="center" colspan="2">1</th>
</tr>

              <tr>
                <th scope="col"> </th>
                <th scope="col">mean</th>
                <th scope="col">sd</th>
                <th scope="col">mean</th>
                <th scope="col">sd</th>
              </tr>
        </thead>

        <tbody>
                <tr>
                  <td>ingtot_tri</td>
                  <td>1510.36</td>
                  <td>8478.60</td>
                  <td>9643.06</td>
                  <td>6632.56</td>
                </tr>
                <tr>
                  <td>mujer</td>
                  <td>0.76</td>
                  <td>0.43</td>
                  <td>0.59</td>
                  <td>0.49</td>
                </tr>
                <tr>
                  <td>indigena</td>
                  <td>0.22</td>
                  <td>0.41</td>
                  <td>0.59</td>
                  <td>0.49</td>
                </tr>
                <tr>
                  <td>rural</td>
                  <td>0.40</td>
                  <td>0.49</td>
                  <td>0.35</td>
                  <td>0.48</td>
                </tr>
                <tr>
                  <td>escoacum</td>
                  <td>10.39</td>
                  <td>3.23</td>
                  <td>12.03</td>
                  <td>2.70</td>
                </tr>
                <tr>
                  <td>casadounion</td>
                  <td>0.53</td>
                  <td>0.50</td>
                  <td>0.41</td>
                  <td>0.49</td>
                </tr>
                <tr>
                  <td>jefehog</td>
                  <td>0.06</td>
                  <td>0.23</td>
                  <td>0.14</td>
                  <td>0.35</td>
                </tr>
                <tr>
                  <td>haymenores</td>
                  <td>0.66</td>
                  <td>0.47</td>
                  <td>0.54</td>
                  <td>0.50</td>
                </tr>
                <tr>
                  <td>proggob</td>
                  <td>0.19</td>
                  <td>0.39</td>
                  <td>0.21</td>
                  <td>0.41</td>
                </tr>
                <tr>
                  <td>tot_integ</td>
                  <td>4.82</td>
                  <td>1.97</td>
                  <td>4.25</td>
                  <td>2.00</td>
                </tr>
        </tbody>
      </table>
    </div>
<!-- hack to avoid NA insertion in last line -->
</div>
</div>
<p><em>Claramente los individuos que participan en el programa son diferentes a los que no. En el programa hay una proporción menor de mujeres que en el grupo no tratado; en el grupo tratado hay un nivel mayor de escolaridad acumulada; y los individuos del grupo tratado viven en hogares más pequeños que los del grupo no tratado. Entre muchas otras diferencias.</em></p>
<p><em>El problema entonces es que existen factores que influyen en la probabilidad de recibir el tratamiento y en el ingreso, por lo que una comparación simple de individuos tratados y no tratados confundirá el efecto del tratamiento.</em></p></li>
<li><p>[5 puntos] Estime el TOT (TT o ATT) del programa en el ingreso trimestral, <strong>ingtot_tri</strong> usando el algoritmo de <em>vecino más cercano</em>. Para estimar el impacto en el ingreso trimestral se comparan a los beneficiarios de JCF con los jóvenes que no asisten a la escuela y no están empleados. Los beneficiarios tienen <em>jcf2==1</em> y los jóvenes que no asisten a la escuela y no están empleados tienen <em>jcf2==0</em>. Escoja la especificación del <em>propensity score</em> que más le parezca adecuada. Realice la inferencia estadística con errores agrupados a nivel grupo de emparejamiento. ¿De qué tamaño es el TOT estimado y es este efecto estadísticamente significativo?</p>
<p><em>Este es el modelo para el propensity score que yo escogí:</em></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a>sub.data <span class="ot">&lt;-</span> data.jcf <span class="sc">%&gt;%</span></span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>dplyr<span class="sc">::</span><span class="fu">select</span>(ingtot_tri, jcf2, mujer, indigena, cve_ent, rural, escoacum, casadounion,</span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a>    jefehog, haymenores, proggob, tot_integ, factor.x)</span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-5"><a href="#cb29-5" aria-hidden="true" tabindex="-1"></a>sub.data <span class="ot">&lt;-</span> sub.data[<span class="fu">complete.cases</span>(sub.data), ]</span>
<span id="cb29-6"><a href="#cb29-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-7"><a href="#cb29-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-8"><a href="#cb29-8" aria-hidden="true" tabindex="-1"></a>m.out.a <span class="ot">&lt;-</span> <span class="fu">matchit</span>(<span class="at">formula=</span>jcf2 <span class="sc">~</span> mujer <span class="sc">+</span> indigena <span class="sc">+</span> <span class="fu">factor</span>(cve_ent) <span class="sc">+</span> rural  <span class="sc">+</span> escoacum <span class="sc">+</span> casadounion <span class="sc">+</span> jefehog <span class="sc">+</span> haymenores <span class="sc">+</span> proggob <span class="sc">+</span> tot_integ,</span>
<span id="cb29-9"><a href="#cb29-9" aria-hidden="true" tabindex="-1"></a>                 <span class="at">method =</span> <span class="st">"nearest"</span>,</span>
<span id="cb29-10"><a href="#cb29-10" aria-hidden="true" tabindex="-1"></a>                 <span class="at">distance=</span> <span class="st">"glm"</span>,</span>
<span id="cb29-11"><a href="#cb29-11" aria-hidden="true" tabindex="-1"></a>                 <span class="at">replace =</span> <span class="cn">FALSE</span>,</span>
<span id="cb29-12"><a href="#cb29-12" aria-hidden="true" tabindex="-1"></a>                 <span class="at">data =</span> sub.data)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><em>Estimamos el efecto del tratamiento:</em></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>tt1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(ingtot_tri <span class="sc">~</span> jcf2,</span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>      <span class="at">data =</span> <span class="fu">match.data</span>(m.out.a))</span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a><span class="co">#Errores agrupados a nivel subclass</span></span>
<span id="cb30-5"><a href="#cb30-5" aria-hidden="true" tabindex="-1"></a><span class="fu">coeftest</span>(tt1,</span>
<span id="cb30-6"><a href="#cb30-6" aria-hidden="true" tabindex="-1"></a>         <span class="at">vcov. =</span> vcovCL,</span>
<span id="cb30-7"><a href="#cb30-7" aria-hidden="true" tabindex="-1"></a>         <span class="at">cluster =</span> <span class="sc">~</span>subclass)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
t test of coefficients:

            Estimate Std. Error t value  Pr(&gt;|t|)    
(Intercept)  1669.95     407.99  4.0931 5.735e-05 ***
jcf2         7973.11     708.27 11.2572 &lt; 2.2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
<p><em>Se estima un efecto de 7973 pesos adicionales de ingreso trimestral para los participantes en el programa.</em></p></li>
<li><p>[5 puntos] En el matching de la parte b., evalúe qué tan bueno es el procedimiento en balancear las características observadas una vez realizado el matching. Cree un <em>love plot</em> para evaluar qué tan bueno es el procedimiento de matching para obtener una muestra balanceada.</p>
<p><em>bal.tab del paquete cobalt nos permite ver un resumen del balance:</em></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Con esto elimino las dummies de estado de la salida</span></span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a><span class="fu">bal.tab</span>(m.out.a, <span class="at">m.threshold=</span><span class="fl">0.1</span>, <span class="at">un=</span>T)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Balance Measures
                       Type Diff.Un Diff.Adj        M.Threshold
distance           Distance  1.1091   0.0881     Balanced, &lt;0.1
mujer                Binary -0.1660   0.0551     Balanced, &lt;0.1
indigena             Binary  0.3714   0.0551     Balanced, &lt;0.1
factor(cve_ent)_01   Binary -0.1720  -0.0157     Balanced, &lt;0.1
factor(cve_ent)_02   Binary -0.3428  -0.0079     Balanced, &lt;0.1
factor(cve_ent)_03   Binary  0.0168   0.0079     Balanced, &lt;0.1
factor(cve_ent)_04   Binary  0.5524   0.0157     Balanced, &lt;0.1
factor(cve_ent)_05   Binary -0.0544   0.0000     Balanced, &lt;0.1
rural                Binary -0.0553   0.0709     Balanced, &lt;0.1
escoacum            Contin.  0.6086  -0.2096 Not Balanced, &gt;0.1
casadounion          Binary -0.1170   0.0709     Balanced, &lt;0.1
jefehog              Binary  0.0831   0.0551     Balanced, &lt;0.1
haymenores           Binary -0.1193   0.0787     Balanced, &lt;0.1
proggob              Binary  0.0220   0.0079     Balanced, &lt;0.1
tot_integ           Contin. -0.2856   0.0158     Balanced, &lt;0.1

Balance tally for mean differences
                   count
Balanced, &lt;0.1        14
Not Balanced, &gt;0.1     1

Variable with the greatest mean difference
 Variable Diff.Adj        M.Threshold
 escoacum  -0.2096 Not Balanced, &gt;0.1

Sample sizes
          Control Treated
All          1894     127
Matched       127     127
Unmatched    1767       0</code></pre>
</div>
</div>
<p><em>Y finalmente el loveplot:</em></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a>m.out.a[[<span class="st">"X"</span>]][[<span class="st">"factor(cve_ent)"</span>]] <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a><span class="fu">love.plot</span>(<span class="fu">bal.tab</span>(m.out.a),</span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a>      <span class="at">threshold =</span> .<span class="dv">1</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="tarea-3-respuestas_files/figure-html/unnamed-chunk-18-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p><em>Parece haber un buen balance, aunque la educación es la única variable que no queda bien balanceada. Después del emparejamiento, las medias (estandarizadas) entre tratados y no tratados difieren en más de 0.1.</em></p></li>
<li><p>[5 puntos] Estime ahora el TOT en el ingreso trimestral, como en la parte b., pero usando un caliper de 0.05 y 5 vecinos a ser emparejados. ¿Cómo cambian sus resultados respecto a los de la parte b.?</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a>sub.data <span class="ot">&lt;-</span> data.jcf <span class="sc">%&gt;%</span> </span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(ingtot_tri, jcf2, mujer, indigena, cve_ent, rural, escoacum, </span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a>           casadounion, jefehog, haymenores, proggob, tot_integ, factor.x)</span>
<span id="cb35-4"><a href="#cb35-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-5"><a href="#cb35-5" aria-hidden="true" tabindex="-1"></a>sub.data <span class="ot">&lt;-</span> sub.data[<span class="fu">complete.cases</span>(sub.data), ] </span>
<span id="cb35-6"><a href="#cb35-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-7"><a href="#cb35-7" aria-hidden="true" tabindex="-1"></a>m.out.c <span class="ot">&lt;-</span> <span class="fu">matchit</span>(<span class="at">formula=</span>jcf2 <span class="sc">~</span> mujer <span class="sc">+</span> indigena <span class="sc">+</span> <span class="fu">factor</span>(cve_ent) <span class="sc">+</span> rural  <span class="sc">+</span> escoacum <span class="sc">+</span> casadounion <span class="sc">+</span> jefehog <span class="sc">+</span> haymenores <span class="sc">+</span> proggob <span class="sc">+</span> tot_integ,</span>
<span id="cb35-8"><a href="#cb35-8" aria-hidden="true" tabindex="-1"></a>                 <span class="at">method =</span> <span class="st">"nearest"</span>,</span>
<span id="cb35-9"><a href="#cb35-9" aria-hidden="true" tabindex="-1"></a>                 <span class="at">distance=</span> <span class="st">"glm"</span>,</span>
<span id="cb35-10"><a href="#cb35-10" aria-hidden="true" tabindex="-1"></a>                 <span class="at">ratio =</span> <span class="dv">5</span>,</span>
<span id="cb35-11"><a href="#cb35-11" aria-hidden="true" tabindex="-1"></a>                 <span class="at">caliper =</span> <span class="fl">0.05</span>,</span>
<span id="cb35-12"><a href="#cb35-12" aria-hidden="true" tabindex="-1"></a>                 <span class="at">replace =</span> <span class="cn">FALSE</span>,</span>
<span id="cb35-13"><a href="#cb35-13" aria-hidden="true" tabindex="-1"></a>                 <span class="at">data =</span> sub.data)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><em>Estimamos el efecto del tratamiento:</em></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a>tt3 <span class="ot">&lt;-</span> <span class="fu">lm</span>(ingtot_tri <span class="sc">~</span> jcf2,</span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a>      <span class="at">data =</span> <span class="fu">match.data</span>(m.out.c))</span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-4"><a href="#cb36-4" aria-hidden="true" tabindex="-1"></a><span class="co">#Errores agrupados a nivel subclass</span></span>
<span id="cb36-5"><a href="#cb36-5" aria-hidden="true" tabindex="-1"></a><span class="fu">coeftest</span>(tt3,</span>
<span id="cb36-6"><a href="#cb36-6" aria-hidden="true" tabindex="-1"></a>         <span class="at">vcov. =</span> vcovCL,</span>
<span id="cb36-7"><a href="#cb36-7" aria-hidden="true" tabindex="-1"></a>         <span class="at">cluster =</span> <span class="sc">~</span>subclass)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
t test of coefficients:

            Estimate Std. Error t value  Pr(&gt;|t|)    
(Intercept)  2135.55     372.22  5.7374 1.717e-08 ***
jcf2         7155.74     699.21 10.2341 &lt; 2.2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
<p><em>Se estima ahora un efecto de 7155 pesos, menor al efecto de 7973 pesos estimado en la parte b.</em></p></li>
</ol>


</section>
</section>


<div id="quarto-appendix" class="default"><section id="footnotes" class="footnotes footnotes-end-of-document" role="doc-endnotes"><h2 class="anchored quarto-appendix-heading">Notas</h2>

<ol>
<li id="fn1"><p>Stevenson, B. &amp; Wolfers, J. (2006). Bargaining in the Shadow of the Law: Divorce Laws and Family Distress. <em>The Quarterly Journal of Economics</em>, 121(1), 267-288.<a href="#fnref1" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
</ol>
</section></div></main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copiado");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copiado");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
        const codeEl = trigger.previousElementSibling.cloneNode(true);
        for (const childEl of codeEl.children) {
          if (isCodeAnnotation(childEl)) {
            childEl.remove();
          }
        }
        return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp('/' + window.location.host + '/');
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
</div> <!-- /content -->




</body></html>