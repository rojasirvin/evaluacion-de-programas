<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="es" xml:lang="es"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.7.32">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Respuestas a la tarea 3 – Inferencia Causal 2025</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<script src="../site_libs/quarto-html/quarto.js" type="module"></script>
<script src="../site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting-37eea08aefeeee20ff55810ff984fec1.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap-209d9ab60904f1bb8f31161fafd02104.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "Sin resultados",
    "search-matching-documents-text": "documentos encontrados",
    "search-copy-link-title": "Copiar el enlace en la búsqueda",
    "search-hide-matches-text": "Ocultar resultados adicionales",
    "search-more-match-text": "resultado adicional en este documento",
    "search-more-matches-text": "resultados adicionales en este documento",
    "search-clear-button-title": "Borrar",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancelar",
    "search-submit-button-title": "Enviar",
    "search-label": "Buscar"
  }
}</script>

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<link rel="stylesheet" href="../styles.css">
</head>

<body class="nav-sidebar docked quarto-light">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Alternar barra lateral" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item">Respuestas a la tarea 3</li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Alternar barra lateral" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Buscar" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation docked overflow-auto">
    <div class="pt-lg-2 mt-2 text-center sidebar-header">
      <a href="../index.html" class="sidebar-logo-link">
      <img src="../iconoEvaluaciondeProgramasSociales.jpg" alt="" class="sidebar-logo py-0 d-lg-inline d-none">
      </a>
      <div class="sidebar-tools-main">
    <a href="https://github.com/rojasirvin/evaluacion-de-programas" title="GitHub" class="quarto-navigation-tool px-1" aria-label="GitHub"><i class="bi bi-github"></i></a>
</div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Buscar"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Home</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../programa.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Programa</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../reglas.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Reglas</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../lecturas.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Lecturas</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../presentaciones.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Presentaciones</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../cronograma.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Cronograma</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../tareas/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Tareas</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../notas/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Notas</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../diapositivas/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Diapositivas</span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">En esta página</h2>
   
  <ul>
  <li><a href="#respuestas" id="toc-respuestas" class="nav-link active" data-scroll-target="#respuestas">Respuestas</a>
  <ul class="collapse">
  <li><a href="#pregunta-1" id="toc-pregunta-1" class="nav-link" data-scroll-target="#pregunta-1">Pregunta 1</a></li>
  <li><a href="#pregunta-2" id="toc-pregunta-2" class="nav-link" data-scroll-target="#pregunta-2">Pregunta 2</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Respuestas a la tarea 3</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<section id="respuestas" class="level1">
<h1>Respuestas</h1>
<section id="pregunta-1" class="level2">
<h2 class="anchored" data-anchor-id="pregunta-1">Pregunta 1</h2>
<p>Stevenson, B. &amp; Wolfers, J. (2006)<a href="#fn1" class="footnote-ref" id="fnref1" role="doc-noteref"><sup>1</sup></a> estudian los efectos de la introducción de leyes que permiten el divorcio unilateral en los Estados Unidos. La librería <em>bacondecomp</em> incluye los datos usados en dicho artículo (debe instalar y cargar la librería). Usaremos los datos de 1964 a 1996 para mostrar cómo impactan las leyes de divorcio express (unilateral) a la tasa de suicidios en mujeres.</p>
<p>Al correr el pedazo de código anterior, obtendrá un objeto de datos <strong>wd</strong> en donde la variable de impacto es la tasa de suicidios en mujeres, <strong>suicide_rate</strong>, <strong>st</strong> identifica a los estados, <strong>year</strong> identifica a los años y <strong>divyear</strong> es el año en que se introdujo la legislación del divorcio unilateral. La última fila del código crea el indicador de tratamiento <strong>unilaterial</strong>, que toma el valor de 1 para los estados tratados en los periodos post tratamiento.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>wd <span class="ot">&lt;-</span> divorce <span class="sc">%&gt;%</span> </span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">filter</span>(year<span class="sc">&gt;=</span><span class="dv">1964</span> <span class="sc">&amp;</span> year<span class="sc">&lt;=</span><span class="dv">1996</span> <span class="sc">&amp;</span> sex<span class="sc">==</span><span class="dv">2</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">mutate</span>(<span class="at">suicide_rate=</span>suicide<span class="sc">*</span><span class="dv">1000000</span><span class="sc">/</span>(stpop<span class="sc">*</span>fshare),</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>   <span class="at">year=</span><span class="fu">as.numeric</span>(year),</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>   <span class="at">divyear =</span> <span class="fu">ifelse</span>(divyear<span class="sc">&gt;</span><span class="dv">1996</span>, <span class="cn">Inf</span>, divyear),</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>   <span class="at">unilateral=</span><span class="fu">ifelse</span>(year<span class="sc">&gt;</span>divyear, <span class="dv">1</span>, <span class="dv">0</span>))</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ol type="a">
<li><p>[5 puntos] Presente una tabla donde muestre el número de estados que es tratado en cada periodo del panel. ¿Cuántos estados son nunca tratados? ¿Cuántos estados son siempre tratados?</p>
<p><em>Si hacemos un tabulado de <strong>divyear</strong> para un año fijo, notamos cuántos estados se vuelven tratados en cada año. Solo 5 estados son nunca tratados. Por otro lado, como el panel comienza en 1964 y hay 9 estados tratados en 1950, estos 9 estados son siempre tratados.</em></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(<span class="fu">filter</span>(wd, year<span class="sc">==</span><span class="dv">1996</span>)<span class="sc">$</span>divyear)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
1950 1969 1970 1971 1972 1973 1974 1975 1976 1977 1980 1984 1985  Inf 
   9    2    2    7    3   11    3    2    1    3    1    1    1    5 </code></pre>
</div>
</div></li>
<li><p>[5 puntos] Como punto de partida, estime el efecto del tratamiento sobre <strong>suicide_rate</strong> usando efectos fijos por estado y año (TWFE) y empleando una librería específica para efectos fijos, como <em>felm</em>. Tome en cuenta la agrupación de los errores. Interprete sus resultados.</p>
<p><em>Usando felm podemos incorporar ya el nivel de agrupación de los errores:</em></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(<span class="fu">felm</span>(suicide_rate <span class="sc">~</span> unilateral <span class="sc">|</span> st <span class="sc">+</span> year <span class="sc">|</span> <span class="dv">0</span> <span class="sc">|</span> st,</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>              <span class="at">data =</span> wd))</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
   felm(formula = suicide_rate ~ unilateral | st + year | 0 | st,      data = wd) 

Residuals:
    Min      1Q  Median      3Q     Max 
-37.517  -6.157  -0.141   5.577  57.004 

Coefficients:
           Estimate Cluster s.e. t value Pr(&gt;|t|)  
unilateral   -3.777        2.201  -1.716   0.0923 .
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 10.85 on 1599 degrees of freedom
Multiple R-squared(full model): 0.6844   Adjusted R-squared: 0.668 
Multiple R-squared(proj model): 0.007963   Adjusted R-squared: -0.04353 
F-statistic(full model, *iid*):41.77 on 83 and 1599 DF, p-value: &lt; 2.2e-16 
F-statistic(proj model): 2.945 on 1 and 50 DF, p-value: 0.09231 </code></pre>
</div>
</div></li>
<li><p>[5 puntos] Compruebe que puede obtener el mismo resultado con una regresión lineal usando el paquete <em>lm</em> e incluyendo, además de la variable de tratamiento, dummies de estado y de año.</p>
<p><em>Estimamos con dummies:</em></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(m1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(suicide_rate <span class="sc">~</span> unilateral <span class="sc">+</span> <span class="fu">factor</span>(st) <span class="sc">+</span> <span class="fu">factor</span>(year),</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>              <span class="at">data =</span> wd))<span class="sc">$</span>coef[<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>,<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>]</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>             Estimate Std. Error   t value
(Intercept) 56.732642   2.468251 22.984953
unilateral  -3.776552   1.054148 -3.582562</code></pre>
</div>
</div>
<p><em>Luego estimamos errores agrupados:</em></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="fu">modelsummary</span>(<span class="fu">list</span>(m1),</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>             <span class="at">output =</span> <span class="st">'gt'</span>,</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>             <span class="at">vcov=</span>clubSandwich<span class="sc">::</span><span class="fu">vcovCR</span>(m1, <span class="at">type=</span><span class="st">'CR1'</span>, <span class="at">cluster=</span>wd<span class="sc">$</span>st),</span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>             <span class="at">coef_map =</span> <span class="st">"unilateral"</span>,</span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>             <span class="at">gof_map =</span> <span class="st">"nobs"</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="soupsnuwwb" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#soupsnuwwb table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#soupsnuwwb thead, #soupsnuwwb tbody, #soupsnuwwb tfoot, #soupsnuwwb tr, #soupsnuwwb td, #soupsnuwwb th {
  border-style: none;
}

#soupsnuwwb p {
  margin: 0;
  padding: 0;
}

#soupsnuwwb .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#soupsnuwwb .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#soupsnuwwb .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#soupsnuwwb .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#soupsnuwwb .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#soupsnuwwb .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#soupsnuwwb .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#soupsnuwwb .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#soupsnuwwb .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#soupsnuwwb .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#soupsnuwwb .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#soupsnuwwb .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#soupsnuwwb .gt_spanner_row {
  border-bottom-style: hidden;
}

#soupsnuwwb .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#soupsnuwwb .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#soupsnuwwb .gt_from_md > :first-child {
  margin-top: 0;
}

#soupsnuwwb .gt_from_md > :last-child {
  margin-bottom: 0;
}

#soupsnuwwb .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#soupsnuwwb .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#soupsnuwwb .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#soupsnuwwb .gt_row_group_first td {
  border-top-width: 2px;
}

#soupsnuwwb .gt_row_group_first th {
  border-top-width: 2px;
}

#soupsnuwwb .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#soupsnuwwb .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#soupsnuwwb .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#soupsnuwwb .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#soupsnuwwb .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#soupsnuwwb .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#soupsnuwwb .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#soupsnuwwb .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#soupsnuwwb .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#soupsnuwwb .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#soupsnuwwb .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#soupsnuwwb .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#soupsnuwwb .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#soupsnuwwb .gt_left {
  text-align: left;
}

#soupsnuwwb .gt_center {
  text-align: center;
}

#soupsnuwwb .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#soupsnuwwb .gt_font_normal {
  font-weight: normal;
}

#soupsnuwwb .gt_font_bold {
  font-weight: bold;
}

#soupsnuwwb .gt_font_italic {
  font-style: italic;
}

#soupsnuwwb .gt_super {
  font-size: 65%;
}

#soupsnuwwb .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#soupsnuwwb .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#soupsnuwwb .gt_indent_1 {
  text-indent: 5px;
}

#soupsnuwwb .gt_indent_2 {
  text-indent: 10px;
}

#soupsnuwwb .gt_indent_3 {
  text-indent: 15px;
}

#soupsnuwwb .gt_indent_4 {
  text-indent: 20px;
}

#soupsnuwwb .gt_indent_5 {
  text-indent: 25px;
}

#soupsnuwwb .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#soupsnuwwb div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>

<table class="gt_table caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
<thead>
<tr class="gt_col_headings header">
<th id="a-" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" scope="col"></th>
<th id="a(1)" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" scope="col">(1)</th>
</tr>
</thead>
<tbody class="gt_table_body">
<tr class="odd">
<td class="gt_row gt_left" headers=" ">unilateral</td>
<td class="gt_row gt_center" headers="(1)">-3.777</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers=" " style="border-bottom-width: 1px; border-bottom-style: solid; border-bottom-color: #000000"></td>
<td class="gt_row gt_center" headers="(1)" style="border-bottom-width: 1px; border-bottom-style: solid; border-bottom-color: #000000">(2.200)</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers=" ">Num.Obs.</td>
<td class="gt_row gt_center" headers="(1)">1683</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<p><em>Obtenemos los mismos coeficientes. Aquí también podrán volver a comprobar la importancia de usar errores agrupados. El error agrupado es más de dos veces más grande que el error clásico.</em></p></li>
<li><p>[10 puntos] Ahora muestre que podemos obtener el coeficiente de TWFE a partir de una regresión bivariada entre la tasa de suicidios y <strong>unilateral</strong>, una vez <em>purgada</em> por efectos fijos. Para ello, primero estime una regresión de <strong>unilateral</strong> en función de los efectos fijos. Obtenga la predicción y luego defina una nueva variable igual a la diferencia entre <strong>unilateral</strong> y la predicción que acaba de obtener. Finalmente, obtenga el coeficiente de TWFE con una regresión de la tasa de suicidios en función de la diferencia antes definida.</p>
<p><em>Corremos la primera regresión para purgar los efectos fijos:</em></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>d1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(unilateral <span class="sc">~</span> <span class="fu">factor</span>(st) <span class="sc">+</span> <span class="fu">factor</span>(year),</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>              <span class="at">data =</span> wd)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><em>Definimos la nueva variable:</em></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>wd <span class="ot">&lt;-</span> wd <span class="sc">%&gt;%</span> </span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">unilateral_hat =</span> unilateral<span class="sc">-</span><span class="fu">predict</span>(d1))</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><em>Y finalmente estimamos:</em></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(m2 <span class="ot">&lt;-</span> <span class="fu">lm</span>(suicide_rate <span class="sc">~</span> unilateral_hat,</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>              <span class="at">data =</span> wd))<span class="sc">$</span>coef[<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>,<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>]</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                Estimate Std. Error    t value
(Intercept)    54.422503  0.4585884 118.673960
unilateral_hat -3.776552  1.8276582  -2.066334</code></pre>
</div>
</div>
<p><em>Obtenemos el mismo coeficiente. Frisch–Waugh–Lovell tenían razón.</em></p></li>
<li><p>[10 puntos] Realice la descomposición de Goodman-Bacon (2021). Construya un gráfico donde muestre en el eje <span class="math inline">\(x\)</span> el peso otorgado a cada comparación 2x2 que el estimador de TWFE realiza mecánicamente y en el eje <span class="math inline">\(y\)</span> el efecto estimado correspondiente a cada comparación. Interprete el gráfico obtenido.</p>
<p><em>Como vimos en laboratorio, la descomposición de Bacon se puede obtener con la función bacon:</em></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Goodman-Bacon decomposition</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>df_bacon <span class="ot">&lt;-</span> <span class="fu">bacon</span>(suicide_rate <span class="sc">~</span> unilateral,</span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>                  <span class="at">data =</span> wd,</span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>                  <span class="at">id_var =</span> <span class="st">"st"</span>,</span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>                  <span class="at">time_var =</span> <span class="st">"year"</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                      type  weight  avg_est
1 Earlier vs Later Treated 0.11558  0.13489
2  Later vs Always Treated 0.41990 -6.95245
3 Later vs Earlier Treated 0.23125  2.33743
4     Treated vs Untreated 0.23328 -6.05881</code></pre>
</div>
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>coef_bacon <span class="ot">&lt;-</span> <span class="fu">sum</span>(df_bacon<span class="sc">$</span>estimate <span class="sc">*</span> df_bacon<span class="sc">$</span>weight)</span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">"Suma ponderada de la descomposición ="</span>, <span class="fu">round</span>(coef_bacon, <span class="dv">4</span>)))</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Suma ponderada de la descomposición = -3.7766"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>twfe <span class="ot">&lt;-</span> <span class="fu">felm</span>(suicide_rate <span class="sc">~</span> unilateral <span class="sc">|</span> st <span class="sc">+</span> year <span class="sc">|</span> <span class="dv">0</span> <span class="sc">|</span> st,</span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>              <span class="at">data =</span> wd)</span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a><span class="co">#Gráfico----</span></span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a>df_bacon <span class="sc">%&gt;%</span> </span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span>weight,</span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a>             <span class="at">y=</span>estimate,</span>
<span id="cb17-8"><a href="#cb17-8" aria-hidden="true" tabindex="-1"></a>             <span class="at">shape=</span>type)) <span class="sc">+</span></span>
<span id="cb17-9"><a href="#cb17-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb17-10"><a href="#cb17-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="fu">round</span>(twfe<span class="sc">$</span>coefficients, <span class="dv">4</span>))</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="tarea-3-respuestas_files/figure-html/unnamed-chunk-9-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p><em>Las comparaciones que más pesan en el estimador de efectos fijos son las de estados tratados con los que siempre estuvieron tratados en el panel, recibiendo dos de esas comparaciones alrededor de 13 y el 7% del peso (los dos triángulos más hacia la derecha). otra comparación que recibe alrededor de 7% del peso es la de los tratados con los nunca tratados (cruz más hacia la derecha). En total, las comparaciones con los estados que iniciaron siendo tratados se llevan el 42% del peso. Las comparaciones entre los tratados tarde y los tratados temprano también reciben un peso alto de 23%.</em></p></li>
<li><p>[10 puntos] Implemente el estimador de Callaway &amp; Sant’Anna (2021) para estimar los efectos del tratamiento específicos para cada cohorte, usando el paquete <em>did</em>. Utilice como grupo de comparación los estados <em>no tratados aún</em>. La columna <strong>stid</strong> es un identificador numérico de los estados (lo requerirá cuando use <em>att_gt</em> del paquete <em>did</em>).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>atts_nyt <span class="ot">&lt;-</span> <span class="fu">att_gt</span>(<span class="at">yname =</span> <span class="st">"suicide_rate"</span>,</span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>                      <span class="at">tname =</span> <span class="st">"year"</span>,</span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>                      <span class="at">idname =</span> <span class="st">"stid"</span>,</span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a>                      <span class="at">gname =</span> <span class="st">"divyear"</span>,</span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a>                      <span class="at">data =</span> wd,</span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a>                      <span class="at">control_group =</span> <span class="st">"notyettreated"</span>,</span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true" tabindex="-1"></a>                      <span class="at">est_method =</span> <span class="st">'reg'</span>,</span>
<span id="cb18-8"><a href="#cb18-8" aria-hidden="true" tabindex="-1"></a>                      <span class="at">bstrap =</span> <span class="cn">TRUE</span>,</span>
<span id="cb18-9"><a href="#cb18-9" aria-hidden="true" tabindex="-1"></a>                      <span class="at">biters =</span> <span class="dv">1000</span>,</span>
<span id="cb18-10"><a href="#cb18-10" aria-hidden="true" tabindex="-1"></a>                      <span class="at">print_details =</span> <span class="cn">FALSE</span>,</span>
<span id="cb18-11"><a href="#cb18-11" aria-hidden="true" tabindex="-1"></a>                      <span class="at">panel =</span> <span class="cn">TRUE</span>)</span>
<span id="cb18-12"><a href="#cb18-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-13"><a href="#cb18-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-14"><a href="#cb18-14" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(atts_nyt)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
att_gt(yname = "suicide_rate", tname = "year", idname = "stid", 
    gname = "divyear", data = wd, panel = TRUE, control_group = "notyettreated", 
    bstrap = TRUE, biters = 1000, est_method = "reg", print_details = FALSE)

Reference: Callaway, Brantly and Pedro H.C. Sant'Anna.  "Difference-in-Differences with Multiple Time Periods." Journal of Econometrics, Vol. 225, No. 2, pp. 200-230, 2021. &lt;https://doi.org/10.1016/j.jeconom.2020.12.001&gt;, &lt;https://arxiv.org/abs/1803.09015&gt; 

Group-Time Average Treatment Effects:
 Group Time ATT(g,t) Std. Error [95% Simult.  Conf. Band]  
  1969 1965  -1.9053     9.0889      -28.5508     24.7402  
  1969 1966   4.5124    12.9286      -33.3897     42.4146  
  1969 1967   0.5622     5.3185      -15.0298     16.1543  
  1969 1968   5.1789     2.9571       -3.4902     13.8481  
  1969 1969  -0.7447     6.1882      -18.8864     17.3971  
  1969 1970 -10.2717    10.4641      -40.9487     20.4052  
  1969 1971 -12.3880     8.2786      -36.6580     11.8821  
  1969 1972  -4.1259     3.6406      -14.7989      6.5470  
  1969 1973   1.4524     7.4672      -20.4388     23.3435  
  1969 1974  -1.4022     5.3042      -16.9524     14.1480  
  1969 1975  -0.9265     4.5993      -14.4101     12.5570  
  1969 1976 -12.7344     6.4377      -31.6075      6.1388  
  1969 1977  -2.3415     9.6507      -30.6340     25.9509  
  1969 1978 -11.4247    16.4093      -59.5310     36.6816  
  1969 1979  -6.0427     8.4595      -30.8430     18.7576  
  1969 1980  -7.9345     5.3785      -23.7024      7.8333  
  1969 1981  -1.7430    10.1491      -31.4966     28.0106  
  1969 1982  -6.7020     9.7634      -35.3250     21.9209  
  1969 1983   4.7154     9.9951      -24.5867     34.0175  
  1969 1984  -9.5175    13.6458      -49.5223     30.4872  
  1969 1985   5.9598    17.2201      -44.5235     56.4430  
  1969 1986  -8.5962    11.3904      -41.9887     24.7963  
  1969 1987  -8.6897     8.1156      -32.4818     15.1024  
  1969 1988 -11.9815     8.3996      -36.6063     12.6433  
  1969 1989  -5.9781    14.9263      -49.7369     37.7807  
  1969 1990  -7.7327    11.7102      -42.0629     26.5976  
  1969 1991 -14.7659    11.1181      -47.3603     17.8285  
  1969 1992  -6.6956     6.5059      -25.7685     12.3773  
  1969 1993   0.5290    12.9396      -37.4055     38.4634  
  1969 1994  -6.1575    15.9269      -52.8495     40.5344  
  1969 1995  -6.7870    17.1890      -57.1791     43.6052  
  1969 1996   3.0338    15.7388      -43.1067     49.1744  
  1970 1965   2.4919     3.3093       -7.2098     12.1936  
  1970 1966   1.8500     3.3448       -7.9557     11.6557  
  1970 1967  -2.0438     4.5301      -15.3243     11.2367  
  1970 1968  -3.7538    10.2845      -33.9043     26.3967  
  1970 1969   9.0725     3.9103       -2.3911     20.5361  
  1970 1970   0.3548     5.2061      -14.9075     15.6172  
  1970 1971  -1.9698     3.6152      -12.5682      8.6286  
  1970 1972  -1.4067     6.7289      -21.1334     18.3200  
  1970 1973 -11.2801     3.9404      -22.8319      0.2718  
  1970 1974 -11.1775     3.6670      -21.9277     -0.4272 *
  1970 1975 -12.0330     6.4145      -30.8381      6.7721  
  1970 1976 -17.7592     7.0762      -38.5043      2.9858  
  1970 1977 -16.3994     5.0041      -31.0696     -1.7292 *
  1970 1978 -29.1877    15.1555      -73.6184     15.2431  
  1970 1979 -26.8802    12.8838      -64.6511     10.8907  
  1970 1980 -39.5660    14.0390      -80.7235      1.5916  
  1970 1981 -30.0122    13.0100      -68.1530      8.1286  
  1970 1982 -36.1714    11.1099      -68.7418     -3.6010 *
  1970 1983 -31.0969    24.3483     -102.4774     40.2836  
  1970 1984 -31.4749    27.3109     -111.5408     48.5910  
  1970 1985 -30.6346    20.8045      -91.6260     30.3568  
  1970 1986 -37.0754    21.7397     -100.8087     26.6578  
  1970 1987 -37.6630    34.9823     -140.2188     64.8927  
  1970 1988 -43.0563    31.1849     -134.4794     48.3668  
  1970 1989 -45.1314    23.4421     -113.8553     23.5925  
  1970 1990 -43.1765    33.3782     -141.0296     54.6766  
  1970 1991 -49.9116    33.4162     -147.8760     48.0528  
  1970 1992 -50.9515    20.8656     -112.1221     10.2191  
  1970 1993 -44.5526    33.0711     -141.5055     52.4003  
  1970 1994 -51.5405    17.7308     -103.5209      0.4398  
  1970 1995 -48.4108    28.0247     -130.5694     33.7479  
  1970 1996 -48.0618    27.1394     -127.6250     31.5015  
  1971 1965  -2.2110     3.7136      -13.0980      8.6760  
  1971 1966  -5.9450     3.5958      -16.4866      4.5966  
  1971 1967   6.1535     3.6139       -4.4411     16.7481  
  1971 1968   5.3039     3.7756       -5.7648     16.3727  
  1971 1969  -4.8826     3.9230      -16.3834      6.6182  
  1971 1970   0.5878     5.5990      -15.8266     17.0022  
  1971 1971  -7.5805     6.2546      -25.9169     10.7559  
  1971 1972 -11.4260     7.7169      -34.0492     11.1972  
  1971 1973  -5.8221     8.0982      -29.5631     17.9189  
  1971 1974   5.7926     5.0644       -9.0545     20.6397  
  1971 1975   0.0590     5.1853      -15.1426     15.2606  
  1971 1976  -0.7920     7.8759      -23.8812     22.2973  
  1971 1977   0.5899     8.4082      -24.0598     25.2397  
  1971 1978  -9.5946     9.4111      -37.1847     17.9955  
  1971 1979  -8.8180     5.4389      -24.7630      7.1271  
  1971 1980 -15.0039     6.3306      -33.5629      3.5551  
  1971 1981  -6.0810     8.0665      -29.7292     17.5672  
  1971 1982 -15.5575     8.5472      -40.6148      9.4997  
  1971 1983  -6.7973     5.4696      -22.8322      9.2376  
  1971 1984  -8.1090     6.9975      -28.6232     12.4052  
  1971 1985  -9.3683     8.5016      -34.2919     15.5554  
  1971 1986 -16.9260     7.1736      -37.9564      4.1045  
  1971 1987 -12.9962    10.5993      -44.0697     18.0773  
  1971 1988 -14.6487     8.1469      -38.5326      9.2351  
  1971 1989 -18.7126     8.5745      -43.8500      6.4248  
  1971 1990 -17.6198     7.0084      -38.1659      2.9263  
  1971 1991 -17.2789     8.7983      -43.0725      8.5148  
  1971 1992 -22.1825     9.7693      -50.8225      6.4576  
  1971 1993  -9.1278     9.0037      -35.5234     17.2678  
  1971 1994 -13.7091     9.0874      -40.3501     12.9319  
  1971 1995 -15.3270     7.2730      -36.6490      5.9949  
  1971 1996 -11.2124     9.3772      -38.7032     16.2783  
  1972 1965   1.9641     1.9547       -3.7664      7.6945  
  1972 1966   2.3826     5.8433      -14.7478     19.5130  
  1972 1967  -3.8865     5.6337      -20.4027     12.6296  
  1972 1968   7.6954     2.8557       -0.6764     16.0672  
  1972 1969  -8.7084     2.9440      -17.3392     -0.0776 *
  1972 1970   0.1004     2.5242       -7.2997      7.5006  
  1972 1971   1.1463     3.4146       -8.8640     11.1566  
  1972 1972  -4.8115     4.7721      -18.8015      9.1785  
  1972 1973  -2.3073     6.3048      -20.7906     16.1761  
  1972 1974   0.7950     4.9995      -13.8619     15.4518  
  1972 1975  -2.8930     4.6811      -16.6162     10.8303  
  1972 1976  -2.9838    10.0370      -32.4086     26.4411  
  1972 1977   2.8759     5.6990      -13.8315     19.5834  
  1972 1978 -13.9499     7.2452      -35.1904      7.2906  
  1972 1979  -4.7118     8.7814      -30.4558     21.0322  
  1972 1980  -9.9424     6.9677      -30.3693     10.4844  
  1972 1981   0.7622     6.5679      -18.4926     20.0171  
  1972 1982  -5.7949     7.4025      -27.4965     15.9067  
  1972 1983  -2.5286     6.7292      -22.2563     17.1991  
  1972 1984  -5.7192     7.6822      -28.2408     16.8024  
  1972 1985  -8.5492     7.6982      -31.1177     14.0192  
  1972 1986  -3.2909     6.1695      -21.3777     14.7960  
  1972 1987 -14.5853     7.5095      -36.6004      7.4298  
  1972 1988 -12.6795     6.5746      -31.9539      6.5950  
  1972 1989 -10.9845     7.1656      -31.9915     10.0225  
  1972 1990  -7.7794     6.8801      -27.9496     12.3907  
  1972 1991 -13.7033     5.1800      -28.8891      1.4826  
  1972 1992 -11.0100     8.5868      -36.1836     14.1636  
  1972 1993 -17.3770     7.0511      -38.0483      3.2943  
  1972 1994 -16.6543     7.5842      -38.8886      5.5799  
  1972 1995 -16.0626     6.5675      -35.3163      3.1910  
  1972 1996 -13.6292     5.0507      -28.4360      1.1777  
  1973 1965  -1.6544     3.7100      -12.5308      9.2220  
  1973 1966  -3.5308     4.0406      -15.3763      8.3147  
  1973 1967   5.5388     5.9532      -11.9138     22.9915  
  1973 1968  -4.1286     5.3371      -19.7750     11.5178  
  1973 1969   1.9470     4.0212       -9.8418     13.7358  
  1973 1970   0.3836     5.0401      -14.3923     15.1595  
  1973 1971  -0.4064     6.5122      -19.4980     18.6852  
  1973 1972  -0.7103     6.1497      -18.7390     17.3184  
  1973 1973   9.0122     6.6480      -10.4775     28.5018  
  1973 1974   7.0826     6.3530      -11.5420     25.7073  
  1973 1975   8.7932     9.7807      -19.8804     37.4669  
  1973 1976   5.5815     6.8200      -14.4123     25.5753  
  1973 1977   9.2638     7.3384      -12.2499     30.7775  
  1973 1978  -2.8479     7.9609      -26.1866     20.4907  
  1973 1979   3.5441     7.3351      -17.9598     25.0481  
  1973 1980  -3.7998     8.8638      -29.7854     22.1859  
  1973 1981   3.7874     8.4246      -20.9105     28.4852  
  1973 1982  -2.3342     9.5381      -30.2966     25.6282  
  1973 1983   0.3746     6.9881      -20.1120     20.8612  
  1973 1984  -4.0602     9.0778      -30.6731     22.5527  
  1973 1985  -3.3503     7.3580      -24.9215     18.2208  
  1973 1986  -9.9416     4.4502      -22.9879      3.1047  
  1973 1987 -10.5611     8.9273      -36.7328     15.6106  
  1973 1988 -13.3770     8.8640      -39.3630     12.6090  
  1973 1989  -9.7072     7.4702      -31.6071     12.1927  
  1973 1990 -12.5464     6.3056      -31.0322      5.9393  
  1973 1991 -15.9396     7.2455      -37.1808      5.3016  
  1973 1992 -17.9985     7.1455      -38.9466      2.9496  
  1973 1993 -13.8426     7.4889      -35.7974      8.1122  
  1973 1994  -9.0985     5.8794      -26.3349      8.1380  
  1973 1995 -12.4104     3.6501      -23.1111     -1.7098 *
  1973 1996 -14.4985     5.5196      -30.6801      1.6831  
  1974 1965  -3.4980     4.6207      -17.0442     10.0482  
  1974 1966   4.0405     5.8943      -13.2394     21.3205  
  1974 1967  -2.4469     2.5574       -9.9442      5.0505  
  1974 1968  -4.1701     5.5376      -20.4044     12.0641  
  1974 1969   3.0794     1.9576       -2.6596      8.8184  
  1974 1970   3.9844     2.8253       -4.2983     12.2672  
  1974 1971  -7.0304     3.1550      -16.2797      2.2189  
  1974 1972   6.3385     3.6622       -4.3978     17.0748  
  1974 1973   0.5656     5.4090      -15.2917     16.4230  
  1974 1974  -2.4409     4.1236      -14.5299      9.6481  
  1974 1975   1.3647     5.1856      -13.8376     16.5669  
  1974 1976  -3.5756     5.9381      -20.9839     13.8327  
  1974 1977  -4.0728     5.5266      -20.2749     12.1293  
  1974 1978  -8.9231     5.3254      -24.5353      6.6890  
  1974 1979  -1.7408     6.1037      -19.6346     16.1530  
  1974 1980  -9.7770     5.2936      -25.2961      5.7421  
  1974 1981  -2.8322     6.1242      -20.7861     15.1217  
  1974 1982  -7.4517     4.7882      -21.4890      6.5857  
  1974 1983  -4.3400     7.4412      -26.1551     17.4750  
  1974 1984  -7.8279     6.8923      -28.0338     12.3779  
  1974 1985   0.9048    10.9594      -31.2244     33.0340  
  1974 1986  -3.4953     9.4959      -31.3339     24.3432  
  1974 1987  -9.3045     8.5961      -34.5053     15.8963  
  1974 1988  -9.0434     8.7834      -34.7933     16.7064  
  1974 1989  -6.4758    10.9764      -38.6548     25.7032  
  1974 1990  -7.6369     8.8825      -33.6774     18.4036  
  1974 1991 -14.7133     8.1135      -38.4993      9.0727  
  1974 1992 -14.7711     8.1981      -38.8050      9.2629  
  1974 1993 -11.2274     9.4047      -38.7988     16.3439  
  1974 1994 -14.4350    11.1604      -47.1535     18.2835  
  1974 1995 -13.4194    10.4136      -43.9484     17.1097  
  1974 1996 -14.8017    10.8290      -46.5484     16.9450  
  1975 1965  18.6039    14.9050      -25.0925     62.3002  
  1975 1966  -3.3872     3.6766      -14.1657      7.3912  
  1975 1967  -2.4321     2.0082       -8.3194      3.4552  
  1975 1968   7.3667     5.5087       -8.7829     23.5164  
  1975 1969  -4.2480     7.0359      -24.8747     16.3788  
  1975 1970 -11.4912     9.1162      -38.2167     15.2344  
  1975 1971   5.6632     9.5797      -22.4211     33.7474  
  1975 1972 -15.6310     8.5956      -40.8301      9.5682  
  1975 1973  16.2449     7.2332       -4.9602     37.4500  
  1975 1974  -0.4082     6.6191      -19.8132     18.9967  
  1975 1975  -2.3510     2.9086      -10.8780      6.1761  
  1975 1976  -2.3824     5.3323      -18.0148     13.2499  
  1975 1977  -4.1345    10.2039      -34.0488     25.7799  
  1975 1978  -7.0822     6.9213      -27.3729     13.2086  
  1975 1979 -12.0112    16.0637      -59.1043     35.0819  
  1975 1980 -10.7602     5.6805      -27.4135      5.8930  
  1975 1981  -7.1236     5.1604      -22.2521      8.0049  
  1975 1982 -10.5685     6.9861      -31.0492      9.9122  
  1975 1983  -9.0308     6.2393      -27.3221      9.2606  
  1975 1984   9.8022     6.2868       -8.6284     28.2327  
  1975 1985  -5.6163    10.1864      -35.4793     24.2466  
  1975 1986  -5.2183     5.2469      -20.6003     10.1636  
  1975 1987  -0.8638     4.6609      -14.5279     12.8004  
  1975 1988 -15.3668    12.0485      -50.6888     19.9553  
  1975 1989  -5.4933     6.3252      -24.0365     13.0498  
  1975 1990   8.5067     6.1229       -9.4436     26.4569  
  1975 1991   0.7631     6.1896      -17.3825     18.9087  
  1975 1992  -4.2255     6.0213      -21.8778     13.4268  
  1975 1993   1.1200     2.5499       -6.3555      8.5954  
  1975 1994  -8.3655     8.0590      -31.9918     15.2608  
  1975 1995   1.8041     4.2319      -10.6023     14.2105  
  1975 1996  -6.9207     5.6637      -23.5246      9.6832  
  1976 1965 -11.0522     1.6186      -15.7974     -6.3069 *
  1976 1966   0.1018     1.9794       -5.7010      5.9046  
  1976 1967  -5.9143     2.0263      -11.8547      0.0260  
  1976 1968  -1.6479     1.9560       -7.3821      4.0863  
  1976 1969  -6.6407     1.7644      -11.8132     -1.4682 *
  1976 1970   8.5784     2.0806        2.4787     14.6781 *
  1976 1971   4.0973     2.3823       -2.8868     11.0814  
  1976 1972  -0.9903     2.7862       -9.1584      7.1778  
  1976 1973 -20.1263     3.8489      -31.4099     -8.8427 *
  1976 1974  39.6133     2.5589       32.1115     47.1151 *
  1976 1975  -3.5747     2.8810      -12.0209      4.8714  
  1976 1976   3.7698     5.1674      -11.3793     18.9188  
  1976 1977  33.5942     4.9446       19.0983     48.0902 *
  1976 1978  -3.1195     2.2787       -9.8000      3.5609  
  1976 1979   1.3342     7.2751      -19.9937     22.6621  
  1976 1980 -10.4124     3.6259      -21.0422      0.2173  
  1976 1981 -10.4368     5.7455      -27.2804      6.4069  
  1976 1982 -12.4922     3.2219      -21.9376     -3.0468 *
  1976 1983 -15.8081     6.3729      -34.4911      2.8749  
  1976 1984 -20.6870     4.3502      -33.4401     -7.9339 *
  1976 1985  -0.2053    11.6139      -34.2532     33.8425  
  1976 1986 -27.7992     8.3181      -52.1848     -3.4135 *
  1976 1987  -9.9985     5.2150      -25.2871      5.2902  
  1976 1988 -22.8540     6.2365      -41.1374     -4.5707 *
  1976 1989 -14.3020     6.6385      -33.7637      5.1597  
  1976 1990 -16.7275     4.8656      -30.9916     -2.4634 *
  1976 1991 -29.9838     5.5425      -46.2325    -13.7352 *
  1976 1992 -35.9431     6.3141      -54.4538    -17.4323 *
  1976 1993 -33.5630     6.2298      -51.8267    -15.2993 *
  1976 1994 -19.1785    10.5829      -50.2038     11.8467  
  1976 1995 -18.8943     9.0197      -45.3368      7.5482  
  1976 1996 -20.0712     8.0000      -43.5243      3.3819  
  1977 1965   6.8982    10.0381      -22.5300     36.3265  
  1977 1966 -11.1214     6.8086      -31.0819      8.8391  
  1977 1967  10.8566     5.2161       -4.4352     26.1485  
  1977 1968 -11.0425    11.4075      -44.4853     22.4003  
  1977 1969  10.1932    10.8973      -21.7538     42.1401  
  1977 1970   2.9004     6.5444      -16.2854     22.0862  
  1977 1971   3.0530     8.8036      -22.7560     28.8620  
  1977 1972  -0.6535     9.5107      -28.5355     27.2285  
  1977 1973   3.1405     8.2683      -21.0992     27.3802  
  1977 1974 -14.4506     6.0197      -32.0982      3.1970  
  1977 1975  -0.1240     5.2199      -15.4268     15.1788  
  1977 1976   5.5263    15.7634      -40.6864     51.7389  
  1977 1977  -0.1462    14.3858      -42.3202     42.0278  
  1977 1978 -17.4422    16.3325      -65.3233     30.4389  
  1977 1979  -7.6652    23.4931      -76.5386     61.2082  
  1977 1980 -12.0752    21.4781      -75.0414     50.8910  
  1977 1981 -11.8110    18.4973      -66.0385     42.4166  
  1977 1982 -18.5556    14.2687      -60.3863     23.2752  
  1977 1983   4.2551    27.1428      -75.3180     83.8281  
  1977 1984  -3.0226    21.3111      -65.4992     59.4541  
  1977 1985 -14.8995    19.4492      -71.9176     42.1185  
  1977 1986 -12.3230    13.1128      -50.7650     26.1191  
  1977 1987 -23.6769    24.0752      -94.2569     46.9030  
  1977 1988 -25.5547    20.7414      -86.3611     35.2518  
  1977 1989  -9.2602    28.4784      -92.7488     74.2283  
  1977 1990 -13.7369    27.2222      -93.5429     66.0691  
  1977 1991 -25.9731    22.5226      -92.0016     40.0553  
  1977 1992 -29.9220    20.1157      -88.8943     29.0503  
  1977 1993 -14.9531    24.3092      -86.2192     56.3131  
  1977 1994 -11.6033    30.7957     -101.8854     78.6787  
  1977 1995 -29.0098    19.4844      -86.1312     28.1116  
  1977 1996 -16.0590    19.9326      -74.4943     42.3763  
  1980 1965  -4.7817     1.6371       -9.5812      0.0178  
  1980 1966  -2.0295     1.9755       -7.8209      3.7619  
  1980 1967   0.2462     2.0099       -5.6462      6.1387  
  1980 1968   4.9725     1.9410       -0.7177     10.6627  
  1980 1969  -5.6981     1.7697      -10.8861     -0.5101 *
  1980 1970   7.6920     2.0984        1.5403     13.8437 *
  1980 1971  -9.5134     2.3702      -16.4619     -2.5648 *
  1980 1972   5.9170     2.7390       -2.1128     13.9468  
  1980 1973  -3.6509     4.0840      -15.6239      8.3220  
  1980 1974   1.1846     4.3734      -11.6368     14.0059  
  1980 1975  -1.4249     2.8395       -9.7494      6.8996  
  1980 1976   1.5220     5.7117      -15.2226     18.2665  
  1980 1977  -1.8998     2.6719       -9.7328      5.9332  
  1980 1978  -6.1099     5.6158      -22.5734     10.3536  
  1980 1979   6.0177     7.9988      -17.4321     29.4675  
  1980 1980 -11.0694     5.0677      -25.9262      3.7873  
  1980 1981  -7.3267     2.5143      -14.6978      0.0444  
  1980 1982  -9.2663     9.4583      -36.9948     18.4623  
  1980 1983   1.6316     3.0719       -7.3742     10.6374  
  1980 1984  -2.4538     4.9605      -16.9963     12.0886  
  1980 1985   4.4467     5.4479      -11.5246     20.4180  
  1980 1986  -9.5981     6.5701      -28.8594      9.6631  
  1980 1987 -10.0537    11.0181      -42.3548     22.2474  
  1980 1988 -10.9789     7.4396      -32.7890     10.8313  
  1980 1989  -6.9527     5.4821      -23.0243      9.1190  
  1980 1990  -5.3312     5.6717      -21.9586     11.2963  
  1980 1991  -8.8820     8.2207      -32.9821     15.2181  
  1980 1992 -12.0023     8.8737      -38.0168     14.0123  
  1980 1993  -8.3192     6.2290      -26.5805      9.9421  
  1980 1994 -12.5474     6.2922      -30.9940      5.8992  
  1980 1995  -6.7308     8.1776      -30.7047     17.2431  
  1980 1996  -9.1678     6.3691      -27.8399      9.5042  
  1984 1965   2.2727     1.6118       -2.4525      6.9978  
  1984 1966  -1.6070     1.9842       -7.4239      4.2099  
  1984 1967  -1.8538     2.0146       -7.7599      4.0523  
  1984 1968  -1.3557     1.9634       -7.1117      4.4003  
  1984 1969   2.1619     1.7829       -3.0651      7.3889  
  1984 1970  -0.3449     2.1077       -6.5240      5.8341  
  1984 1971 -10.9305     2.3959      -17.9546     -3.9064 *
  1984 1972   5.8536     2.7597       -2.2370     13.9441  
  1984 1973  -1.9239     4.0956      -13.9308     10.0829  
  1984 1974  -7.1605     4.2188      -19.5286      5.2076  
  1984 1975  -1.6437     2.8376       -9.9624      6.6751  
  1984 1976   5.6685     5.6073      -10.7702     22.1071  
  1984 1977   3.2342     2.6461       -4.5234     10.9917  
  1984 1978  -7.3151     5.0024      -21.9805      7.3503  
  1984 1979   1.9466     7.9723      -21.4255     25.3187  
  1984 1980  -8.6205     5.6703      -25.2437      8.0028  
  1984 1981  10.4692     4.8613       -3.7825     24.7209  
  1984 1982  -5.4364     7.7234      -28.0788     17.2059  
  1984 1983  12.0264     8.2000      -12.0132     36.0661  
  1984 1984  -0.7730     2.7483       -8.8299      7.2839  
  1984 1985   4.0744     3.8064       -7.0846     15.2334  
  1984 1986  -8.0341     2.8724      -16.4550      0.3868  
  1984 1987 -10.4189     8.0305      -33.9614     13.1236  
  1984 1988  -7.8277     5.4597      -23.8335      8.1781  
  1984 1989  -9.2894     3.8762      -20.6531      2.0743  
  1984 1990  -6.2529     2.9419      -14.8777      2.3718  
  1984 1991 -10.1584     4.9176      -24.5751      4.2583  
  1984 1992 -11.4694     4.6630      -25.1397      2.2009  
  1984 1993  -9.2844     3.9688      -20.9196      2.3508  
  1984 1994 -14.6630     3.4313      -24.7225     -4.6035 *
  1984 1995 -12.5044     3.3329      -22.2753     -2.7336 *
  1984 1996 -10.2449     3.2047      -19.6399     -0.8498 *
  1985 1965  -4.3499     1.6341       -9.1405      0.4406  
  1985 1966  37.6989     1.7340       32.6154     42.7824 *
  1985 1967 -19.2838     2.0558      -25.3108    -13.2568 *
  1985 1968  -4.2545     1.9578       -9.9942      1.4852  
  1985 1969  10.5295     1.7397        5.4292     15.6298 *
  1985 1970   7.2143     2.1116        1.0239     13.4048 *
  1985 1971   6.9735     2.4429       -0.1882     14.1351  
  1985 1972   5.8781     2.7552       -2.1992     13.9553  
  1985 1973 -38.9329     3.0399      -47.8449    -30.0208 *
  1985 1974   8.7158     4.2704       -3.8036     21.2353  
  1985 1975  -7.1533     2.8321      -15.4559      1.1493  
  1985 1976  -0.8308     5.7041      -17.5531     15.8915  
  1985 1977  -2.2605     2.6289       -9.9676      5.4467  
  1985 1978   7.7405     5.6925       -8.9480     24.4290  
  1985 1979  -4.9814     8.3555      -29.4769     19.5140  
  1985 1980   2.9209     6.2508      -15.4043     21.2461  
  1985 1981  -4.4773     5.5351      -20.7043     11.7497  
  1985 1982  13.7629     8.3192      -10.6261     38.1519  
  1985 1983  -7.4210     9.1244      -34.1706     19.3286  
  1985 1984  -5.5493     3.0237      -14.4136      3.3150  
  1985 1985  11.4728     6.8301       -8.5505     31.4962  
  1985 1986  10.1715     3.6996       -0.6743     21.0174  
  1985 1987  17.5291     4.9075        3.1420     31.9162 *
  1985 1988  -9.6423     3.7230      -20.5567      1.2721  
  1985 1989  19.8229     5.3527        4.1306     35.5151 *
  1985 1990  26.2350     1.7402       21.1332     31.3367 *
  1985 1991   6.2209     3.3361       -3.5594     16.0012  
  1985 1992  18.3602     4.8122        4.2526     32.4677 *
  1985 1993  23.0343     2.8095       14.7978     31.2708 *
  1985 1994  15.2612     6.2622       -3.0973     33.6198  
  1985 1995  15.4633     4.9242        1.0274     29.8993 *
  1985 1996  26.5282     4.3495       13.7770     39.2795 *
---
Signif. codes: `*' confidence band does not cover 0

Control Group:  Not Yet Treated,  Anticipation Periods:  0
Estimation Method:  Outcome Regression</code></pre>
</div>
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggdid</span>(atts_nyt)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="tarea-3-respuestas_files/figure-html/unnamed-chunk-10-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div></li>
<li><p>[5 puntos] Reporte los resultados agregados obtenidos a partir del estimador Callaway &amp; Sant’Anna (2021), usando una agregación dinámica que muestre los efectos promedio para cada periodo antes y después del tratamiento. Grafique e interprete los resultados.</p>
<p><em>Graficamos:</em></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>agg.es <span class="ot">&lt;-</span> <span class="fu">aggte</span>(atts_nyt,</span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>                <span class="at">type =</span> <span class="st">"dynamic"</span>)</span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(agg.es)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
aggte(MP = atts_nyt, type = "dynamic")

Reference: Callaway, Brantly and Pedro H.C. Sant'Anna.  "Difference-in-Differences with Multiple Time Periods." Journal of Econometrics, Vol. 225, No. 2, pp. 200-230, 2021. &lt;https://doi.org/10.1016/j.jeconom.2020.12.001&gt;, &lt;https://arxiv.org/abs/1803.09015&gt; 


Overall summary of ATT's based on event-study/dynamic aggregation:  
    ATT    Std. Error     [ 95%  Conf. Int.]  
 -9.628        3.5511   -16.5879      -2.668 *


Dynamic Effects:
 Event time Estimate Std. Error [95% Simult.  Conf. Band]  
        -20  -4.3499     1.6448       -8.9417      0.2418  
        -19  19.9858    23.8562      -46.6143     86.5859  
        -18 -10.4454     6.8888      -29.6770      8.7862  
        -17  -3.0542     1.0787       -6.0655     -0.0428 *
        -16   4.5869     4.4303       -7.7813     16.9551  
        -15   1.5315     3.0506       -6.9849     10.0479  
        -14   1.5330     2.3862       -5.1285      8.1945  
        -13  -1.6021     4.1318      -13.1370      9.9329  
        -12  -1.2353     9.0619      -26.5338     24.0631  
        -11  -6.1889     4.7443      -19.4338      7.0559  
        -10   7.0286     5.2339       -7.5830     21.6403  
         -9  -5.6915     3.5200      -15.5183      4.1353  
         -8   1.1876     2.4177       -5.5621      7.9373  
         -7  -0.6219     1.9163       -5.9717      4.7279  
         -6   1.1581     2.7023       -6.3860      8.7022  
         -5  -2.9106     2.3261       -9.4046      3.5834  
         -4   2.9082     1.6592       -1.7240      7.5403  
         -3  -1.9822     2.6086       -9.2647      5.3004  
         -2   0.7311     2.5493       -6.3858      7.8479  
         -1   1.4763     2.5510       -5.6453      8.5979  
          0   0.5890     2.7149       -6.9902      8.1682  
          1  -1.2422     3.0484       -9.7526      7.2681  
          2  -0.3815     4.4314      -12.7529     11.9899  
          3  -0.4662     3.9355      -11.4531     10.5207  
          4  -0.3563     4.3790      -12.5812     11.8686  
          5  -3.4207     4.5605      -16.1524      9.3109  
          6  -2.4065     4.2214      -14.1915      9.3784  
          7  -6.4250     4.6126      -19.3022      6.4522  
          8  -5.8964     4.8727      -19.4997      7.7069  
          9  -6.3944     4.2504      -18.2603      5.4715  
         10  -7.7061     5.2999      -22.5021      7.0899  
         11  -8.8186     4.9795      -22.7200      5.0829  
         12  -7.2921     4.7156      -20.4568      5.8726  
         13 -11.1384     4.1090      -22.6098      0.3329  
         14 -11.1558     4.4016      -23.4439      1.1323  
         15 -14.8167     5.3362      -29.7139      0.0806  
         16 -11.6965     5.2053      -26.2283      2.8354  
         17 -14.3232     4.7924      -27.7023     -0.9440 *
         18 -17.1010     4.8748      -30.7102     -3.4919 *
         19 -17.4748     4.7997      -30.8744     -4.0751 *
         20 -14.9783     4.7937      -28.3609     -1.5957 *
         21 -15.8960     4.6693      -28.9315     -2.8605 *
         22 -15.2219     4.9797      -29.1239     -1.3198 *
         23 -16.2453     4.9390      -30.0335     -2.4570 *
         24 -17.8714     7.5073      -38.8298      3.0870  
         25 -17.0567     9.8107      -44.4456     10.3323  
         26 -27.4244    18.6516      -79.4947     24.6460  
         27   3.0338    13.1112      -33.5691     39.6367  
---
Signif. codes: `*' confidence band does not cover 0

Control Group:  Not Yet Treated,  Anticipation Periods:  0
Estimation Method:  Outcome Regression</code></pre>
</div>
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggdid</span>(agg.es)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="tarea-3-respuestas_files/figure-html/unnamed-chunk-11-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p><em>Se obtiene una reducción en la tasa de suicidios que es estadísticamente significativa a partir de 13 años después de la introducción de la legislación.</em></p></li>
<li><p>[5 puntos] Reporte los resultados agregados obtenidos a partir del estimador Callaway &amp; Sant’Anna (2021), usando una agregación or grupos que muestre los efectos promedio para cada cohorte del tratamiento. Grafique e interprete los resultados.</p>
<p><em>Graficamos:</em></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>agg.es <span class="ot">&lt;-</span> <span class="fu">aggte</span>(atts_nyt,</span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>                <span class="at">type =</span> <span class="st">"group"</span>)</span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(agg.es)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
aggte(MP = atts_nyt, type = "group")

Reference: Callaway, Brantly and Pedro H.C. Sant'Anna.  "Difference-in-Differences with Multiple Time Periods." Journal of Econometrics, Vol. 225, No. 2, pp. 200-230, 2021. &lt;https://doi.org/10.1016/j.jeconom.2020.12.001&gt;, &lt;https://arxiv.org/abs/1803.09015&gt; 


Overall summary of ATT's based on group/cohort aggregation:  
     ATT    Std. Error     [ 95%  Conf. Int.]  
 -8.2876        3.1312   -14.4245     -2.1506 *


Group Effects:
 Group Estimate Std. Error [95% Simult.  Conf. Band]  
  1969  -5.3569     8.0559      -25.2383     14.5245  
  1970 -30.6010    15.9287      -69.9121      8.7102  
  1971 -10.3173     5.9731      -25.0585      4.4240  
  1972  -7.9006     4.6751      -19.4384      3.6372  
  1973  -4.5364     5.2548      -17.5049      8.4321  
  1974  -7.3929     6.4834      -23.3936      8.6078  
  1975  -4.3417     3.1999      -12.2390      3.5555  
  1976 -13.5133     4.7870      -25.3272     -1.6993 *
  1977 -14.6717     8.9126      -36.6676      7.3241  
  1980  -7.3295     5.9612      -22.0414      7.3824  
  1984  -8.2189     2.9925      -15.6043     -0.8336 *
  1985  15.0381     2.6844        8.4132     21.6630 *
---
Signif. codes: `*' confidence band does not cover 0

Control Group:  Not Yet Treated,  Anticipation Periods:  0
Estimation Method:  Outcome Regression</code></pre>
</div>
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggdid</span>(agg.es)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="tarea-3-respuestas_files/figure-html/unnamed-chunk-12-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p><em>Notamos un efecto negativo en la tasa de suicidos que es estadísticamente significativa para los estados que fueron tratados en 1970, 1986 y 1984.</em></p></li>
<li><p>[5 puntos] ¿Cuáles son las ventajas del estimador de Callaway &amp; Sant’Anna (2021) respecto al estimador de TWFE?</p>
<p><em>Las ventajas del estimador de Callaway &amp; Sant’Anna respecto a TWFE son las siguientes:</em> <em>- Evita las comapraciones prohibidas (usar unidades tratadas como controles para unidades que son tratadas en periodos posteriores)</em> <em>- Hace explícito el grupo de comparación que se usa para comparar a las unidades tratadas</em> <em>- Hace explícita la manera en que se agregan los resultados de cada comparación <span class="math inline">\(ATT(g,t)\)</span></em> <em>- No impone efectos monótonos en el tiempo ni homogéneos entre unidades</em></p></li>
</ol>
</section>
<section id="pregunta-2" class="level2">
<h2 class="anchored" data-anchor-id="pregunta-2">Pregunta 2</h2>
<p>La ENIGH 2020 incluyó un módulo para la evaluación del Programa Jóvenes Construyendo el futuro. Se buscó que la cobertura de la encuesta pudiera incluir suficientes participantes del programa para poder compararlos con los no participantes. Los datos en <em>datos_jcf_analisis.csv</em> fueron construidos a partir de dicha encuesta. En este ejercicio estimaremos el efecto de participar en el programa sobre el ingreso trimestral, <strong>ingtot_tri</strong>, usando métodos de matching.</p>
<p>Las siguientes variables están incluidas en el archivo de datos: <strong>mujer</strong> (dummy de sexo), <strong>indigena</strong> (dummy de pertenencia a una etnia), <strong>rural</strong> (dummy del ámbito rural), <strong>escoacum</strong> (años de escolaridad), <strong>casadounion</strong> (dummy para casados o en unión libre), <strong>jefehog</strong> (dummy para jefes del hogar), <strong>haymenores</strong> (dummy para la presencia de menores de edad en el hogar), <strong>proggob</strong> (dummy para beneficiarios de programas de gobierno), y <strong>tot_integ</strong> (número de miembros del hogar). También se incluye la clave de las entidades, <strong>cve_ent</strong>.</p>
<ol type="a">
<li><p>[5 puntos] Considere la comparación para el ingreso trimestral, <strong>ingtot_tri</strong>, entre beneficiarios y su grupo de comparación, que serán los jóvenes que no asisten a la escuela y no están empleados. Los beneficiarios tienen <em>jcf2==1</em> y los jóvenes que no asisten a la escuela y no están empleados tienen <em>jcf2==0</em>. Muestre qué tan similares o qué tan diferentes son los individuos en ambos grupos en términos de las características indicadas anteriormente y del ingreso trimestral.</p>
<p><em>Estadística descriptiva:</em></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>data.jcf <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">"../files/datos_jcf_analisis.csv"</span>)</span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1023</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><em>Aquí usé datasummary para calcular la estadística descriptiva por grupos:</em></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="fu">datasummary</span>(ingtot_tri <span class="sc">+</span> mujer <span class="sc">+</span> indigena <span class="sc">+</span> rural <span class="sc">+</span> escoacum <span class="sc">+</span> casadounion <span class="sc">+</span> jefehog <span class="sc">+</span> haymenores <span class="sc">+</span> proggob <span class="sc">+</span> tot_integ <span class="sc">~</span> <span class="fu">factor</span>(jcf2) <span class="sc">*</span> (mean <span class="sc">+</span> sd) <span class="sc">*</span> <span class="fu">Arguments</span>(<span class="at">na.rm=</span><span class="cn">TRUE</span>),</span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>                <span class="at">fmt =</span> <span class="st">"%.2f"</span>,</span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a>                <span class="at">data =</span> data.jcf)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<!-- preamble start -->

    <script>

      function styleCell_o319cneo8effsfcg38ue(i, j, css_id) {
          var table = document.getElementById("tinytable_o319cneo8effsfcg38ue");
          var cell = table.rows[i]?.cells[j];  // Safe navigation to avoid errors
          if (cell) {
              console.log(`Styling cell at (${i}, ${j}) with class ${css_id}`);
              cell.classList.add(css_id);
          } else {
              console.warn(`Cell at (${i}, ${j}) not found.`);
          }
      }
      function insertSpanRow(i, colspan, content) {
        var table = document.getElementById('tinytable_o319cneo8effsfcg38ue');
        var newRow = table.insertRow(i);
        var newCell = newRow.insertCell(0);
        newCell.setAttribute("colspan", colspan);
        // newCell.innerText = content;
        // this may be unsafe, but innerText does not interpret <br>
        newCell.innerHTML = content;
      }
      function spanCell_o319cneo8effsfcg38ue(i, j, rowspan, colspan) {
        var table = document.getElementById("tinytable_o319cneo8effsfcg38ue");
        const targetRow = table.rows[i];
        const targetCell = targetRow.cells[j];
        for (let r = 0; r < rowspan; r++) {
          // Only start deleting cells to the right for the first row (r == 0)
          if (r === 0) {
            // Delete cells to the right of the target cell in the first row
            for (let c = colspan - 1; c > 0; c--) {
              if (table.rows[i + r].cells[j + c]) {
                table.rows[i + r].deleteCell(j + c);
              }
            }
          }
          // For rows below the first, delete starting from the target column
          if (r > 0) {
            for (let c = colspan - 1; c >= 0; c--) {
              if (table.rows[i + r] && table.rows[i + r].cells[j]) {
                table.rows[i + r].deleteCell(j);
              }
            }
          }
        }
        // Set rowspan and colspan of the target cell
        targetCell.rowSpan = rowspan;
        targetCell.colSpan = colspan;
      }
      // tinytable span after
      window.addEventListener('load', function () {
          var cellsToStyle = [
            // tinytable style arrays after
          { positions: [ { i: 0, j: 4 }, { i: 0, j: 3 },  ], css_id: 'tinytable_css_0yqui8arvthnnaij9ef1',}, 
          { positions: [ { i: 11, j: 1 }, { i: 11, j: 3 }, { i: 11, j: 2 }, { i: 11, j: 4 },  ], css_id: 'tinytable_css_uy949959h4oavhy4bb3w',}, 
          { positions: [ { i: 2, j: 1 }, { i: 3, j: 1 }, { i: 4, j: 1 }, { i: 5, j: 1 }, { i: 6, j: 1 }, { i: 7, j: 1 }, { i: 8, j: 1 }, { i: 9, j: 1 }, { i: 2, j: 2 }, { i: 3, j: 2 }, { i: 4, j: 2 }, { i: 5, j: 2 }, { i: 6, j: 2 }, { i: 7, j: 2 }, { i: 8, j: 2 }, { i: 9, j: 2 }, { i: 10, j: 2 }, { i: 10, j: 1 }, { i: 4, j: 3 }, { i: 2, j: 4 }, { i: 2, j: 3 }, { i: 3, j: 3 }, { i: 8, j: 3 }, { i: 5, j: 3 }, { i: 6, j: 3 }, { i: 7, j: 3 }, { i: 4, j: 4 }, { i: 9, j: 3 }, { i: 10, j: 3 }, { i: 3, j: 4 }, { i: 8, j: 4 }, { i: 5, j: 4 }, { i: 6, j: 4 }, { i: 7, j: 4 }, { i: 9, j: 4 }, { i: 10, j: 4 },  ], css_id: 'tinytable_css_5z7kieg41eh3ajo5xwpf',}, 
          { positions: [ { i: 0, j: 1 }, { i: 0, j: 2 },  ], css_id: 'tinytable_css_xz4jsovqyj368hcdqj43',}, 
          { positions: [ { i: 1, j: 1 }, { i: 1, j: 4 }, { i: 1, j: 3 }, { i: 1, j: 2 },  ], css_id: 'tinytable_css_p4cqrq4zc0yzpl955wnh',}, 
          { positions: [ { i: 11, j: 0 },  ], css_id: 'tinytable_css_vo1f9z8qq1hckx65an83',}, 
          { positions: [ { i: 2, j: 0 }, { i: 3, j: 0 }, { i: 4, j: 0 }, { i: 5, j: 0 }, { i: 6, j: 0 }, { i: 7, j: 0 }, { i: 8, j: 0 }, { i: 9, j: 0 }, { i: 10, j: 0 },  ], css_id: 'tinytable_css_lb3olvsqqn1vp6y6vaxw',}, 
          { positions: [ { i: 0, j: 0 },  ], css_id: 'tinytable_css_4vgw1gktcznutol253vj',}, 
          { positions: [ { i: 1, j: 0 },  ], css_id: 'tinytable_css_zyruoz028ig4ioptxxgm',}, 
          ];

          // Loop over the arrays to style the cells
          cellsToStyle.forEach(function (group) {
              group.positions.forEach(function (cell) {
                  styleCell_o319cneo8effsfcg38ue(cell.i, cell.j, group.css_id);
              });
          });
      });
    </script>

    <style>
      /* tinytable css entries after */
      .table td.tinytable_css_0yqui8arvthnnaij9ef1, .table th.tinytable_css_0yqui8arvthnnaij9ef1 { text-align: right; text-align: center; border-top: solid #d3d8dc 0.1em; text-align: center; }
      .table td.tinytable_css_uy949959h4oavhy4bb3w, .table th.tinytable_css_uy949959h4oavhy4bb3w { text-align: right; border-bottom: solid #d3d8dc 0.1em; }
      .table td.tinytable_css_5z7kieg41eh3ajo5xwpf, .table th.tinytable_css_5z7kieg41eh3ajo5xwpf { text-align: right; }
      .table td.tinytable_css_xz4jsovqyj368hcdqj43, .table th.tinytable_css_xz4jsovqyj368hcdqj43 { text-align: right; text-align: center; border-top: solid #d3d8dc 0.1em; text-align: center; border-bottom: solid #d3d8dc 0.05em; }
      .table td.tinytable_css_p4cqrq4zc0yzpl955wnh, .table th.tinytable_css_p4cqrq4zc0yzpl955wnh { text-align: right; border-bottom: solid #d3d8dc 0.05em; }
      .table td.tinytable_css_vo1f9z8qq1hckx65an83, .table th.tinytable_css_vo1f9z8qq1hckx65an83 { text-align: left; border-bottom: solid #d3d8dc 0.1em; }
      .table td.tinytable_css_lb3olvsqqn1vp6y6vaxw, .table th.tinytable_css_lb3olvsqqn1vp6y6vaxw { text-align: left; }
      .table td.tinytable_css_4vgw1gktcznutol253vj, .table th.tinytable_css_4vgw1gktcznutol253vj { text-align: left; text-align: center; border-top: solid #d3d8dc 0.1em; text-align: center; }
      .table td.tinytable_css_zyruoz028ig4ioptxxgm, .table th.tinytable_css_zyruoz028ig4ioptxxgm { text-align: left; border-bottom: solid #d3d8dc 0.05em; }
    </style>
    <div class="container">
      <table class="table table-borderless" id="tinytable_o319cneo8effsfcg38ue" style="width: auto; margin-left: auto; margin-right: auto;" data-quarto-disable-processing="true">
        <thead>
<tr>
<th scope="col" align="center" colspan="1"> </th>
<th scope="col" align="center" colspan="2">0</th>
<th scope="col" align="center" colspan="2">1</th>
</tr>

              <tr>
                <th scope="col"> </th>
                <th scope="col">mean</th>
                <th scope="col">sd</th>
                <th scope="col">mean</th>
                <th scope="col">sd</th>
              </tr>
        </thead>

        <tbody>
                <tr>
                  <td>ingtot_tri</td>
                  <td>1510.36</td>
                  <td>8478.60</td>
                  <td>9643.06</td>
                  <td>6632.56</td>
                </tr>
                <tr>
                  <td>mujer</td>
                  <td>0.76</td>
                  <td>0.43</td>
                  <td>0.59</td>
                  <td>0.49</td>
                </tr>
                <tr>
                  <td>indigena</td>
                  <td>0.22</td>
                  <td>0.41</td>
                  <td>0.59</td>
                  <td>0.49</td>
                </tr>
                <tr>
                  <td>rural</td>
                  <td>0.40</td>
                  <td>0.49</td>
                  <td>0.35</td>
                  <td>0.48</td>
                </tr>
                <tr>
                  <td>escoacum</td>
                  <td>10.39</td>
                  <td>3.23</td>
                  <td>12.03</td>
                  <td>2.70</td>
                </tr>
                <tr>
                  <td>casadounion</td>
                  <td>0.53</td>
                  <td>0.50</td>
                  <td>0.41</td>
                  <td>0.49</td>
                </tr>
                <tr>
                  <td>jefehog</td>
                  <td>0.06</td>
                  <td>0.23</td>
                  <td>0.14</td>
                  <td>0.35</td>
                </tr>
                <tr>
                  <td>haymenores</td>
                  <td>0.66</td>
                  <td>0.47</td>
                  <td>0.54</td>
                  <td>0.50</td>
                </tr>
                <tr>
                  <td>proggob</td>
                  <td>0.19</td>
                  <td>0.39</td>
                  <td>0.21</td>
                  <td>0.41</td>
                </tr>
                <tr>
                  <td>tot_integ</td>
                  <td>4.82</td>
                  <td>1.97</td>
                  <td>4.25</td>
                  <td>2.00</td>
                </tr>
        </tbody>
      </table>
    </div>
<!-- hack to avoid NA insertion in last line -->
</div>
</div>
<p><em>Claramente los individuos que participan en el programa son diferentes a los que no. En el programa hay una proporción menor de mujeres que en el grupo no tratado; en el grupo tratado hay un nivel mayor de escolaridad acumulada; y los individuos del grupo tratado viven en hogares más pequeños que los del grupo no tratado. Entre muchas otras diferencias.</em></p>
<p><em>El problema entonces es que existen factores que influyen en la probabilidad de recibir el tratamiento y en el ingreso, por lo que una comparación simple de individuos tratados y no tratados confundirá el efecto del tratamiento.</em></p></li>
<li><p>[5 puntos] Estime el TOT (TT o ATT) del programa en el ingreso trimestral, <strong>ingtot_tri</strong> usando el algoritmo de <em>vecino más cercano</em>. Para estimar el impacto en el ingreso trimestral se comparan a los beneficiarios de JCF con los jóvenes que no asisten a la escuela y no están empleados. Los beneficiarios tienen <em>jcf2==1</em> y los jóvenes que no asisten a la escuela y no están empleados tienen <em>jcf2==0</em>. Escoja la especificación del <em>propensity score</em> que más le parezca adecuada. Realice la inferencia estadística con errores agrupados a nivel grupo de emparejamiento. ¿De qué tamaño es el TOT estimado y es este efecto estadísticamente significativo?</p>
<p><em>Este es el modelo para el propensity score que yo escogí:</em></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a>sub.data <span class="ot">&lt;-</span> data.jcf <span class="sc">%&gt;%</span></span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>dplyr<span class="sc">::</span><span class="fu">select</span>(ingtot_tri, jcf2, mujer, indigena, cve_ent, rural, escoacum, casadounion,</span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a>    jefehog, haymenores, proggob, tot_integ, factor.x)</span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-5"><a href="#cb29-5" aria-hidden="true" tabindex="-1"></a>sub.data <span class="ot">&lt;-</span> sub.data[<span class="fu">complete.cases</span>(sub.data), ]</span>
<span id="cb29-6"><a href="#cb29-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-7"><a href="#cb29-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-8"><a href="#cb29-8" aria-hidden="true" tabindex="-1"></a>m.out.a <span class="ot">&lt;-</span> <span class="fu">matchit</span>(<span class="at">formula=</span>jcf2 <span class="sc">~</span> mujer <span class="sc">+</span> indigena <span class="sc">+</span> <span class="fu">factor</span>(cve_ent) <span class="sc">+</span> rural  <span class="sc">+</span> escoacum <span class="sc">+</span> casadounion <span class="sc">+</span> jefehog <span class="sc">+</span> haymenores <span class="sc">+</span> proggob <span class="sc">+</span> tot_integ,</span>
<span id="cb29-9"><a href="#cb29-9" aria-hidden="true" tabindex="-1"></a>                 <span class="at">method =</span> <span class="st">"nearest"</span>,</span>
<span id="cb29-10"><a href="#cb29-10" aria-hidden="true" tabindex="-1"></a>                 <span class="at">distance=</span> <span class="st">"glm"</span>,</span>
<span id="cb29-11"><a href="#cb29-11" aria-hidden="true" tabindex="-1"></a>                 <span class="at">replace =</span> <span class="cn">FALSE</span>,</span>
<span id="cb29-12"><a href="#cb29-12" aria-hidden="true" tabindex="-1"></a>                 <span class="at">data =</span> sub.data)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><em>Estimamos el efecto del tratamiento:</em></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>tt1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(ingtot_tri <span class="sc">~</span> jcf2,</span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>      <span class="at">data =</span> <span class="fu">match.data</span>(m.out.a))</span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a><span class="co">#Errores agrupados a nivel subclass</span></span>
<span id="cb30-5"><a href="#cb30-5" aria-hidden="true" tabindex="-1"></a><span class="fu">coeftest</span>(tt1,</span>
<span id="cb30-6"><a href="#cb30-6" aria-hidden="true" tabindex="-1"></a>         <span class="at">vcov. =</span> vcovCL,</span>
<span id="cb30-7"><a href="#cb30-7" aria-hidden="true" tabindex="-1"></a>         <span class="at">cluster =</span> <span class="sc">~</span>subclass)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
t test of coefficients:

            Estimate Std. Error t value  Pr(&gt;|t|)    
(Intercept)  1669.95     407.99  4.0931 5.735e-05 ***
jcf2         7973.11     708.27 11.2572 &lt; 2.2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
<p><em>Se estima un efecto de 7973 pesos adicionales de ingreso trimestral para los participantes en el programa.</em></p></li>
<li><p>[5 puntos] En el matching de la parte b., evalúe qué tan bueno es el procedimiento en balancear las características observadas una vez realizado el matching. Cree un <em>love plot</em> para evaluar qué tan bueno es el procedimiento de matching para obtener una muestra balanceada.</p>
<p><em>bal.tab del paquete cobalt nos permite ver un resumen del balance:</em></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Con esto elimino las dummies de estado de la salida</span></span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a><span class="fu">bal.tab</span>(m.out.a, <span class="at">m.threshold=</span><span class="fl">0.1</span>, <span class="at">un=</span>T)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Balance Measures
                       Type Diff.Un Diff.Adj        M.Threshold
distance           Distance  1.1091   0.0881     Balanced, &lt;0.1
mujer                Binary -0.1660   0.0551     Balanced, &lt;0.1
indigena             Binary  0.3714   0.0551     Balanced, &lt;0.1
factor(cve_ent)_01   Binary -0.1720  -0.0157     Balanced, &lt;0.1
factor(cve_ent)_02   Binary -0.3428  -0.0079     Balanced, &lt;0.1
factor(cve_ent)_03   Binary  0.0168   0.0079     Balanced, &lt;0.1
factor(cve_ent)_04   Binary  0.5524   0.0157     Balanced, &lt;0.1
factor(cve_ent)_05   Binary -0.0544   0.0000     Balanced, &lt;0.1
rural                Binary -0.0553   0.0709     Balanced, &lt;0.1
escoacum            Contin.  0.6086  -0.2096 Not Balanced, &gt;0.1
casadounion          Binary -0.1170   0.0709     Balanced, &lt;0.1
jefehog              Binary  0.0831   0.0551     Balanced, &lt;0.1
haymenores           Binary -0.1193   0.0787     Balanced, &lt;0.1
proggob              Binary  0.0220   0.0079     Balanced, &lt;0.1
tot_integ           Contin. -0.2856   0.0158     Balanced, &lt;0.1

Balance tally for mean differences
                   count
Balanced, &lt;0.1        14
Not Balanced, &gt;0.1     1

Variable with the greatest mean difference
 Variable Diff.Adj        M.Threshold
 escoacum  -0.2096 Not Balanced, &gt;0.1

Sample sizes
          Control Treated
All          1894     127
Matched       127     127
Unmatched    1767       0</code></pre>
</div>
</div>
<p><em>Y finalmente el loveplot:</em></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a>m.out.a[[<span class="st">"X"</span>]][[<span class="st">"factor(cve_ent)"</span>]] <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a><span class="fu">love.plot</span>(<span class="fu">bal.tab</span>(m.out.a),</span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a>      <span class="at">threshold =</span> .<span class="dv">1</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="tarea-3-respuestas_files/figure-html/unnamed-chunk-18-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p><em>Parece haber un buen balance, aunque la educación es la única variable que no queda bien balanceada. Después del emparejamiento, las medias (estandarizadas) entre tratados y no tratados difieren en más de 0.1.</em></p></li>
<li><p>[5 puntos] Estime ahora el TOT en el ingreso trimestral, como en la parte b., pero usando un caliper de 0.05 y 5 vecinos a ser emparejados. ¿Cómo cambian sus resultados respecto a los de la parte b.?</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a>sub.data <span class="ot">&lt;-</span> data.jcf <span class="sc">%&gt;%</span> </span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(ingtot_tri, jcf2, mujer, indigena, cve_ent, rural, escoacum, </span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a>           casadounion, jefehog, haymenores, proggob, tot_integ, factor.x)</span>
<span id="cb35-4"><a href="#cb35-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-5"><a href="#cb35-5" aria-hidden="true" tabindex="-1"></a>sub.data <span class="ot">&lt;-</span> sub.data[<span class="fu">complete.cases</span>(sub.data), ] </span>
<span id="cb35-6"><a href="#cb35-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-7"><a href="#cb35-7" aria-hidden="true" tabindex="-1"></a>m.out.c <span class="ot">&lt;-</span> <span class="fu">matchit</span>(<span class="at">formula=</span>jcf2 <span class="sc">~</span> mujer <span class="sc">+</span> indigena <span class="sc">+</span> <span class="fu">factor</span>(cve_ent) <span class="sc">+</span> rural  <span class="sc">+</span> escoacum <span class="sc">+</span> casadounion <span class="sc">+</span> jefehog <span class="sc">+</span> haymenores <span class="sc">+</span> proggob <span class="sc">+</span> tot_integ,</span>
<span id="cb35-8"><a href="#cb35-8" aria-hidden="true" tabindex="-1"></a>                 <span class="at">method =</span> <span class="st">"nearest"</span>,</span>
<span id="cb35-9"><a href="#cb35-9" aria-hidden="true" tabindex="-1"></a>                 <span class="at">distance=</span> <span class="st">"glm"</span>,</span>
<span id="cb35-10"><a href="#cb35-10" aria-hidden="true" tabindex="-1"></a>                 <span class="at">ratio =</span> <span class="dv">5</span>,</span>
<span id="cb35-11"><a href="#cb35-11" aria-hidden="true" tabindex="-1"></a>                 <span class="at">caliper =</span> <span class="fl">0.05</span>,</span>
<span id="cb35-12"><a href="#cb35-12" aria-hidden="true" tabindex="-1"></a>                 <span class="at">replace =</span> <span class="cn">FALSE</span>,</span>
<span id="cb35-13"><a href="#cb35-13" aria-hidden="true" tabindex="-1"></a>                 <span class="at">data =</span> sub.data)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><em>Estimamos el efecto del tratamiento:</em></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a>tt3 <span class="ot">&lt;-</span> <span class="fu">lm</span>(ingtot_tri <span class="sc">~</span> jcf2,</span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a>      <span class="at">data =</span> <span class="fu">match.data</span>(m.out.c))</span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-4"><a href="#cb36-4" aria-hidden="true" tabindex="-1"></a><span class="co">#Errores agrupados a nivel subclass</span></span>
<span id="cb36-5"><a href="#cb36-5" aria-hidden="true" tabindex="-1"></a><span class="fu">coeftest</span>(tt3,</span>
<span id="cb36-6"><a href="#cb36-6" aria-hidden="true" tabindex="-1"></a>         <span class="at">vcov. =</span> vcovCL,</span>
<span id="cb36-7"><a href="#cb36-7" aria-hidden="true" tabindex="-1"></a>         <span class="at">cluster =</span> <span class="sc">~</span>subclass)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
t test of coefficients:

            Estimate Std. Error t value  Pr(&gt;|t|)    
(Intercept)  2135.55     372.22  5.7374 1.717e-08 ***
jcf2         7155.74     699.21 10.2341 &lt; 2.2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
<p><em>Se estima ahora un efecto de 7155 pesos, menor al efecto de 7973 pesos estimado en la parte b.</em></p></li>
</ol>


</section>
</section>


<div id="quarto-appendix" class="default"><section id="footnotes" class="footnotes footnotes-end-of-document" role="doc-endnotes"><h2 class="anchored quarto-appendix-heading">Notas</h2>

<ol>
<li id="fn1"><p>Stevenson, B. &amp; Wolfers, J. (2006). Bargaining in the Shadow of the Law: Divorce Laws and Family Distress. <em>The Quarterly Journal of Economics</em>, 121(1), 267-288.<a href="#fnref1" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
</ol>
</section></div></main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copiado");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copiado");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
        const codeEl = trigger.previousElementSibling.cloneNode(true);
        for (const childEl of codeEl.children) {
          if (isCodeAnnotation(childEl)) {
            childEl.remove();
          }
        }
        return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp('/' + window.location.host + '/');
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
</div> <!-- /content -->




</body></html>