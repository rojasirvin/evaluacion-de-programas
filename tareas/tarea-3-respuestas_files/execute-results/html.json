{
  "hash": "34855794e4c48f727c1bab0daa3aa1ea",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Respuestas a la tarea 3\"\nlang: es\nformat: html\n---\n\n\n::: {.cell}\n\n:::\n\n\n\n# Respuestas\n\n\n## Pregunta 1 \n\nLos datos en *ehec_data.csv* son datos de panel a nivel estado para los Estados Unidos de 2008 a 2019. A partir de 2014 se llevó a cabo un proceso de expansión de un programa de ayuda para subsidiar el costo de los servicios de salud de personas de bajos ingresos, *Medicaid Expansion*. La columna **yexp2** indica el año en que cada estado es tratado con la expansión del programa, **treated** es un indicador de si el estado $i$ es tratado en el año $t$, mientras que **rel_year** indica el número de años desde la expansión. Si *yexp2==Inf*, entonces el estado no ha sido tratado para 2019. Se busca estimar el efecto de la expansión del programa en el porcentaje de la población asegurada que es de bajos ingresos, sin hijos, y de entre 25 y 64 años de edad, **dins**.\n\na. [5 puntos] ¿Por qué decimos que esta es una aplicación de la estimación de efectos de tratamiento con adopción escalonada?\n\n    *En esta aplicación, cada estado comienza a ser tratado en indistintos momentos del tiempo. Si hacemos un tabulado de **yexp2** notamos cuántos estados se vuelven tratados en cada año:*\n\n\n   ::: {.cell}\n   \n   ```{.r .cell-code}\n   acafs <- read_csv(\"../files/ehec_data.csv\") \n   \n   table(filter(acafs,year==2018)$yexp2)\n   ```\n   \n   ::: {.cell-output .cell-output-stdout}\n   \n   ```\n   \n   2014 2015 2016 2017 2019  Inf \n     22    3    2    1    2   16 \n   ```\n   \n   \n   :::\n   :::\n\n    *El panel comienza en 2008. 22 estados son tratados desde 2014, 3 en 2015 y así sucesivamente. 16 estados nunca son tratados*.\n\na. [5 puntos] Como punto de partida, estime el efecto del tratamiento sobre **dins** usando efectos fijos por estado y año (TWFE) y empleando una librería específica para efectos fijos, como *felm*. Tome en cuenta la agrupación de los errores. Interprete sus resultados.\n\n   *Usando felm podemos incorporar ya el nivel de agrupación de los errores:*\n\n\n   ::: {.cell}\n   \n   ```{.r .cell-code}\n   twfe <- felm(dins ~ treated | stfips + year | 0 | stfips,\n                 data = acafs)\n   \n   modelsummary(twfe,\n                coef_map = c('treated'),\n                stars = c('*' = .1, '**' = .05, '***'= 0.01),\n                gof_map = c('nobs'),\n                output = 'gt')\n   ```\n   \n   ::: {.cell-output-display}\n   \n   ```{=html}\n   <div id=\"rusyvnmmzv\" style=\"padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;\">\n   <style>#rusyvnmmzv table {\n     font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';\n     -webkit-font-smoothing: antialiased;\n     -moz-osx-font-smoothing: grayscale;\n   }\n   \n   #rusyvnmmzv thead, #rusyvnmmzv tbody, #rusyvnmmzv tfoot, #rusyvnmmzv tr, #rusyvnmmzv td, #rusyvnmmzv th {\n     border-style: none;\n   }\n   \n   #rusyvnmmzv p {\n     margin: 0;\n     padding: 0;\n   }\n   \n   #rusyvnmmzv .gt_table {\n     display: table;\n     border-collapse: collapse;\n     line-height: normal;\n     margin-left: auto;\n     margin-right: auto;\n     color: #333333;\n     font-size: 16px;\n     font-weight: normal;\n     font-style: normal;\n     background-color: #FFFFFF;\n     width: auto;\n     border-top-style: solid;\n     border-top-width: 2px;\n     border-top-color: #A8A8A8;\n     border-right-style: none;\n     border-right-width: 2px;\n     border-right-color: #D3D3D3;\n     border-bottom-style: solid;\n     border-bottom-width: 2px;\n     border-bottom-color: #A8A8A8;\n     border-left-style: none;\n     border-left-width: 2px;\n     border-left-color: #D3D3D3;\n   }\n   \n   #rusyvnmmzv .gt_caption {\n     padding-top: 4px;\n     padding-bottom: 4px;\n   }\n   \n   #rusyvnmmzv .gt_title {\n     color: #333333;\n     font-size: 125%;\n     font-weight: initial;\n     padding-top: 4px;\n     padding-bottom: 4px;\n     padding-left: 5px;\n     padding-right: 5px;\n     border-bottom-color: #FFFFFF;\n     border-bottom-width: 0;\n   }\n   \n   #rusyvnmmzv .gt_subtitle {\n     color: #333333;\n     font-size: 85%;\n     font-weight: initial;\n     padding-top: 3px;\n     padding-bottom: 5px;\n     padding-left: 5px;\n     padding-right: 5px;\n     border-top-color: #FFFFFF;\n     border-top-width: 0;\n   }\n   \n   #rusyvnmmzv .gt_heading {\n     background-color: #FFFFFF;\n     text-align: center;\n     border-bottom-color: #FFFFFF;\n     border-left-style: none;\n     border-left-width: 1px;\n     border-left-color: #D3D3D3;\n     border-right-style: none;\n     border-right-width: 1px;\n     border-right-color: #D3D3D3;\n   }\n   \n   #rusyvnmmzv .gt_bottom_border {\n     border-bottom-style: solid;\n     border-bottom-width: 2px;\n     border-bottom-color: #D3D3D3;\n   }\n   \n   #rusyvnmmzv .gt_col_headings {\n     border-top-style: solid;\n     border-top-width: 2px;\n     border-top-color: #D3D3D3;\n     border-bottom-style: solid;\n     border-bottom-width: 2px;\n     border-bottom-color: #D3D3D3;\n     border-left-style: none;\n     border-left-width: 1px;\n     border-left-color: #D3D3D3;\n     border-right-style: none;\n     border-right-width: 1px;\n     border-right-color: #D3D3D3;\n   }\n   \n   #rusyvnmmzv .gt_col_heading {\n     color: #333333;\n     background-color: #FFFFFF;\n     font-size: 100%;\n     font-weight: normal;\n     text-transform: inherit;\n     border-left-style: none;\n     border-left-width: 1px;\n     border-left-color: #D3D3D3;\n     border-right-style: none;\n     border-right-width: 1px;\n     border-right-color: #D3D3D3;\n     vertical-align: bottom;\n     padding-top: 5px;\n     padding-bottom: 6px;\n     padding-left: 5px;\n     padding-right: 5px;\n     overflow-x: hidden;\n   }\n   \n   #rusyvnmmzv .gt_column_spanner_outer {\n     color: #333333;\n     background-color: #FFFFFF;\n     font-size: 100%;\n     font-weight: normal;\n     text-transform: inherit;\n     padding-top: 0;\n     padding-bottom: 0;\n     padding-left: 4px;\n     padding-right: 4px;\n   }\n   \n   #rusyvnmmzv .gt_column_spanner_outer:first-child {\n     padding-left: 0;\n   }\n   \n   #rusyvnmmzv .gt_column_spanner_outer:last-child {\n     padding-right: 0;\n   }\n   \n   #rusyvnmmzv .gt_column_spanner {\n     border-bottom-style: solid;\n     border-bottom-width: 2px;\n     border-bottom-color: #D3D3D3;\n     vertical-align: bottom;\n     padding-top: 5px;\n     padding-bottom: 5px;\n     overflow-x: hidden;\n     display: inline-block;\n     width: 100%;\n   }\n   \n   #rusyvnmmzv .gt_spanner_row {\n     border-bottom-style: hidden;\n   }\n   \n   #rusyvnmmzv .gt_group_heading {\n     padding-top: 8px;\n     padding-bottom: 8px;\n     padding-left: 5px;\n     padding-right: 5px;\n     color: #333333;\n     background-color: #FFFFFF;\n     font-size: 100%;\n     font-weight: initial;\n     text-transform: inherit;\n     border-top-style: solid;\n     border-top-width: 2px;\n     border-top-color: #D3D3D3;\n     border-bottom-style: solid;\n     border-bottom-width: 2px;\n     border-bottom-color: #D3D3D3;\n     border-left-style: none;\n     border-left-width: 1px;\n     border-left-color: #D3D3D3;\n     border-right-style: none;\n     border-right-width: 1px;\n     border-right-color: #D3D3D3;\n     vertical-align: middle;\n     text-align: left;\n   }\n   \n   #rusyvnmmzv .gt_empty_group_heading {\n     padding: 0.5px;\n     color: #333333;\n     background-color: #FFFFFF;\n     font-size: 100%;\n     font-weight: initial;\n     border-top-style: solid;\n     border-top-width: 2px;\n     border-top-color: #D3D3D3;\n     border-bottom-style: solid;\n     border-bottom-width: 2px;\n     border-bottom-color: #D3D3D3;\n     vertical-align: middle;\n   }\n   \n   #rusyvnmmzv .gt_from_md > :first-child {\n     margin-top: 0;\n   }\n   \n   #rusyvnmmzv .gt_from_md > :last-child {\n     margin-bottom: 0;\n   }\n   \n   #rusyvnmmzv .gt_row {\n     padding-top: 8px;\n     padding-bottom: 8px;\n     padding-left: 5px;\n     padding-right: 5px;\n     margin: 10px;\n     border-top-style: solid;\n     border-top-width: 1px;\n     border-top-color: #D3D3D3;\n     border-left-style: none;\n     border-left-width: 1px;\n     border-left-color: #D3D3D3;\n     border-right-style: none;\n     border-right-width: 1px;\n     border-right-color: #D3D3D3;\n     vertical-align: middle;\n     overflow-x: hidden;\n   }\n   \n   #rusyvnmmzv .gt_stub {\n     color: #333333;\n     background-color: #FFFFFF;\n     font-size: 100%;\n     font-weight: initial;\n     text-transform: inherit;\n     border-right-style: solid;\n     border-right-width: 2px;\n     border-right-color: #D3D3D3;\n     padding-left: 5px;\n     padding-right: 5px;\n   }\n   \n   #rusyvnmmzv .gt_stub_row_group {\n     color: #333333;\n     background-color: #FFFFFF;\n     font-size: 100%;\n     font-weight: initial;\n     text-transform: inherit;\n     border-right-style: solid;\n     border-right-width: 2px;\n     border-right-color: #D3D3D3;\n     padding-left: 5px;\n     padding-right: 5px;\n     vertical-align: top;\n   }\n   \n   #rusyvnmmzv .gt_row_group_first td {\n     border-top-width: 2px;\n   }\n   \n   #rusyvnmmzv .gt_row_group_first th {\n     border-top-width: 2px;\n   }\n   \n   #rusyvnmmzv .gt_summary_row {\n     color: #333333;\n     background-color: #FFFFFF;\n     text-transform: inherit;\n     padding-top: 8px;\n     padding-bottom: 8px;\n     padding-left: 5px;\n     padding-right: 5px;\n   }\n   \n   #rusyvnmmzv .gt_first_summary_row {\n     border-top-style: solid;\n     border-top-color: #D3D3D3;\n   }\n   \n   #rusyvnmmzv .gt_first_summary_row.thick {\n     border-top-width: 2px;\n   }\n   \n   #rusyvnmmzv .gt_last_summary_row {\n     padding-top: 8px;\n     padding-bottom: 8px;\n     padding-left: 5px;\n     padding-right: 5px;\n     border-bottom-style: solid;\n     border-bottom-width: 2px;\n     border-bottom-color: #D3D3D3;\n   }\n   \n   #rusyvnmmzv .gt_grand_summary_row {\n     color: #333333;\n     background-color: #FFFFFF;\n     text-transform: inherit;\n     padding-top: 8px;\n     padding-bottom: 8px;\n     padding-left: 5px;\n     padding-right: 5px;\n   }\n   \n   #rusyvnmmzv .gt_first_grand_summary_row {\n     padding-top: 8px;\n     padding-bottom: 8px;\n     padding-left: 5px;\n     padding-right: 5px;\n     border-top-style: double;\n     border-top-width: 6px;\n     border-top-color: #D3D3D3;\n   }\n   \n   #rusyvnmmzv .gt_last_grand_summary_row_top {\n     padding-top: 8px;\n     padding-bottom: 8px;\n     padding-left: 5px;\n     padding-right: 5px;\n     border-bottom-style: double;\n     border-bottom-width: 6px;\n     border-bottom-color: #D3D3D3;\n   }\n   \n   #rusyvnmmzv .gt_striped {\n     background-color: rgba(128, 128, 128, 0.05);\n   }\n   \n   #rusyvnmmzv .gt_table_body {\n     border-top-style: solid;\n     border-top-width: 2px;\n     border-top-color: #D3D3D3;\n     border-bottom-style: solid;\n     border-bottom-width: 2px;\n     border-bottom-color: #D3D3D3;\n   }\n   \n   #rusyvnmmzv .gt_footnotes {\n     color: #333333;\n     background-color: #FFFFFF;\n     border-bottom-style: none;\n     border-bottom-width: 2px;\n     border-bottom-color: #D3D3D3;\n     border-left-style: none;\n     border-left-width: 2px;\n     border-left-color: #D3D3D3;\n     border-right-style: none;\n     border-right-width: 2px;\n     border-right-color: #D3D3D3;\n   }\n   \n   #rusyvnmmzv .gt_footnote {\n     margin: 0px;\n     font-size: 90%;\n     padding-top: 4px;\n     padding-bottom: 4px;\n     padding-left: 5px;\n     padding-right: 5px;\n   }\n   \n   #rusyvnmmzv .gt_sourcenotes {\n     color: #333333;\n     background-color: #FFFFFF;\n     border-bottom-style: none;\n     border-bottom-width: 2px;\n     border-bottom-color: #D3D3D3;\n     border-left-style: none;\n     border-left-width: 2px;\n     border-left-color: #D3D3D3;\n     border-right-style: none;\n     border-right-width: 2px;\n     border-right-color: #D3D3D3;\n   }\n   \n   #rusyvnmmzv .gt_sourcenote {\n     font-size: 90%;\n     padding-top: 4px;\n     padding-bottom: 4px;\n     padding-left: 5px;\n     padding-right: 5px;\n   }\n   \n   #rusyvnmmzv .gt_left {\n     text-align: left;\n   }\n   \n   #rusyvnmmzv .gt_center {\n     text-align: center;\n   }\n   \n   #rusyvnmmzv .gt_right {\n     text-align: right;\n     font-variant-numeric: tabular-nums;\n   }\n   \n   #rusyvnmmzv .gt_font_normal {\n     font-weight: normal;\n   }\n   \n   #rusyvnmmzv .gt_font_bold {\n     font-weight: bold;\n   }\n   \n   #rusyvnmmzv .gt_font_italic {\n     font-style: italic;\n   }\n   \n   #rusyvnmmzv .gt_super {\n     font-size: 65%;\n   }\n   \n   #rusyvnmmzv .gt_footnote_marks {\n     font-size: 75%;\n     vertical-align: 0.4em;\n     position: initial;\n   }\n   \n   #rusyvnmmzv .gt_asterisk {\n     font-size: 100%;\n     vertical-align: 0;\n   }\n   \n   #rusyvnmmzv .gt_indent_1 {\n     text-indent: 5px;\n   }\n   \n   #rusyvnmmzv .gt_indent_2 {\n     text-indent: 10px;\n   }\n   \n   #rusyvnmmzv .gt_indent_3 {\n     text-indent: 15px;\n   }\n   \n   #rusyvnmmzv .gt_indent_4 {\n     text-indent: 20px;\n   }\n   \n   #rusyvnmmzv .gt_indent_5 {\n     text-indent: 25px;\n   }\n   \n   #rusyvnmmzv .katex-display {\n     display: inline-flex !important;\n     margin-bottom: 0.75em !important;\n   }\n   \n   #rusyvnmmzv div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {\n     height: 0px !important;\n   }\n   </style>\n   <table class=\"gt_table\" data-quarto-disable-processing=\"false\" data-quarto-bootstrap=\"false\">\n     <thead>\n       <tr class=\"gt_col_headings\">\n         <th class=\"gt_col_heading gt_columns_bottom_border gt_left\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"a-\"> </th>\n         <th class=\"gt_col_heading gt_columns_bottom_border gt_center\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"a(1)\">(1)</th>\n       </tr>\n     </thead>\n     <tbody class=\"gt_table_body\">\n       <tr><td headers=\" \" class=\"gt_row gt_left\">treated</td>\n   <td headers=\"(1)\" class=\"gt_row gt_center\">0.070***</td></tr>\n       <tr><td headers=\" \" class=\"gt_row gt_left\" style=\"border-bottom-width: 1px; border-bottom-style: solid; border-bottom-color: #000000;\"></td>\n   <td headers=\"(1)\" class=\"gt_row gt_center\" style=\"border-bottom-width: 1px; border-bottom-style: solid; border-bottom-color: #000000;\">(0.007)</td></tr>\n       <tr><td headers=\" \" class=\"gt_row gt_left\">Num.Obs.</td>\n   <td headers=\"(1)\" class=\"gt_row gt_center\">552</td></tr>\n     </tbody>\n     <tfoot class=\"gt_sourcenotes\">\n       <tr>\n         <td class=\"gt_sourcenote\" colspan=\"2\">* p &lt; 0.1, ** p &lt; 0.05, *** p &lt; 0.01</td>\n       </tr>\n     </tfoot>\n     \n   </table>\n   </div>\n   ```\n   \n   :::\n   :::\n\n\n    \na. [5 puntos] Compruebe que puede obtener el mismo resultado con una regresión lineal usando el paquete *lm* e incluyendo, además de la variable de tratamiento, dummies de estado y de año. \n\n   *Estimamos con dummies:*\n  \n\n   ::: {.cell}\n   \n   ```{.r .cell-code}\n   m1 <- lm(dins ~ treated + factor(stfips) + factor(year),\n                 data = acafs)\n   ```\n   :::\n\n\n   *Luego presentamos con errores clásicos y errores agrupados:*\n  \n\n   ::: {.cell}\n   \n   ```{.r .cell-code}\n   modelsummary(list(m1, m1),\n                coef_map = c('treated'),\n                vcov=list(NULL, clubSandwich::vcovCR(m1, type='CR1', cluster=acafs$stfips)),\n                stars = c('*' = .1, '**' = .05, '***'= 0.01),\n                gof_map = c('nobs'),\n                output = 'gt')\n   ```\n   \n   ::: {.cell-output-display}\n   \n   ```{=html}\n   <div id=\"mgdvdxhrcr\" style=\"padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;\">\n   <style>#mgdvdxhrcr table {\n     font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';\n     -webkit-font-smoothing: antialiased;\n     -moz-osx-font-smoothing: grayscale;\n   }\n   \n   #mgdvdxhrcr thead, #mgdvdxhrcr tbody, #mgdvdxhrcr tfoot, #mgdvdxhrcr tr, #mgdvdxhrcr td, #mgdvdxhrcr th {\n     border-style: none;\n   }\n   \n   #mgdvdxhrcr p {\n     margin: 0;\n     padding: 0;\n   }\n   \n   #mgdvdxhrcr .gt_table {\n     display: table;\n     border-collapse: collapse;\n     line-height: normal;\n     margin-left: auto;\n     margin-right: auto;\n     color: #333333;\n     font-size: 16px;\n     font-weight: normal;\n     font-style: normal;\n     background-color: #FFFFFF;\n     width: auto;\n     border-top-style: solid;\n     border-top-width: 2px;\n     border-top-color: #A8A8A8;\n     border-right-style: none;\n     border-right-width: 2px;\n     border-right-color: #D3D3D3;\n     border-bottom-style: solid;\n     border-bottom-width: 2px;\n     border-bottom-color: #A8A8A8;\n     border-left-style: none;\n     border-left-width: 2px;\n     border-left-color: #D3D3D3;\n   }\n   \n   #mgdvdxhrcr .gt_caption {\n     padding-top: 4px;\n     padding-bottom: 4px;\n   }\n   \n   #mgdvdxhrcr .gt_title {\n     color: #333333;\n     font-size: 125%;\n     font-weight: initial;\n     padding-top: 4px;\n     padding-bottom: 4px;\n     padding-left: 5px;\n     padding-right: 5px;\n     border-bottom-color: #FFFFFF;\n     border-bottom-width: 0;\n   }\n   \n   #mgdvdxhrcr .gt_subtitle {\n     color: #333333;\n     font-size: 85%;\n     font-weight: initial;\n     padding-top: 3px;\n     padding-bottom: 5px;\n     padding-left: 5px;\n     padding-right: 5px;\n     border-top-color: #FFFFFF;\n     border-top-width: 0;\n   }\n   \n   #mgdvdxhrcr .gt_heading {\n     background-color: #FFFFFF;\n     text-align: center;\n     border-bottom-color: #FFFFFF;\n     border-left-style: none;\n     border-left-width: 1px;\n     border-left-color: #D3D3D3;\n     border-right-style: none;\n     border-right-width: 1px;\n     border-right-color: #D3D3D3;\n   }\n   \n   #mgdvdxhrcr .gt_bottom_border {\n     border-bottom-style: solid;\n     border-bottom-width: 2px;\n     border-bottom-color: #D3D3D3;\n   }\n   \n   #mgdvdxhrcr .gt_col_headings {\n     border-top-style: solid;\n     border-top-width: 2px;\n     border-top-color: #D3D3D3;\n     border-bottom-style: solid;\n     border-bottom-width: 2px;\n     border-bottom-color: #D3D3D3;\n     border-left-style: none;\n     border-left-width: 1px;\n     border-left-color: #D3D3D3;\n     border-right-style: none;\n     border-right-width: 1px;\n     border-right-color: #D3D3D3;\n   }\n   \n   #mgdvdxhrcr .gt_col_heading {\n     color: #333333;\n     background-color: #FFFFFF;\n     font-size: 100%;\n     font-weight: normal;\n     text-transform: inherit;\n     border-left-style: none;\n     border-left-width: 1px;\n     border-left-color: #D3D3D3;\n     border-right-style: none;\n     border-right-width: 1px;\n     border-right-color: #D3D3D3;\n     vertical-align: bottom;\n     padding-top: 5px;\n     padding-bottom: 6px;\n     padding-left: 5px;\n     padding-right: 5px;\n     overflow-x: hidden;\n   }\n   \n   #mgdvdxhrcr .gt_column_spanner_outer {\n     color: #333333;\n     background-color: #FFFFFF;\n     font-size: 100%;\n     font-weight: normal;\n     text-transform: inherit;\n     padding-top: 0;\n     padding-bottom: 0;\n     padding-left: 4px;\n     padding-right: 4px;\n   }\n   \n   #mgdvdxhrcr .gt_column_spanner_outer:first-child {\n     padding-left: 0;\n   }\n   \n   #mgdvdxhrcr .gt_column_spanner_outer:last-child {\n     padding-right: 0;\n   }\n   \n   #mgdvdxhrcr .gt_column_spanner {\n     border-bottom-style: solid;\n     border-bottom-width: 2px;\n     border-bottom-color: #D3D3D3;\n     vertical-align: bottom;\n     padding-top: 5px;\n     padding-bottom: 5px;\n     overflow-x: hidden;\n     display: inline-block;\n     width: 100%;\n   }\n   \n   #mgdvdxhrcr .gt_spanner_row {\n     border-bottom-style: hidden;\n   }\n   \n   #mgdvdxhrcr .gt_group_heading {\n     padding-top: 8px;\n     padding-bottom: 8px;\n     padding-left: 5px;\n     padding-right: 5px;\n     color: #333333;\n     background-color: #FFFFFF;\n     font-size: 100%;\n     font-weight: initial;\n     text-transform: inherit;\n     border-top-style: solid;\n     border-top-width: 2px;\n     border-top-color: #D3D3D3;\n     border-bottom-style: solid;\n     border-bottom-width: 2px;\n     border-bottom-color: #D3D3D3;\n     border-left-style: none;\n     border-left-width: 1px;\n     border-left-color: #D3D3D3;\n     border-right-style: none;\n     border-right-width: 1px;\n     border-right-color: #D3D3D3;\n     vertical-align: middle;\n     text-align: left;\n   }\n   \n   #mgdvdxhrcr .gt_empty_group_heading {\n     padding: 0.5px;\n     color: #333333;\n     background-color: #FFFFFF;\n     font-size: 100%;\n     font-weight: initial;\n     border-top-style: solid;\n     border-top-width: 2px;\n     border-top-color: #D3D3D3;\n     border-bottom-style: solid;\n     border-bottom-width: 2px;\n     border-bottom-color: #D3D3D3;\n     vertical-align: middle;\n   }\n   \n   #mgdvdxhrcr .gt_from_md > :first-child {\n     margin-top: 0;\n   }\n   \n   #mgdvdxhrcr .gt_from_md > :last-child {\n     margin-bottom: 0;\n   }\n   \n   #mgdvdxhrcr .gt_row {\n     padding-top: 8px;\n     padding-bottom: 8px;\n     padding-left: 5px;\n     padding-right: 5px;\n     margin: 10px;\n     border-top-style: solid;\n     border-top-width: 1px;\n     border-top-color: #D3D3D3;\n     border-left-style: none;\n     border-left-width: 1px;\n     border-left-color: #D3D3D3;\n     border-right-style: none;\n     border-right-width: 1px;\n     border-right-color: #D3D3D3;\n     vertical-align: middle;\n     overflow-x: hidden;\n   }\n   \n   #mgdvdxhrcr .gt_stub {\n     color: #333333;\n     background-color: #FFFFFF;\n     font-size: 100%;\n     font-weight: initial;\n     text-transform: inherit;\n     border-right-style: solid;\n     border-right-width: 2px;\n     border-right-color: #D3D3D3;\n     padding-left: 5px;\n     padding-right: 5px;\n   }\n   \n   #mgdvdxhrcr .gt_stub_row_group {\n     color: #333333;\n     background-color: #FFFFFF;\n     font-size: 100%;\n     font-weight: initial;\n     text-transform: inherit;\n     border-right-style: solid;\n     border-right-width: 2px;\n     border-right-color: #D3D3D3;\n     padding-left: 5px;\n     padding-right: 5px;\n     vertical-align: top;\n   }\n   \n   #mgdvdxhrcr .gt_row_group_first td {\n     border-top-width: 2px;\n   }\n   \n   #mgdvdxhrcr .gt_row_group_first th {\n     border-top-width: 2px;\n   }\n   \n   #mgdvdxhrcr .gt_summary_row {\n     color: #333333;\n     background-color: #FFFFFF;\n     text-transform: inherit;\n     padding-top: 8px;\n     padding-bottom: 8px;\n     padding-left: 5px;\n     padding-right: 5px;\n   }\n   \n   #mgdvdxhrcr .gt_first_summary_row {\n     border-top-style: solid;\n     border-top-color: #D3D3D3;\n   }\n   \n   #mgdvdxhrcr .gt_first_summary_row.thick {\n     border-top-width: 2px;\n   }\n   \n   #mgdvdxhrcr .gt_last_summary_row {\n     padding-top: 8px;\n     padding-bottom: 8px;\n     padding-left: 5px;\n     padding-right: 5px;\n     border-bottom-style: solid;\n     border-bottom-width: 2px;\n     border-bottom-color: #D3D3D3;\n   }\n   \n   #mgdvdxhrcr .gt_grand_summary_row {\n     color: #333333;\n     background-color: #FFFFFF;\n     text-transform: inherit;\n     padding-top: 8px;\n     padding-bottom: 8px;\n     padding-left: 5px;\n     padding-right: 5px;\n   }\n   \n   #mgdvdxhrcr .gt_first_grand_summary_row {\n     padding-top: 8px;\n     padding-bottom: 8px;\n     padding-left: 5px;\n     padding-right: 5px;\n     border-top-style: double;\n     border-top-width: 6px;\n     border-top-color: #D3D3D3;\n   }\n   \n   #mgdvdxhrcr .gt_last_grand_summary_row_top {\n     padding-top: 8px;\n     padding-bottom: 8px;\n     padding-left: 5px;\n     padding-right: 5px;\n     border-bottom-style: double;\n     border-bottom-width: 6px;\n     border-bottom-color: #D3D3D3;\n   }\n   \n   #mgdvdxhrcr .gt_striped {\n     background-color: rgba(128, 128, 128, 0.05);\n   }\n   \n   #mgdvdxhrcr .gt_table_body {\n     border-top-style: solid;\n     border-top-width: 2px;\n     border-top-color: #D3D3D3;\n     border-bottom-style: solid;\n     border-bottom-width: 2px;\n     border-bottom-color: #D3D3D3;\n   }\n   \n   #mgdvdxhrcr .gt_footnotes {\n     color: #333333;\n     background-color: #FFFFFF;\n     border-bottom-style: none;\n     border-bottom-width: 2px;\n     border-bottom-color: #D3D3D3;\n     border-left-style: none;\n     border-left-width: 2px;\n     border-left-color: #D3D3D3;\n     border-right-style: none;\n     border-right-width: 2px;\n     border-right-color: #D3D3D3;\n   }\n   \n   #mgdvdxhrcr .gt_footnote {\n     margin: 0px;\n     font-size: 90%;\n     padding-top: 4px;\n     padding-bottom: 4px;\n     padding-left: 5px;\n     padding-right: 5px;\n   }\n   \n   #mgdvdxhrcr .gt_sourcenotes {\n     color: #333333;\n     background-color: #FFFFFF;\n     border-bottom-style: none;\n     border-bottom-width: 2px;\n     border-bottom-color: #D3D3D3;\n     border-left-style: none;\n     border-left-width: 2px;\n     border-left-color: #D3D3D3;\n     border-right-style: none;\n     border-right-width: 2px;\n     border-right-color: #D3D3D3;\n   }\n   \n   #mgdvdxhrcr .gt_sourcenote {\n     font-size: 90%;\n     padding-top: 4px;\n     padding-bottom: 4px;\n     padding-left: 5px;\n     padding-right: 5px;\n   }\n   \n   #mgdvdxhrcr .gt_left {\n     text-align: left;\n   }\n   \n   #mgdvdxhrcr .gt_center {\n     text-align: center;\n   }\n   \n   #mgdvdxhrcr .gt_right {\n     text-align: right;\n     font-variant-numeric: tabular-nums;\n   }\n   \n   #mgdvdxhrcr .gt_font_normal {\n     font-weight: normal;\n   }\n   \n   #mgdvdxhrcr .gt_font_bold {\n     font-weight: bold;\n   }\n   \n   #mgdvdxhrcr .gt_font_italic {\n     font-style: italic;\n   }\n   \n   #mgdvdxhrcr .gt_super {\n     font-size: 65%;\n   }\n   \n   #mgdvdxhrcr .gt_footnote_marks {\n     font-size: 75%;\n     vertical-align: 0.4em;\n     position: initial;\n   }\n   \n   #mgdvdxhrcr .gt_asterisk {\n     font-size: 100%;\n     vertical-align: 0;\n   }\n   \n   #mgdvdxhrcr .gt_indent_1 {\n     text-indent: 5px;\n   }\n   \n   #mgdvdxhrcr .gt_indent_2 {\n     text-indent: 10px;\n   }\n   \n   #mgdvdxhrcr .gt_indent_3 {\n     text-indent: 15px;\n   }\n   \n   #mgdvdxhrcr .gt_indent_4 {\n     text-indent: 20px;\n   }\n   \n   #mgdvdxhrcr .gt_indent_5 {\n     text-indent: 25px;\n   }\n   \n   #mgdvdxhrcr .katex-display {\n     display: inline-flex !important;\n     margin-bottom: 0.75em !important;\n   }\n   \n   #mgdvdxhrcr div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {\n     height: 0px !important;\n   }\n   </style>\n   <table class=\"gt_table\" data-quarto-disable-processing=\"false\" data-quarto-bootstrap=\"false\">\n     <thead>\n       <tr class=\"gt_col_headings\">\n         <th class=\"gt_col_heading gt_columns_bottom_border gt_left\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"a-\"> </th>\n         <th class=\"gt_col_heading gt_columns_bottom_border gt_center\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"a(1)\">(1)</th>\n         <th class=\"gt_col_heading gt_columns_bottom_border gt_center\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"a(2)\">(2)</th>\n       </tr>\n     </thead>\n     <tbody class=\"gt_table_body\">\n       <tr><td headers=\" \" class=\"gt_row gt_left\">treated</td>\n   <td headers=\"(1)\" class=\"gt_row gt_center\">0.070***</td>\n   <td headers=\"(2)\" class=\"gt_row gt_center\">0.070***</td></tr>\n       <tr><td headers=\" \" class=\"gt_row gt_left\" style=\"border-bottom-width: 1px; border-bottom-style: solid; border-bottom-color: #000000;\"></td>\n   <td headers=\"(1)\" class=\"gt_row gt_center\" style=\"border-bottom-width: 1px; border-bottom-style: solid; border-bottom-color: #000000;\">(0.004)</td>\n   <td headers=\"(2)\" class=\"gt_row gt_center\" style=\"border-bottom-width: 1px; border-bottom-style: solid; border-bottom-color: #000000;\">(0.007)</td></tr>\n       <tr><td headers=\" \" class=\"gt_row gt_left\">Num.Obs.</td>\n   <td headers=\"(1)\" class=\"gt_row gt_center\">552</td>\n   <td headers=\"(2)\" class=\"gt_row gt_center\">552</td></tr>\n     </tbody>\n     <tfoot class=\"gt_sourcenotes\">\n       <tr>\n         <td class=\"gt_sourcenote\" colspan=\"3\">* p &lt; 0.1, ** p &lt; 0.05, *** p &lt; 0.01</td>\n       </tr>\n     </tfoot>\n     \n   </table>\n   </div>\n   ```\n   \n   :::\n   :::\n\n\n   \na. [10 puntos] Ahora muestre que podemos obtener el coeficiente de TWFE a partir de una regresión bivariada entre el porcentaje de la población asegurada y **treated**, una vez *purgada* por efectos fijos. Para ello, primero estime una regresión de **treated** en función de los efectos fijos. Obtenga la predicción y luego defina una nueva variable igual a la diferencia entre **treated** y la predicción que acaba de obtener. Finalmente, obtenga el coeficiente de TWFE con una regresión del porcentaje de la población asegurada en función de la diferencia antes definida.\n\n   *Corremos la primera regresión para purgar los efectos fijos:*\n\n  \n\n   ::: {.cell}\n   \n   ```{.r .cell-code}\n   d1 <- lm(treated ~ factor(stfips) + factor(year),\n                 data = acafs)\n   ```\n   :::\n\n\n\n   *Definimos la nueva variable:*\n\n\n   ::: {.cell}\n   \n   ```{.r .cell-code}\n   acafs <- acafs %>% \n     mutate(treated_hat = treated-predict(d1))\n   ```\n   :::\n\n\n   *Y finalmente estimamos:*\n\n\n   ::: {.cell}\n   \n   ```{.r .cell-code}\n   summary(m2 <- lm(dins ~ treated_hat,\n                 data = acafs))\n   ```\n   \n   ::: {.cell-output .cell-output-stdout}\n   \n   ```\n   \n   Call:\n   lm(formula = dins ~ treated_hat, data = acafs)\n   \n   Residuals:\n         Min        1Q    Median        3Q       Max \n   -0.225383 -0.066374  0.001295  0.069099  0.200551 \n   \n   Coefficients:\n               Estimate Std. Error t value Pr(>|t|)    \n   (Intercept) 0.699824   0.003744 186.909  < 2e-16 ***\n   treated_hat 0.070321   0.014475   4.858 1.55e-06 ***\n   ---\n   Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n   \n   Residual standard error: 0.08797 on 550 degrees of freedom\n   Multiple R-squared:  0.04115,\tAdjusted R-squared:  0.0394 \n   F-statistic:  23.6 on 1 and 550 DF,  p-value: 1.547e-06\n   ```\n   \n   \n   :::\n   :::\n\n\n   *Obtenemos el mismo coeficiente. Frisch–Waugh–Lovell tenían razón:*\n\n  \n\n   ::: {.cell}\n   \n   ```{.r .cell-code}\n   modelsummary(list(m2),\n                coef_map = c('treated_hat'),\n                stars = c('*' = .1, '**' = .05, '***'= 0.01),\n                gof_map = c('nobs'),\n                output = 'gt')\n   ```\n   \n   ::: {.cell-output-display}\n   \n   ```{=html}\n   <div id=\"shpwyinpri\" style=\"padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;\">\n   <style>#shpwyinpri table {\n     font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';\n     -webkit-font-smoothing: antialiased;\n     -moz-osx-font-smoothing: grayscale;\n   }\n   \n   #shpwyinpri thead, #shpwyinpri tbody, #shpwyinpri tfoot, #shpwyinpri tr, #shpwyinpri td, #shpwyinpri th {\n     border-style: none;\n   }\n   \n   #shpwyinpri p {\n     margin: 0;\n     padding: 0;\n   }\n   \n   #shpwyinpri .gt_table {\n     display: table;\n     border-collapse: collapse;\n     line-height: normal;\n     margin-left: auto;\n     margin-right: auto;\n     color: #333333;\n     font-size: 16px;\n     font-weight: normal;\n     font-style: normal;\n     background-color: #FFFFFF;\n     width: auto;\n     border-top-style: solid;\n     border-top-width: 2px;\n     border-top-color: #A8A8A8;\n     border-right-style: none;\n     border-right-width: 2px;\n     border-right-color: #D3D3D3;\n     border-bottom-style: solid;\n     border-bottom-width: 2px;\n     border-bottom-color: #A8A8A8;\n     border-left-style: none;\n     border-left-width: 2px;\n     border-left-color: #D3D3D3;\n   }\n   \n   #shpwyinpri .gt_caption {\n     padding-top: 4px;\n     padding-bottom: 4px;\n   }\n   \n   #shpwyinpri .gt_title {\n     color: #333333;\n     font-size: 125%;\n     font-weight: initial;\n     padding-top: 4px;\n     padding-bottom: 4px;\n     padding-left: 5px;\n     padding-right: 5px;\n     border-bottom-color: #FFFFFF;\n     border-bottom-width: 0;\n   }\n   \n   #shpwyinpri .gt_subtitle {\n     color: #333333;\n     font-size: 85%;\n     font-weight: initial;\n     padding-top: 3px;\n     padding-bottom: 5px;\n     padding-left: 5px;\n     padding-right: 5px;\n     border-top-color: #FFFFFF;\n     border-top-width: 0;\n   }\n   \n   #shpwyinpri .gt_heading {\n     background-color: #FFFFFF;\n     text-align: center;\n     border-bottom-color: #FFFFFF;\n     border-left-style: none;\n     border-left-width: 1px;\n     border-left-color: #D3D3D3;\n     border-right-style: none;\n     border-right-width: 1px;\n     border-right-color: #D3D3D3;\n   }\n   \n   #shpwyinpri .gt_bottom_border {\n     border-bottom-style: solid;\n     border-bottom-width: 2px;\n     border-bottom-color: #D3D3D3;\n   }\n   \n   #shpwyinpri .gt_col_headings {\n     border-top-style: solid;\n     border-top-width: 2px;\n     border-top-color: #D3D3D3;\n     border-bottom-style: solid;\n     border-bottom-width: 2px;\n     border-bottom-color: #D3D3D3;\n     border-left-style: none;\n     border-left-width: 1px;\n     border-left-color: #D3D3D3;\n     border-right-style: none;\n     border-right-width: 1px;\n     border-right-color: #D3D3D3;\n   }\n   \n   #shpwyinpri .gt_col_heading {\n     color: #333333;\n     background-color: #FFFFFF;\n     font-size: 100%;\n     font-weight: normal;\n     text-transform: inherit;\n     border-left-style: none;\n     border-left-width: 1px;\n     border-left-color: #D3D3D3;\n     border-right-style: none;\n     border-right-width: 1px;\n     border-right-color: #D3D3D3;\n     vertical-align: bottom;\n     padding-top: 5px;\n     padding-bottom: 6px;\n     padding-left: 5px;\n     padding-right: 5px;\n     overflow-x: hidden;\n   }\n   \n   #shpwyinpri .gt_column_spanner_outer {\n     color: #333333;\n     background-color: #FFFFFF;\n     font-size: 100%;\n     font-weight: normal;\n     text-transform: inherit;\n     padding-top: 0;\n     padding-bottom: 0;\n     padding-left: 4px;\n     padding-right: 4px;\n   }\n   \n   #shpwyinpri .gt_column_spanner_outer:first-child {\n     padding-left: 0;\n   }\n   \n   #shpwyinpri .gt_column_spanner_outer:last-child {\n     padding-right: 0;\n   }\n   \n   #shpwyinpri .gt_column_spanner {\n     border-bottom-style: solid;\n     border-bottom-width: 2px;\n     border-bottom-color: #D3D3D3;\n     vertical-align: bottom;\n     padding-top: 5px;\n     padding-bottom: 5px;\n     overflow-x: hidden;\n     display: inline-block;\n     width: 100%;\n   }\n   \n   #shpwyinpri .gt_spanner_row {\n     border-bottom-style: hidden;\n   }\n   \n   #shpwyinpri .gt_group_heading {\n     padding-top: 8px;\n     padding-bottom: 8px;\n     padding-left: 5px;\n     padding-right: 5px;\n     color: #333333;\n     background-color: #FFFFFF;\n     font-size: 100%;\n     font-weight: initial;\n     text-transform: inherit;\n     border-top-style: solid;\n     border-top-width: 2px;\n     border-top-color: #D3D3D3;\n     border-bottom-style: solid;\n     border-bottom-width: 2px;\n     border-bottom-color: #D3D3D3;\n     border-left-style: none;\n     border-left-width: 1px;\n     border-left-color: #D3D3D3;\n     border-right-style: none;\n     border-right-width: 1px;\n     border-right-color: #D3D3D3;\n     vertical-align: middle;\n     text-align: left;\n   }\n   \n   #shpwyinpri .gt_empty_group_heading {\n     padding: 0.5px;\n     color: #333333;\n     background-color: #FFFFFF;\n     font-size: 100%;\n     font-weight: initial;\n     border-top-style: solid;\n     border-top-width: 2px;\n     border-top-color: #D3D3D3;\n     border-bottom-style: solid;\n     border-bottom-width: 2px;\n     border-bottom-color: #D3D3D3;\n     vertical-align: middle;\n   }\n   \n   #shpwyinpri .gt_from_md > :first-child {\n     margin-top: 0;\n   }\n   \n   #shpwyinpri .gt_from_md > :last-child {\n     margin-bottom: 0;\n   }\n   \n   #shpwyinpri .gt_row {\n     padding-top: 8px;\n     padding-bottom: 8px;\n     padding-left: 5px;\n     padding-right: 5px;\n     margin: 10px;\n     border-top-style: solid;\n     border-top-width: 1px;\n     border-top-color: #D3D3D3;\n     border-left-style: none;\n     border-left-width: 1px;\n     border-left-color: #D3D3D3;\n     border-right-style: none;\n     border-right-width: 1px;\n     border-right-color: #D3D3D3;\n     vertical-align: middle;\n     overflow-x: hidden;\n   }\n   \n   #shpwyinpri .gt_stub {\n     color: #333333;\n     background-color: #FFFFFF;\n     font-size: 100%;\n     font-weight: initial;\n     text-transform: inherit;\n     border-right-style: solid;\n     border-right-width: 2px;\n     border-right-color: #D3D3D3;\n     padding-left: 5px;\n     padding-right: 5px;\n   }\n   \n   #shpwyinpri .gt_stub_row_group {\n     color: #333333;\n     background-color: #FFFFFF;\n     font-size: 100%;\n     font-weight: initial;\n     text-transform: inherit;\n     border-right-style: solid;\n     border-right-width: 2px;\n     border-right-color: #D3D3D3;\n     padding-left: 5px;\n     padding-right: 5px;\n     vertical-align: top;\n   }\n   \n   #shpwyinpri .gt_row_group_first td {\n     border-top-width: 2px;\n   }\n   \n   #shpwyinpri .gt_row_group_first th {\n     border-top-width: 2px;\n   }\n   \n   #shpwyinpri .gt_summary_row {\n     color: #333333;\n     background-color: #FFFFFF;\n     text-transform: inherit;\n     padding-top: 8px;\n     padding-bottom: 8px;\n     padding-left: 5px;\n     padding-right: 5px;\n   }\n   \n   #shpwyinpri .gt_first_summary_row {\n     border-top-style: solid;\n     border-top-color: #D3D3D3;\n   }\n   \n   #shpwyinpri .gt_first_summary_row.thick {\n     border-top-width: 2px;\n   }\n   \n   #shpwyinpri .gt_last_summary_row {\n     padding-top: 8px;\n     padding-bottom: 8px;\n     padding-left: 5px;\n     padding-right: 5px;\n     border-bottom-style: solid;\n     border-bottom-width: 2px;\n     border-bottom-color: #D3D3D3;\n   }\n   \n   #shpwyinpri .gt_grand_summary_row {\n     color: #333333;\n     background-color: #FFFFFF;\n     text-transform: inherit;\n     padding-top: 8px;\n     padding-bottom: 8px;\n     padding-left: 5px;\n     padding-right: 5px;\n   }\n   \n   #shpwyinpri .gt_first_grand_summary_row {\n     padding-top: 8px;\n     padding-bottom: 8px;\n     padding-left: 5px;\n     padding-right: 5px;\n     border-top-style: double;\n     border-top-width: 6px;\n     border-top-color: #D3D3D3;\n   }\n   \n   #shpwyinpri .gt_last_grand_summary_row_top {\n     padding-top: 8px;\n     padding-bottom: 8px;\n     padding-left: 5px;\n     padding-right: 5px;\n     border-bottom-style: double;\n     border-bottom-width: 6px;\n     border-bottom-color: #D3D3D3;\n   }\n   \n   #shpwyinpri .gt_striped {\n     background-color: rgba(128, 128, 128, 0.05);\n   }\n   \n   #shpwyinpri .gt_table_body {\n     border-top-style: solid;\n     border-top-width: 2px;\n     border-top-color: #D3D3D3;\n     border-bottom-style: solid;\n     border-bottom-width: 2px;\n     border-bottom-color: #D3D3D3;\n   }\n   \n   #shpwyinpri .gt_footnotes {\n     color: #333333;\n     background-color: #FFFFFF;\n     border-bottom-style: none;\n     border-bottom-width: 2px;\n     border-bottom-color: #D3D3D3;\n     border-left-style: none;\n     border-left-width: 2px;\n     border-left-color: #D3D3D3;\n     border-right-style: none;\n     border-right-width: 2px;\n     border-right-color: #D3D3D3;\n   }\n   \n   #shpwyinpri .gt_footnote {\n     margin: 0px;\n     font-size: 90%;\n     padding-top: 4px;\n     padding-bottom: 4px;\n     padding-left: 5px;\n     padding-right: 5px;\n   }\n   \n   #shpwyinpri .gt_sourcenotes {\n     color: #333333;\n     background-color: #FFFFFF;\n     border-bottom-style: none;\n     border-bottom-width: 2px;\n     border-bottom-color: #D3D3D3;\n     border-left-style: none;\n     border-left-width: 2px;\n     border-left-color: #D3D3D3;\n     border-right-style: none;\n     border-right-width: 2px;\n     border-right-color: #D3D3D3;\n   }\n   \n   #shpwyinpri .gt_sourcenote {\n     font-size: 90%;\n     padding-top: 4px;\n     padding-bottom: 4px;\n     padding-left: 5px;\n     padding-right: 5px;\n   }\n   \n   #shpwyinpri .gt_left {\n     text-align: left;\n   }\n   \n   #shpwyinpri .gt_center {\n     text-align: center;\n   }\n   \n   #shpwyinpri .gt_right {\n     text-align: right;\n     font-variant-numeric: tabular-nums;\n   }\n   \n   #shpwyinpri .gt_font_normal {\n     font-weight: normal;\n   }\n   \n   #shpwyinpri .gt_font_bold {\n     font-weight: bold;\n   }\n   \n   #shpwyinpri .gt_font_italic {\n     font-style: italic;\n   }\n   \n   #shpwyinpri .gt_super {\n     font-size: 65%;\n   }\n   \n   #shpwyinpri .gt_footnote_marks {\n     font-size: 75%;\n     vertical-align: 0.4em;\n     position: initial;\n   }\n   \n   #shpwyinpri .gt_asterisk {\n     font-size: 100%;\n     vertical-align: 0;\n   }\n   \n   #shpwyinpri .gt_indent_1 {\n     text-indent: 5px;\n   }\n   \n   #shpwyinpri .gt_indent_2 {\n     text-indent: 10px;\n   }\n   \n   #shpwyinpri .gt_indent_3 {\n     text-indent: 15px;\n   }\n   \n   #shpwyinpri .gt_indent_4 {\n     text-indent: 20px;\n   }\n   \n   #shpwyinpri .gt_indent_5 {\n     text-indent: 25px;\n   }\n   \n   #shpwyinpri .katex-display {\n     display: inline-flex !important;\n     margin-bottom: 0.75em !important;\n   }\n   \n   #shpwyinpri div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {\n     height: 0px !important;\n   }\n   </style>\n   <table class=\"gt_table\" data-quarto-disable-processing=\"false\" data-quarto-bootstrap=\"false\">\n     <thead>\n       <tr class=\"gt_col_headings\">\n         <th class=\"gt_col_heading gt_columns_bottom_border gt_left\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"a-\"> </th>\n         <th class=\"gt_col_heading gt_columns_bottom_border gt_center\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"a(1)\">(1)</th>\n       </tr>\n     </thead>\n     <tbody class=\"gt_table_body\">\n       <tr><td headers=\" \" class=\"gt_row gt_left\">treated_hat</td>\n   <td headers=\"(1)\" class=\"gt_row gt_center\">0.070***</td></tr>\n       <tr><td headers=\" \" class=\"gt_row gt_left\" style=\"border-bottom-width: 1px; border-bottom-style: solid; border-bottom-color: #000000;\"></td>\n   <td headers=\"(1)\" class=\"gt_row gt_center\" style=\"border-bottom-width: 1px; border-bottom-style: solid; border-bottom-color: #000000;\">(0.014)</td></tr>\n       <tr><td headers=\" \" class=\"gt_row gt_left\">Num.Obs.</td>\n   <td headers=\"(1)\" class=\"gt_row gt_center\">552</td></tr>\n     </tbody>\n     <tfoot class=\"gt_sourcenotes\">\n       <tr>\n         <td class=\"gt_sourcenote\" colspan=\"2\">* p &lt; 0.1, ** p &lt; 0.05, *** p &lt; 0.01</td>\n       </tr>\n     </tfoot>\n     \n   </table>\n   </div>\n   ```\n   \n   :::\n   :::\n\n\n\n\na. [10 puntos] Realice la descomposición de Goodman-Bacon (2021). Construya un gráfico donde muestre en el eje $x$ el peso otorgado a cada comparación 2x2 y en el eje $y$ el efecto estimado correspondiente a cada comparación. Interprete el gráfico obtenido.\n\n    *Como vimos en clase:*\n    \n\n   ::: {.cell}\n   \n   ```{.r .cell-code}\n   #Goodman-Bacon decomposition\n   df_bacon <- bacon(dins ~ treated,\n                     data = acafs,\n                     id_var = \"stfips\",\n                     time_var = \"year\")\n   ```\n   \n   ::: {.cell-output .cell-output-stdout}\n   \n   ```\n                         type  weight avg_est\n   1 Earlier vs Later Treated 0.14911 0.06983\n   2 Later vs Earlier Treated 0.05827 0.04486\n   3     Treated vs Untreated 0.79262 0.07228\n   ```\n   \n   \n   :::\n   \n   ```{.r .cell-code}\n   coef_bacon <- sum(df_bacon$estimate * df_bacon$weight)\n   print(paste(\"Weighted sum of decomposition =\", round(coef_bacon, 4)))\n   ```\n   \n   ::: {.cell-output .cell-output-stdout}\n   \n   ```\n   [1] \"Weighted sum of decomposition = 0.0703\"\n   ```\n   \n   \n   :::\n   \n   ```{.r .cell-code}\n   twfe <- feols(dins ~ treated | stfips + year,\n                 data = acafs,\n                 cluster = ~stfips)\n   #Gráfico\n   df_bacon %>% \n     ggplot(aes(x=weight,\n                y=estimate,\n                shape=type)) +\n     geom_point() +\n     geom_hline(yintercept = round(twfe$coefficients, 4))\n   ```\n   \n   ::: {.cell-output-display}\n   ![](tarea-3-respuestas_files/figure-html/unnamed-chunk-9-1.png){width=672}\n   :::\n   :::\n\n    \n    *Las comparaciones que más pesan en el estimador de efectos fijos son las de estados tratados con los nunca tratados, que llegan a recibir un peso de más de 0.6. La comparación con más peso tiene un efecto estimado de 0.0749, parecida al 0.07 que se obtiene con efectos fijos.*\n    \n    \na. [10 puntos] Implemente el estimador de Callaway & Sant’Anna (2021) para estimar los efectos del tratamiento específicos para cada cohorte, usando el paquete *did*. Utilice como grupo de comparación los estados *no tratados aún*.\n\n\n   ::: {.cell}\n   \n   ```{.r .cell-code}\n   acafs <- acafs %>% \n     mutate(stfips2 = as.numeric(factor(stfips)))\n   \n   atts_nyt <- att_gt(yname = \"dins\",\n                         tname = \"year\",\n                         idname = \"stfips2\",\n                         gname = \"yexp2\",\n                         data = acafs,\n                         control_group = \"notyettreated\",\n                         est_method = 'reg',\n                         bstrap = TRUE,\n                         biters = 1000,\n                         print_details = FALSE,\n                         panel = TRUE)\n   \n   \n   summary(atts_nyt)\n   ```\n   \n   ::: {.cell-output .cell-output-stdout}\n   \n   ```\n   \n   Call:\n   att_gt(yname = \"dins\", tname = \"year\", idname = \"stfips2\", gname = \"yexp2\", \n       data = acafs, panel = TRUE, control_group = \"notyettreated\", \n       bstrap = TRUE, biters = 1000, est_method = \"reg\", print_details = FALSE)\n   \n   Reference: Callaway, Brantly and Pedro H.C. Sant'Anna.  \"Difference-in-Differences with Multiple Time Periods.\" Journal of Econometrics, Vol. 225, No. 2, pp. 200-230, 2021. <https://doi.org/10.1016/j.jeconom.2020.12.001>, <https://arxiv.org/abs/1803.09015> \n   \n   Group-Time Average Treatment Effects:\n    Group Time ATT(g,t) Std. Error [95% Simult.  Conf. Band]  \n     2014 2009  -0.0065     0.0049       -0.0199      0.0068  \n     2014 2010   0.0111     0.0066       -0.0068      0.0291  \n     2014 2011   0.0015     0.0053       -0.0127      0.0157  \n     2014 2012   0.0016     0.0066       -0.0161      0.0194  \n     2014 2013   0.0009     0.0070       -0.0181      0.0200  \n     2014 2014   0.0467     0.0091        0.0221      0.0713 *\n     2014 2015   0.0692     0.0102        0.0415      0.0969 *\n     2014 2016   0.0785     0.0106        0.0498      0.1072 *\n     2014 2017   0.0725     0.0109        0.0430      0.1020 *\n     2014 2018   0.0738     0.0124        0.0402      0.1075 *\n     2014 2019   0.0803     0.0100        0.0534      0.1073 *\n     2015 2009   0.0071     0.0141       -0.0310      0.0452  \n     2015 2010  -0.0245     0.0111       -0.0546      0.0056  \n     2015 2011  -0.0027     0.0057       -0.0182      0.0128  \n     2015 2012   0.0003     0.0035       -0.0092      0.0098  \n     2015 2013  -0.0100     0.0112       -0.0404      0.0205  \n     2015 2014  -0.0020     0.0072       -0.0215      0.0174  \n     2015 2015   0.0491     0.0223       -0.0112      0.1093  \n     2015 2016   0.0526     0.0146        0.0130      0.0922 *\n     2015 2017   0.0682     0.0100        0.0411      0.0952 *\n     2015 2018   0.0663     0.0124        0.0328      0.0998 *\n     2015 2019   0.0738     0.0114        0.0430      0.1046 *\n     2016 2009   0.0022     0.0061       -0.0144      0.0188  \n     2016 2010   0.0511     0.0077        0.0304      0.0718 *\n     2016 2011  -0.0262     0.0360       -0.1237      0.0713  \n     2016 2012  -0.0276     0.0433       -0.1449      0.0897  \n     2016 2013   0.0440     0.0433       -0.0732      0.1612  \n     2016 2014  -0.0322     0.0464       -0.1577      0.0933  \n     2016 2015   0.0409     0.0166       -0.0042      0.0859  \n     2016 2016   0.0317     0.0102        0.0041      0.0593 *\n     2016 2017   0.0368     0.0084        0.0141      0.0595 *\n     2016 2018   0.0645     0.0130        0.0294      0.0996 *\n     2016 2019   0.0825     0.0096        0.0565      0.1085 *\n     2017 2009   0.0102     0.0025        0.0034      0.0171 *\n     2017 2010  -0.0161     0.0036       -0.0259     -0.0064 *\n     2017 2011   0.0019     0.0028       -0.0056      0.0093  \n     2017 2012   0.0177     0.0033        0.0088      0.0266 *\n     2017 2013   0.0012     0.0036       -0.0087      0.0111  \n     2017 2014  -0.0063     0.0063       -0.0235      0.0109  \n     2017 2015   0.0036     0.0072       -0.0160      0.0232  \n     2017 2016   0.0398     0.0061        0.0234      0.0563 *\n     2017 2017   0.0471     0.0056        0.0319      0.0623 *\n     2017 2018   0.0681     0.0045        0.0558      0.0803 *\n     2017 2019   0.0650     0.0039        0.0543      0.0757 *\n     2019 2009   0.0189     0.0054        0.0042      0.0336 *\n     2019 2010  -0.0269     0.0089       -0.0511     -0.0027 *\n     2019 2011  -0.0244     0.0029       -0.0323     -0.0165 *\n     2019 2012   0.0024     0.0187       -0.0483      0.0530  \n     2019 2013   0.0129     0.0074       -0.0072      0.0331  \n     2019 2014   0.0003     0.0073       -0.0195      0.0202  \n     2019 2015  -0.0108     0.0086       -0.0342      0.0125  \n     2019 2016  -0.0182     0.0240       -0.0832      0.0467  \n     2019 2017   0.0093     0.0195       -0.0434      0.0619  \n     2019 2018   0.0062     0.0063       -0.0109      0.0233  \n     2019 2019   0.0365     0.0053        0.0221      0.0510 *\n   ---\n   Signif. codes: `*' confidence band does not cover 0\n   \n   Control Group:  Not Yet Treated,  Anticipation Periods:  0\n   Estimation Method:  Outcome Regression\n   ```\n   \n   \n   :::\n   \n   ```{.r .cell-code}\n   ggdid(atts_nyt)\n   ```\n   \n   ::: {.cell-output-display}\n   ![](tarea-3-respuestas_files/figure-html/unnamed-chunk-10-1.png){width=672}\n   :::\n   :::\n\na. [10 puntos] Reporte los resultados agregados obtenidos a partir del estimador Callaway & Sant’Anna (2021), usando una agregación dinámica que muestre los efectos promedio para cada periodo antes y después del tratamiento. Grafique e interprete los resultados.\n\n   *Graficamos:*\n  \n\n   ::: {.cell}\n   \n   ```{.r .cell-code}\n   agg.es <- aggte(atts_nyt,\n                   type = \"dynamic\")\n   summary(agg.es)\n   ```\n   \n   ::: {.cell-output .cell-output-stdout}\n   \n   ```\n   \n   Call:\n   aggte(MP = atts_nyt, type = \"dynamic\")\n   \n   Reference: Callaway, Brantly and Pedro H.C. Sant'Anna.  \"Difference-in-Differences with Multiple Time Periods.\" Journal of Econometrics, Vol. 225, No. 2, pp. 200-230, 2021. <https://doi.org/10.1016/j.jeconom.2020.12.001>, <https://arxiv.org/abs/1803.09015> \n   \n   \n   Overall summary of ATT's based on event-study/dynamic aggregation:  \n       ATT    Std. Error     [ 95%  Conf. Int.]  \n    0.0688        0.0081      0.053      0.0846 *\n   \n   \n   Dynamic Effects:\n    Event time Estimate Std. Error [95% Simult.  Conf. Band]  \n           -10   0.0189     0.0056        0.0044      0.0333 *\n            -9  -0.0269     0.0085       -0.0489     -0.0049 *\n            -8  -0.0129     0.0113       -0.0422      0.0165  \n            -7  -0.0014     0.0076       -0.0210      0.0182  \n            -6   0.0189     0.0082       -0.0023      0.0401  \n            -5  -0.0084     0.0051       -0.0216      0.0049  \n            -4   0.0054     0.0079       -0.0152      0.0259  \n            -3   0.0026     0.0048       -0.0097      0.0150  \n            -2  -0.0012     0.0036       -0.0107      0.0082  \n            -1   0.0049     0.0040       -0.0055      0.0154  \n             0   0.0453     0.0061        0.0295      0.0611 *\n             1   0.0651     0.0082        0.0437      0.0864 *\n             2   0.0759     0.0086        0.0535      0.0983 *\n             3   0.0726     0.0092        0.0488      0.0963 *\n             4   0.0738     0.0109        0.0454      0.1022 *\n             5   0.0803     0.0107        0.0527      0.1080 *\n   ---\n   Signif. codes: `*' confidence band does not cover 0\n   \n   Control Group:  Not Yet Treated,  Anticipation Periods:  0\n   Estimation Method:  Outcome Regression\n   ```\n   \n   \n   :::\n   \n   ```{.r .cell-code}\n   ggdid(agg.es)\n   ```\n   \n   ::: {.cell-output-display}\n   ![](tarea-3-respuestas_files/figure-html/unnamed-chunk-11-1.png){width=672}\n   :::\n   :::\n\n\na. [10 puntos] Reporte los resultados agregados obtenidos a partir del estimador Callaway & Sant’Anna (2021), usando una agregación or grupos que muestre los efectos promedio para cada cohorte del tratamiento. Grafique e interprete los resultados.\n\n   *Graficamos:*\n  \n\n   ::: {.cell}\n   \n   ```{.r .cell-code}\n   agg.es <- aggte(atts_nyt,\n                   type = \"group\")\n   summary(agg.es)\n   ```\n   \n   ::: {.cell-output .cell-output-stdout}\n   \n   ```\n   \n   Call:\n   aggte(MP = atts_nyt, type = \"group\")\n   \n   Reference: Callaway, Brantly and Pedro H.C. Sant'Anna.  \"Difference-in-Differences with Multiple Time Periods.\" Journal of Econometrics, Vol. 225, No. 2, pp. 200-230, 2021. <https://doi.org/10.1016/j.jeconom.2020.12.001>, <https://arxiv.org/abs/1803.09015> \n   \n   \n   Overall summary of ATT's based on group/cohort aggregation:  \n       ATT    Std. Error     [ 95%  Conf. Int.]  \n    0.0657        0.0104     0.0452      0.0861 *\n   \n   \n   Group Effects:\n    Group Estimate Std. Error [95% Simult.  Conf. Band]  \n     2014   0.0702     0.0089        0.0502      0.0901 *\n     2015   0.0620     0.0136        0.0313      0.0927 *\n     2016   0.0539     0.0047        0.0434      0.0644 *\n     2017   0.0601     0.0040        0.0511      0.0691 *\n     2019   0.0365     0.0054        0.0243      0.0488 *\n   ---\n   Signif. codes: `*' confidence band does not cover 0\n   \n   Control Group:  Not Yet Treated,  Anticipation Periods:  0\n   Estimation Method:  Outcome Regression\n   ```\n   \n   \n   :::\n   \n   ```{.r .cell-code}\n   ggdid(agg.es)\n   ```\n   \n   ::: {.cell-output-display}\n   ![](tarea-3-respuestas_files/figure-html/unnamed-chunk-12-1.png){width=672}\n   :::\n   :::\n\n\n## Pregunta 2\n\nSuponga que se convierte en asesor de la instancia gubernamental encargada de la seguridad alimentaria. Al gobierno le interesa que la seguridad alimentaria de las familias productoras de maíz para autoconsumo no se vea afectada negativamente por la presencia de cierta plaga y dará una transferencia per cápita a todos los pequeños productores de maíz cuyos cultivos se considere están afectados por dicha plaga. Para determinar qué hogares reciben la transferencia se decide usar un índice de prevalencia de la plaga y se selecciona un umbral por arriba del cual está demostrado que los rendimientos del cultivo del maíz se ven seriamente afectados. Esta inspección se llevará a cabo por autoridades federales y el umbral es conocido solo por estas autoridades. Cuando se determine que la prevalencia está por encima del umbral, el monto del programa será transferido de manera inmediata, electrónicamente.\n\na. [5 puntos] ¿Qué aspectos del programa permitirían emplear un diseño de regresión discontinua para evaluar la efectividad de este sobre la seguridad alimentaria y cómo mostraría su validez empíricamente?\n\n    *En este caso podemos usar el método de regresión discontinua por las siguientes razones:*\n    \n    *i.\tLa variable de selección es continua.*\n    \n    *ii.\tEs estatus de tratamiento es una función determinística de la posición de la variable de selección respecto al umbral.*\n    \n    *iii.\tLa probabilidad de recibir el tratamiento es discontinua en el umbral.*\n    \n    *iv.\tLos productores no pueden manipular la prevalencia de la plaga para posicionarse estratégicamente por encima del umbral.*\n\n\na. [10 puntos] ¿Cómo emplearía el diseño de este programa para evaluar su efectividad con un modelo de regresión discontinua nítida? Elabore una gráfica donde explique una situación en la que el programa muestra ser efectivo. Describa cómo usaría una regresión para hacer inferencia respecto a la efectividad del programa.\n\n    *La forma gráfica de inspeccionar la presencia de una regresión consiste en graficar la variable de resultados en función de la variable de asignación. En este caso, esperaríamos que las familias que están por encima del umbral tengan una diferencia notable en términos de seguridad alimentaria si la transferencia empleada se usa para comprar alimentos. No era estrictamente necesario simular un proceso para obtener una representación gráfica, pero aquí lo hice así. Quizás esto pueda ser de utilidad para futuras aplicaciones:*\n    \n\n   ::: {.cell}\n   \n   ```{.r .cell-code}\n   set.seed(1711)\n     \n   plaga <- runif(1000, -1, 1)\n   y <- 3 + 2*plaga + 5*(plaga>=0) + rnorm(1000, mean = 0, sd = 0.2)\n   \n   data.sharp <- data.frame(y, plaga, c = 0)\n   \n   \n   data.sharp %>% \n     ggplot() +\n     geom_point(aes(x=plaga, y=y), size=0.5, alpha=0.5) +\n     geom_abline(intercept = 3, slope = 2, linetype = \"dashed\") +\n     geom_abline(intercept = 8, slope = 2, linetype = \"dashed\") +\n     geom_vline(xintercept = 0)\n   ```\n   \n   ::: {.cell-output-display}\n   ![](tarea-3-respuestas_files/figure-html/unnamed-chunk-13-1.png){width=672}\n   :::\n   :::\n\n    \n  \n    *Paramétricamente, la forma más sencilla de identificar el efecto de la discontinuidad es especificando una regresión como sigue:*\n    \n    $$y_i=\\alpha+\\tau D_i+ \\beta x_i+\\varepsilon_i$$\n    \n    *donde $x_i$ es la variable de selección y $D_i$ es una variable indicadora que toma el valor de uno cuando el índice de prevalencia de la plaga rebasa el umbral. Controlar por $x_i$ captura la relación que tiene la prevalencia de la plaga en la seguridad alimentaria, por ejemplo, vía los rendimientos. Se recomiendan al menos dos tipos de procedimientos más completos para comprobar la robustez de los efectos encontrados.*\n    \n    *El primero es incluir un polinomio lo suficientemente flexible de $x_i$:* $$y_i=\\alpha+\\tau D_i+ Bf(x_i)+\\varepsilon_i$$\n\n    *El segundo consiste en permitir que la pendiente sea diferente antes y después de la discontinuidad:*\n    \n    $$y_i=\\alpha+\\tau D_i +\\beta_0(x_i-x_0)+\\beta_1(x_i-x_0)D_i+\\varepsilon_i$$\n    \n    *Más aún, es posible combinar estas dos posibilidades para dar lugar a modelos más flexibles. Se espera que las conclusiones sean robustas al uso de modelos extremadamente complejos.*\n\n\na. [5 puntos] ¿Qué factores podrían invalidar el uso de este método para evaluar el programa?\n\n    *La principal preocupación es la posibilidad de manipulación de la prevalencia de la plaga para que la medición lo clasifique como receptor del programa. Podemos pensar en situaciones donde esto pudiera suceder con un individuo altamente sofisticado que pudiera manipular la presencia de la plaga de forma estratégica. Pensando que esto es costoso, el individuo estratégicamente debería seleccionar un punto justo por encima del umbral. Aunque difícil de suceder esta posibilidad podría investigarse empíricamente, por ejemplo, verificando que no haya “amontonamientos” justo por encima de la discontinuidad.*\n    \n    *Si existiera corrupción y muchos no elegibles recibieran la transferencia o si las familias no gastaran la transferencia en alimentos que mejoren su seguridad alimentaria el diseño también estaría comprometido.*\n\n\na. Suponga que otro de los asesores juzga como *demasiado paternalista* la transferencia y propone que, en su lugar, se otorgue un cupón válido para canjearse por bultos de un plaguicida. Asumiendo que en una encuesta posterior usted podría conocer la cantidad precisa de plaguicida aplicado, ¿cómo emplearía un diseño de regresión discontinua difusa para evaluar el efecto del uso del plaguicida sobre la seguridad alimentaria? En particular, describa:\n\n    i. [5 puntos] ¿Cómo estimaría la forma reducida? ¿Cuál es el coeficiente relevante y cuál es su interpretación?\n    \n        *El problema puede ser visto entonces como un diseño de regresión discontinua difusa. La discontinuidad define la intensidad del tratamiento, en este caso dada por la cantidad de plaguicida efectivamente aplicado. La forma reducida se estima con una regresión de la variable de resultados sobre el instrumento. Al igual que cuando se estudió la interpretación del LATE, este coeficiente da la correlación entre la seguridad alimentaria y el estado del tratamiento, pero no toma en cuenta que la seguridad alimentaria también depende de la cantidad de plaguicida usado, una decisión endógena.*    \n    i. [5 puntos] ¿Cómo estimaría la primera y la segunda etapa? ¿Cuáles son los coeficientes relevantes y cuál es su interpretación? \n    \n        *La primera etapa consiste en estimar la relación entre la variable endógena y el instrumento. En este caso, el instrumento es una variable indicadora que toma valor de 1 si la prevalencia de la plaga rebasa el umbral. La decisión endógena es la cantidad de plaguicida empleado. Se estima por una regresión de la variable endógena en función del instrumento.*\n        \n        *La segunda etapa consiste en estimar el efecto sobre la seguridad alimentaria de la cantidad plaguicida que predice el instrumento. Conceptualmente es como si se corriera una regresión de la variable de seguridad alimentaria en función de los valores ajustados en la primera etapa de la cantidad de plaguicida empleado. En la práctica, nunca se estiman dos regresiones separadas, sino que se usa la definición del estimador de mínimos cuadrados en dos etapas. El coeficiente es el efecto del uso de plaguicida en la seguridad alimentaria.*\n        \n    i. [5 puntos] ¿Cuáles son los supuestos necesarios para estimar este modelo usando variables instrumentales?\n    \n        *Los supuestos econométricos para la estimación del modelo de regresión discontinua difusa son los mismos que para cualquier otro problema de variables instrumentales: 1) Exclusión: el instrumento no pertenece a la ecuación estructural; y 2) Relevancia de la primera etapa: el instrumento está correlacionado con la variable endógena.*\n\n\n\n",
    "supporting": [
      "tarea-3-respuestas_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}